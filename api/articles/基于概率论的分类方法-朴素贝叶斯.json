{"title":"åŸºäºè´å¶æ–¯å†³ç­–ç†è®ºçš„åˆ†ç±»æ–¹æ³•","slug":"åŸºäºæ¦‚ç‡è®ºçš„åˆ†ç±»æ–¹æ³•-æœ´ç´ è´å¶æ–¯","date":"2020-12-24T14:19:00.000Z","updated":"2022-09-30T06:56:37.192Z","comments":true,"path":"api/articles/åŸºäºæ¦‚ç‡è®ºçš„åˆ†ç±»æ–¹æ³•-æœ´ç´ è´å¶æ–¯.json","excerpt":null,"covers":["/.top//attachment:e36f25cc-1cec-4995-809d-c7812f629c99.png","/.top//attachment:40d76e00-9bfb-4c92-af12-2257b8e49fc1.png","/.top//attachment:b6ba6689-3ad1-4a37-96c0-ccc2326b99a8.png","/.top//attachment:4ca58d34-234e-4fa6-b572-4b591bd36e18.png","/.top//attachment:40c1d39c-159e-4c7f-a811-45a728741340.png","https://oceaneyes.top/img/zhishigroup.jpg","https://oceaneyes.top/img/alipay.jpg","https://oceaneyes.top/img/wechatpay.jpg"],"content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><h2 id=\"åŸºäºè´å¶æ–¯å†³ç­–ç†è®ºçš„åˆ†ç±»æ–¹æ³•\">åŸºäºè´å¶æ–¯å†³ç­–ç†è®ºçš„åˆ†ç±»æ–¹æ³•</h2>\n<p><strong>æœ´ç´ è´å¶æ–¯æ˜¯è´å¶æ–¯å†³ç­–ç†è®ºçš„ä¸€éƒ¨åˆ†</strong> -\nä¼˜ç‚¹ï¼šåœ¨æ•°æ®è¾ƒå°‘çš„æƒ…å†µä¸‹ä»ç„¶æœ‰æ•ˆï¼Œå¯ä»¥å¤„ç†å¤šç±»åˆ«é—®é¢˜ -\nç¼ºç‚¹ï¼šå¯¹äºè¾“å…¥æ•°æ®çš„å‡†å¤‡æ–¹å¼è¾ƒä¸ºæ•æ„Ÿ - é€‚ç”¨æ•°æ®ç±»å‹ï¼šæ ‡ç§°å‹æ•°æ®</p>\n<p><em>æ ‡ç§°å‹ï¼šä¸€èˆ¬åœ¨æœ‰é™çš„æ•°æ®ä¸­å–ï¼Œè€Œä¸”åªå­˜åœ¨â€˜æ˜¯â€™å’Œâ€˜å¦â€™ä¸¤ç§ä¸åŒçš„ç»“æœï¼ˆä¸€èˆ¬ç”¨äºåˆ†ç±»ï¼‰</em>\n<em>æ•°å€¼å‹ï¼šå¯ä»¥åœ¨æ— é™çš„æ•°æ®ä¸­å–ï¼Œè€Œä¸”æ•°å€¼æ¯”è¾ƒå…·ä½“åŒ–ï¼Œä¾‹å¦‚4.02,6.23è¿™ç§å€¼ï¼ˆä¸€èˆ¬ç”¨äºå›å½’åˆ†æï¼‰</em></p>\n<h4 id=\"è´å¶æ–¯å†³ç­–ç†è®ºçš„æ ¸å¿ƒæ€æƒ³å³é€‰æ‹©å…·æœ‰æœ€é«˜æ¦‚ç‡çš„å†³ç­–\"><strong>è´å¶æ–¯å†³ç­–ç†è®ºçš„æ ¸å¿ƒæ€æƒ³ï¼Œå³é€‰æ‹©å…·æœ‰æœ€é«˜æ¦‚ç‡çš„å†³ç­–</strong></h4>\n<ul>\n<li><p>å‡è®¾ç°åœ¨æˆ‘ä»¬æœ‰ä¸€ä¸ªæ•°æ®é›†ï¼Œå®ƒç”±ä¸¤ç±»æ•°æ®ç»„æˆï¼Œæ•°æ®åˆ†å¸ƒå¦‚å›¾ <img src=\"/.top//attachment:e36f25cc-1cec-4995-809d-c7812f629c99.png\" alt=\"image.png\"></p></li>\n<li><p>æˆ‘ä»¬ç°åœ¨ç”¨p1(x,y)è¡¨ç¤ºæ•°æ®ç‚¹(x,y)å±äºç±»åˆ«1ï¼ˆå›¾ä¸­ç”¨åœ†ç‚¹è¡¨ç¤ºçš„ç±»åˆ«ï¼‰çš„æ¦‚ç‡ï¼Œç”¨p2(x,y)è¡¨ç¤ºæ•°æ®ç‚¹(x,y)å±äºç±»åˆ«2ï¼ˆå›¾ä¸­ç”¨ä¸‰è§’å½¢è¡¨ç¤ºçš„ç±»åˆ«ï¼‰çš„æ¦‚ç‡ï¼Œé‚£ä¹ˆå¯¹äºä¸€ä¸ªæ–°æ•°æ®ç‚¹(x,y)ï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„è§„åˆ™æ¥åˆ¤æ–­å®ƒçš„ç±»åˆ«ï¼š</p></li>\n<li><p>å¦‚æœ p1(x,y) &gt; p2(x,y)ï¼Œé‚£ä¹ˆç±»åˆ«ä¸º1</p></li>\n<li><p>å¦‚æœ p2(x,y) &gt; p1(x,y)ï¼Œé‚£ä¹ˆç±»åˆ«ä¸º2</p></li>\n<li><p><strong>è®¡ç®—åˆ†ç±»çš„æ–¹æ³•</strong></p></li>\n<li><p>ä½¿ç”¨kNNï¼Œè¿›è¡Œ1000æ¬¡è·ç¦»è®¡ç®—ï¼›</p></li>\n<li><p>ä½¿ç”¨å†³ç­–æ ‘ï¼Œåˆ†åˆ«æ²¿xè½´ã€yè½´åˆ’åˆ†æ•°æ®ï¼›</p></li>\n<li><p>è®¡ç®—æ•°æ®ç‚¹å±äºæ¯ä¸ªç±»åˆ«çš„æ¦‚ç‡ï¼Œå¹¶è¿›è¡Œæ¯”è¾ƒ</p></li>\n</ul>\n<h4 id=\"æ¡ä»¶æ¦‚ç‡\"><strong>æ¡ä»¶æ¦‚ç‡</strong></h4>\n<p><img src=\"/.top//attachment:40d76e00-9bfb-4c92-af12-2257b8e49fc1.png\" alt=\"image.png\"> -\nè®¡ç®—ä»Bæ¡¶ä¸­å–åˆ°ç°è‰²çŸ³å¤´çš„æ¦‚ç‡çš„åŠæ³•ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„æ¡ä»¶æ¦‚ç‡ï¼ˆconditionalprobabilityï¼‰ã€‚å‡å®šè®¡ç®—çš„æ˜¯ä»Bæ¡¶å–åˆ°ç°è‰²çŸ³å¤´çš„æ¦‚ç‡ï¼Œè¿™ä¸ªæ¦‚ç‡å¯ä»¥è®°ä½œP(gray|bucketB)ï¼Œ\n-\næˆ‘ä»¬ç§°ä¹‹ä¸ºâ€œåœ¨å·²çŸ¥çŸ³å¤´å‡ºè‡ªBæ¡¶çš„æ¡ä»¶ä¸‹ï¼Œå–å‡ºç°è‰²çŸ³å¤´çš„æ¦‚ç‡â€ã€‚ä¸éš¾å¾—åˆ°ï¼ŒP(gray|bucketA)å€¼ä¸º2/4ï¼ŒP(gray|bucketB)\nçš„å€¼ä¸º1/3ã€‚ <img src=\"/.top//attachment:b6ba6689-3ad1-4a37-96c0-ccc2326b99a8.png\" alt=\"image.png\"></p>\n<h2 id=\"ä½¿ç”¨æ¡ä»¶æ¦‚ç‡åˆ†ç±»\"><strong>ä½¿ç”¨æ¡ä»¶æ¦‚ç‡åˆ†ç±»</strong></h2>\n<ul>\n<li><p>ä¹‹å‰è´å¶æ–¯å†³ç­–ç†è®ºè¦æ±‚è®¡ç®—ä¸¤ä¸ªæ¦‚ç‡p1(x, y)å’Œp2(x, y)ï¼š</p></li>\n<li><p>å¦‚æœp1(x, y) &gt; p2(x, y)ï¼Œé‚£ä¹ˆå±äºç±»åˆ«1ï¼›</p></li>\n<li><p>å¦‚æœp2(x, y) &gt; p1(x, y)ï¼Œé‚£ä¹ˆå±äºç±»åˆ«2ã€‚</p></li>\n<li><p>ä½¿ç”¨p1( )å’Œp2(\n)åªæ˜¯ä¸ºäº†å°½å¯èƒ½ç®€åŒ–æè¿°ï¼ŒçœŸæ­£éœ€è¦è®¡ç®—å’Œæ¯”è¾ƒçš„æ˜¯p(c1|x, y)å’Œp(c2|x,\ny)ã€‚è¿™äº›ç¬¦å·æ‰€ä»£è¡¨çš„å…·ä½“æ„ä¹‰æ˜¯ï¼š</p></li>\n<li><p>ç»™å®šæŸä¸ªç”±xã€yè¡¨ç¤ºçš„æ•°æ®ç‚¹ï¼Œé‚£ä¹ˆè¯¥æ•°æ®ç‚¹æ¥è‡ªç±»åˆ«c1çš„æ¦‚ç‡æ˜¯å¤šå°‘ï¼Ÿ</p></li>\n<li><p>æ•°æ®ç‚¹æ¥è‡ªç±»åˆ«c2çš„æ¦‚ç‡åˆæ˜¯å¤šå°‘ï¼Ÿ <img src=\"/.top//attachment:4ca58d34-234e-4fa6-b572-4b591bd36e18.png\" alt=\"image.png\"></p></li>\n<li><p>ä½¿ç”¨è¿™äº›å®šä¹‰ï¼Œå¯ä»¥å®šä¹‰è´å¶æ–¯åˆ†ç±»å‡†åˆ™ä¸ºï¼š</p></li>\n<li><p>å¦‚æœP(c1|x, y) &gt; P(c2|x, y)ï¼Œé‚£ä¹ˆå±äºç±»åˆ«c1ã€‚</p></li>\n<li><p>å¦‚æœP(c1|x, y) &lt; P(c2|x, y)ï¼Œé‚£ä¹ˆå±äºç±»åˆ«c2ã€‚</p></li>\n</ul>\n<h2 id=\"ä½¿ç”¨æœ´ç´ è´å¶æ–¯è¿›è¡Œæ–‡æœ¬åˆ†ç±»\"><strong>ä½¿ç”¨æœ´ç´ è´å¶æ–¯è¿›è¡Œæ–‡æœ¬åˆ†ç±»</strong></h2>\n<ul>\n<li><p>æœ´ç´ è´å¶æ–¯çš„ä¸€èˆ¬è¿‡ç¨‹</p></li>\n<li><p>æ”¶é›†æ•°æ®ï¼š</p></li>\n<li><p>å‡†å¤‡æ•°æ®ï¼šéœ€è¦æ•°å€¼å‹ æˆ–è€…å¸ƒå°”å‹æ•°æ®</p></li>\n<li><p>åˆ†ææ•°æ®ï¼šæœ‰å¤§é‡ç‰¹å¾æ—¶ï¼Œç»˜åˆ¶ç‰¹å¾ä½œç”¨ä¸å¤§ï¼Œ\næ­¤æ—¶ä½¿ç”¨ç›´æ–¹å›¾æ•ˆæœæ›´å¥½</p></li>\n<li><p>è®­ç»ƒç®—æ³•ï¼šè®¡ç®—ä¸åŒçš„ç‹¬ç«‹ç‰¹å¾çš„æ¡ä»¶æ¦‚ç‡</p></li>\n<li><p>æµ‹è¯•ç®—æ³•ï¼šè®¡ç®—é”™è¯¯ç‡</p></li>\n<li><p>ä½¿ç”¨ç®—æ³•ï¼šä¸€ä¸ªå¸¸è§çš„æœ´ç´ è´å¶æ–¯åº”ç”¨æ˜¯æ–‡æ¡£åˆ†ç±»ï¼Œå¯ä»¥ä»»æ„çš„åˆ†ç±»åœºæ™¯ä¸­ä½¿ç”¨æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨</p></li>\n<li><p>ç‰¹å¾ä¹‹é—´ç›¸äº’ç‹¬ç«‹ï¼ˆindependenceï¼‰ï¼šæŒ‡çš„æ˜¯ç»Ÿè®¡æ„ä¹‰ä¸Šçš„ç‹¬ç«‹ï¼Œå³ä¸€ä¸ªç‰¹å¾æˆ–è€…å•è¯å‡ºç°çš„å¯èƒ½æ€§ä¸å®ƒå’Œå…¶ä»–å•è¯ç›¸é‚»æ²¡æœ‰å…³ç³»</p></li>\n<li><p>æ¯ä¸ªç‰¹å¾åŒç­‰é‡è¦</p></li>\n</ul>\n<h2 id=\"æ–‡æœ¬åˆ†ç±»\"><strong>æ–‡æœ¬åˆ†ç±»</strong></h2>\n<h4 id=\"å‡†å¤‡æ•°æ®ä»æ–‡æœ¬ä¸­æ„å»ºè¯å‘é‡\"><strong>å‡†å¤‡æ•°æ®ï¼šä»æ–‡æœ¬ä¸­æ„å»ºè¯å‘é‡</strong></h4>\n<div class=\"sourceCode\" id=\"cb1\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb1-1\"><a href=\"#cb1-1\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"im\">import</span> sys</span>\n<span id=\"cb1-2\"><a href=\"#cb1-2\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"im\">import</span> numpy <span class=\"im\">as</span> np</span>\n<span id=\"cb1-3\"><a href=\"#cb1-3\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"bu\">print</span>(sys.executable)</span></code></pre></div>\n<pre><code>/Users/gaozhiyong/Documents/pyenv/pyenv3.6/bin/python</code></pre>\n<div class=\"sourceCode\" id=\"cb3\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb3-1\"><a href=\"#cb3-1\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">def</span> loadDataSet():</span>\n<span id=\"cb3-2\"><a href=\"#cb3-2\" aria-hidden=\"true\" tabindex=\"-1\"></a>    postingList <span class=\"op\">=</span> [</span>\n<span id=\"cb3-3\"><a href=\"#cb3-3\" aria-hidden=\"true\" tabindex=\"-1\"></a>        [<span class=\"st\">&#39;my&#39;</span>,<span class=\"st\">&#39;dog&#39;</span>,<span class=\"st\">&#39;has&#39;</span>,<span class=\"st\">&#39;flea&#39;</span>,<span class=\"st\">&#39;problems&#39;</span>,<span class=\"st\">&#39;help&#39;</span>,<span class=\"st\">&#39;please&#39;</span>],</span>\n<span id=\"cb3-4\"><a href=\"#cb3-4\" aria-hidden=\"true\" tabindex=\"-1\"></a>        [<span class=\"st\">&#39;maybe&#39;</span>,<span class=\"st\">&#39;not&#39;</span>,<span class=\"st\">&#39;take&#39;</span>,<span class=\"st\">&#39;him&#39;</span>,<span class=\"st\">&#39;to&#39;</span>,<span class=\"st\">&#39;dog&#39;</span>,<span class=\"st\">&#39;park&#39;</span>,<span class=\"st\">&#39;stupid&#39;</span>],</span>\n<span id=\"cb3-5\"><a href=\"#cb3-5\" aria-hidden=\"true\" tabindex=\"-1\"></a>        [<span class=\"st\">&#39;my&#39;</span>,<span class=\"st\">&#39;dalmation&#39;</span>,<span class=\"st\">&#39;is&#39;</span>,<span class=\"st\">&#39;so&#39;</span>,<span class=\"st\">&#39;cute&#39;</span>,<span class=\"st\">&#39;I&#39;</span>,<span class=\"st\">&#39;love&#39;</span>,<span class=\"st\">&#39;him&#39;</span>],</span>\n<span id=\"cb3-6\"><a href=\"#cb3-6\" aria-hidden=\"true\" tabindex=\"-1\"></a>        [<span class=\"st\">&#39;stop&#39;</span>,<span class=\"st\">&#39;posting&#39;</span>,<span class=\"st\">&#39;stupid&#39;</span>,<span class=\"st\">&#39;worthless&#39;</span>,<span class=\"st\">&#39;garbage&#39;</span>],</span>\n<span id=\"cb3-7\"><a href=\"#cb3-7\" aria-hidden=\"true\" tabindex=\"-1\"></a>        [<span class=\"st\">&#39;mr&#39;</span>,<span class=\"st\">&#39;licks&#39;</span>,<span class=\"st\">&#39;ate&#39;</span>,<span class=\"st\">&#39;my&#39;</span>,<span class=\"st\">&#39;steak&#39;</span>,<span class=\"st\">&#39;how&#39;</span>,<span class=\"st\">&#39;to&#39;</span>,<span class=\"st\">&#39;stop&#39;</span>,<span class=\"st\">&#39;him&#39;</span>],</span>\n<span id=\"cb3-8\"><a href=\"#cb3-8\" aria-hidden=\"true\" tabindex=\"-1\"></a>        [<span class=\"st\">&#39;quit&#39;</span>,<span class=\"st\">&#39;buying&#39;</span>,<span class=\"st\">&#39;worthless&#39;</span>,<span class=\"st\">&#39;dog&#39;</span>,<span class=\"st\">&#39;food&#39;</span>,<span class=\"st\">&#39;stupid&#39;</span>]</span>\n<span id=\"cb3-9\"><a href=\"#cb3-9\" aria-hidden=\"true\" tabindex=\"-1\"></a>    ]</span>\n<span id=\"cb3-10\"><a href=\"#cb3-10\" aria-hidden=\"true\" tabindex=\"-1\"></a>    classVec <span class=\"op\">=</span> [<span class=\"dv\">0</span>,<span class=\"dv\">1</span>,<span class=\"dv\">0</span>,<span class=\"dv\">1</span>,<span class=\"dv\">0</span>,<span class=\"dv\">1</span>]</span>\n<span id=\"cb3-11\"><a href=\"#cb3-11\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"cf\">return</span> postingList,classVec</span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb4\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb4-1\"><a href=\"#cb4-1\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">def</span> createVocabList(dataSet):</span>\n<span id=\"cb4-2\"><a href=\"#cb4-2\" aria-hidden=\"true\" tabindex=\"-1\"></a>    vocabSet <span class=\"op\">=</span> <span class=\"bu\">set</span>([])    <span class=\"co\">#åˆ›å»ºä¸€ä¸ªç©ºé›†</span></span>\n<span id=\"cb4-3\"><a href=\"#cb4-3\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"cf\">for</span> document <span class=\"kw\">in</span> dataSet:</span>\n<span id=\"cb4-4\"><a href=\"#cb4-4\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"co\">#         print(&#39;document&#39;,document)</span></span>\n<span id=\"cb4-5\"><a href=\"#cb4-5\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"co\">#         print(&quot;vocabSetä¹‹å‰&quot;,vocabSet)</span></span>\n<span id=\"cb4-6\"><a href=\"#cb4-6\" aria-hidden=\"true\" tabindex=\"-1\"></a>        vocabSet <span class=\"op\">=</span> vocabSet <span class=\"op\">|</span> <span class=\"bu\">set</span>(document)  <span class=\"co\">#åˆ›å»ºä¸¤ä¸ªé›†åˆçš„å¹¶é›†</span></span>\n<span id=\"cb4-7\"><a href=\"#cb4-7\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"co\">#         print(&quot;vocabSetä¹‹å&quot;,vocabSet)</span></span>\n<span id=\"cb4-8\"><a href=\"#cb4-8\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"cf\">return</span> <span class=\"bu\">list</span>(vocabSet)</span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb5\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb5-1\"><a href=\"#cb5-1\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">def</span> setOfWord2Vec(vocabList,inputSet):</span>\n<span id=\"cb5-2\"><a href=\"#cb5-2\" aria-hidden=\"true\" tabindex=\"-1\"></a>    returnVec <span class=\"op\">=</span> [<span class=\"dv\">0</span>] <span class=\"op\">*</span> <span class=\"bu\">len</span>(vocabList)</span>\n<span id=\"cb5-3\"><a href=\"#cb5-3\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"cf\">for</span> word <span class=\"kw\">in</span> inputSet:</span>\n<span id=\"cb5-4\"><a href=\"#cb5-4\" aria-hidden=\"true\" tabindex=\"-1\"></a>        <span class=\"cf\">if</span> word <span class=\"kw\">in</span> vocabList:</span>\n<span id=\"cb5-5\"><a href=\"#cb5-5\" aria-hidden=\"true\" tabindex=\"-1\"></a>            returnVec[vocabList.index(word)] <span class=\"op\">=</span> <span class=\"dv\">1</span></span>\n<span id=\"cb5-6\"><a href=\"#cb5-6\" aria-hidden=\"true\" tabindex=\"-1\"></a>        <span class=\"cf\">else</span>:</span>\n<span id=\"cb5-7\"><a href=\"#cb5-7\" aria-hidden=\"true\" tabindex=\"-1\"></a>            <span class=\"bu\">print</span>(<span class=\"st\">&quot;the word: </span><span class=\"sc\">%s</span><span class=\"st\"> is not in my Vocabulary!&quot;</span> <span class=\"op\">%</span> word )</span>\n<span id=\"cb5-8\"><a href=\"#cb5-8\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"cf\">return</span> returnVec</span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb6\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb6-1\"><a href=\"#cb6-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>listOPosts,listClasses <span class=\"op\">=</span> loadDataSet()</span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb7\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb7-1\"><a href=\"#cb7-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>listOPosts</span></code></pre></div>\n<pre><code>[[&#39;my&#39;, &#39;dog&#39;, &#39;has&#39;, &#39;flea&#39;, &#39;problems&#39;, &#39;help&#39;, &#39;please&#39;],\n [&#39;maybe&#39;, &#39;not&#39;, &#39;take&#39;, &#39;him&#39;, &#39;to&#39;, &#39;dog&#39;, &#39;park&#39;, &#39;stupid&#39;],\n [&#39;my&#39;, &#39;dalmation&#39;, &#39;is&#39;, &#39;so&#39;, &#39;cute&#39;, &#39;I&#39;, &#39;love&#39;, &#39;him&#39;],\n [&#39;stop&#39;, &#39;posting&#39;, &#39;stupid&#39;, &#39;worthless&#39;, &#39;garbage&#39;],\n [&#39;mr&#39;, &#39;licks&#39;, &#39;ate&#39;, &#39;my&#39;, &#39;steak&#39;, &#39;how&#39;, &#39;to&#39;, &#39;stop&#39;, &#39;him&#39;],\n [&#39;quit&#39;, &#39;buying&#39;, &#39;worthless&#39;, &#39;dog&#39;, &#39;food&#39;, &#39;stupid&#39;]]</code></pre>\n<div class=\"sourceCode\" id=\"cb9\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb9-1\"><a href=\"#cb9-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>listClasses</span></code></pre></div>\n<pre><code>[0, 1, 0, 1, 0, 1]</code></pre>\n<div class=\"sourceCode\" id=\"cb11\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb11-1\"><a href=\"#cb11-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>myVocabList <span class=\"op\">=</span> createVocabList(listOPosts)</span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb12\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb12-1\"><a href=\"#cb12-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>myVocabList</span></code></pre></div>\n<pre><code>[&#39;stop&#39;,\n &#39;dalmation&#39;,\n &#39;park&#39;,\n &#39;please&#39;,\n &#39;my&#39;,\n &#39;to&#39;,\n &#39;problems&#39;,\n &#39;posting&#39;,\n &#39;flea&#39;,\n &#39;steak&#39;,\n &#39;him&#39;,\n &#39;take&#39;,\n &#39;ate&#39;,\n &#39;is&#39;,\n &#39;help&#39;,\n &#39;how&#39;,\n &#39;cute&#39;,\n &#39;has&#39;,\n &#39;maybe&#39;,\n &#39;food&#39;,\n &#39;buying&#39;,\n &#39;stupid&#39;,\n &#39;licks&#39;,\n &#39;mr&#39;,\n &#39;dog&#39;,\n &#39;not&#39;,\n &#39;love&#39;,\n &#39;worthless&#39;,\n &#39;I&#39;,\n &#39;so&#39;,\n &#39;quit&#39;,\n &#39;garbage&#39;]</code></pre>\n<div class=\"sourceCode\" id=\"cb14\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb14-1\"><a href=\"#cb14-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>listOPosts[<span class=\"dv\">0</span>]</span></code></pre></div>\n<pre><code>[&#39;my&#39;, &#39;dog&#39;, &#39;has&#39;, &#39;flea&#39;, &#39;problems&#39;, &#39;help&#39;, &#39;please&#39;]</code></pre>\n<div class=\"sourceCode\" id=\"cb16\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb16-1\"><a href=\"#cb16-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>setOfWord2Vec(myVocabList,listOPosts[<span class=\"dv\">0</span>])</span></code></pre></div>\n<pre><code>[0,\n 0,\n 0,\n 1,\n 1,\n 0,\n 1,\n 0,\n 1,\n 0,\n 0,\n 0,\n 0,\n 0,\n 1,\n 0,\n 0,\n 1,\n 0,\n 0,\n 0,\n 0,\n 0,\n 0,\n 1,\n 0,\n 0,\n 0,\n 0,\n 0,\n 0,\n 0]</code></pre>\n<div class=\"sourceCode\" id=\"cb18\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb18-1\"><a href=\"#cb18-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>setOfWord2Vec(myVocabList,listOPosts[<span class=\"dv\">3</span>])</span></code></pre></div>\n<pre><code>[1,\n 0,\n 0,\n 0,\n 0,\n 0,\n 0,\n 1,\n 0,\n 0,\n 0,\n 0,\n 0,\n 0,\n 0,\n 0,\n 0,\n 0,\n 0,\n 0,\n 0,\n 1,\n 0,\n 0,\n 0,\n 0,\n 0,\n 1,\n 0,\n 0,\n 0,\n 1]</code></pre>\n<h4 id=\"è®­ç»ƒç®—æ³•ä»è¯å‘é‡è®¡ç®—æ¦‚ç‡\"><strong>è®­ç»ƒç®—æ³•ï¼šä»è¯å‘é‡è®¡ç®—æ¦‚ç‡</strong></h4>\n<p><img src=\"/.top//attachment:40c1d39c-159e-4c7f-a811-45a728741340.png\" alt=\"image.png\"> -\nä½¿ç”¨ä¸Šè¿°å…¬å¼ï¼Œå¯¹æ¯ä¸ªç±»è®¡ç®—è¯¥å€¼ï¼Œç„¶åæ¯”è¾ƒè¿™ä¸¤ä¸ªæ¦‚ç‡å€¼çš„å¤§å°ã€‚ -\nå¦‚ä½•è®¡ç®—å‘¢ï¼Ÿ -\né¦–å…ˆå¯ä»¥é€šè¿‡ç±»åˆ«iï¼ˆä¾®è¾±æ€§ç•™è¨€æˆ–éä¾®è¾±æ€§ç•™è¨€ï¼‰ä¸­æ–‡æ¡£æ•°é™¤ä»¥æ€»çš„æ–‡æ¡£æ•°æ¥è®¡ç®—æ¦‚ç‡p(ci)ã€‚\n- æ¥ä¸‹æ¥è®¡ç®—p(w|ci)ï¼Œè¿™é‡Œå°±è¦ç”¨åˆ°æœ´ç´ è´å¶æ–¯å‡è®¾ã€‚ -\nå¦‚æœå°†wå±•å¼€ä¸ºä¸€ä¸ªä¸ªç‹¬ç«‹ç‰¹å¾ï¼Œé‚£ä¹ˆå°±å¯ä»¥å°†ä¸Šè¿°æ¦‚ç‡å†™ä½œp(w0,w1,w2..wN|ci)ã€‚\n-\nè¿™é‡Œå‡è®¾æ‰€æœ‰è¯éƒ½äº’ç›¸ç‹¬ç«‹ï¼Œè¯¥å‡è®¾ä¹Ÿç§°ä½œæ¡ä»¶ç‹¬ç«‹æ€§å‡è®¾ï¼Œå®ƒæ„å‘³ç€å¯ä»¥ä½¿p(w0|ci)p(w1|ci)p(w2|ci)...p(wN|ci)æ¥è®¡ç®—ä¸Šè¿°æ¦‚ç‡</p>\n<h5 id=\"ä»£ç é€»è¾‘\"><strong>ä»£ç é€»è¾‘</strong></h5>\n<ul>\n<li>è®¡ç®—æ¯ä¸ªç±»åˆ«ä¸­çš„æ–‡æ¡£æ•°ç›®</li>\n<li>å¯¹æ¯ç¯‡è®­ç»ƒæ–‡æ¡£</li>\n<li>å¯¹æ¯ä¸ªç±»åˆ«\n<ul>\n<li>å¦‚æœè¯æ¡å‡ºç°åœ¨æ–‡æ¡£ä¸­ --- å¢åŠ è¯¥è¯æ¡çš„è®¡æ•°å€¼</li>\n<li>å¢åŠ æ‰€æœ‰è¯æ¡çš„è®¡æ•°å€¼</li>\n</ul></li>\n<li>å¯¹æ¯ä¸ªç±»åˆ«\n<ul>\n<li>å¯¹æ¯ä¸ªè¯æ¡\n<ul>\n<li>å°† <strong>è¯¥è¯æ¡çš„æ•°ç›®</strong> é™¤ä»¥ <strong>æ€»è¯æ•°ç›®</strong> å¾—åˆ°\n<strong>æ¡ä»¶æ¦‚ç‡</strong></li>\n</ul></li>\n</ul></li>\n<li>è¿”å›æ¯ä¸ªç±»åˆ«çš„æ¡ä»¶æ¦‚ç‡</li>\n</ul>\n<div class=\"sourceCode\" id=\"cb20\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb20-1\"><a href=\"#cb20-1\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">def</span> trainNB0(trainMatrix,trainCategory):</span>\n<span id=\"cb20-2\"><a href=\"#cb20-2\" aria-hidden=\"true\" tabindex=\"-1\"></a>    numTrainDocs <span class=\"op\">=</span> <span class=\"bu\">len</span>(trainMatrix)</span>\n<span id=\"cb20-3\"><a href=\"#cb20-3\" aria-hidden=\"true\" tabindex=\"-1\"></a>    numWords <span class=\"op\">=</span> <span class=\"bu\">len</span>(trainMatrix[<span class=\"dv\">0</span>])</span>\n<span id=\"cb20-4\"><a href=\"#cb20-4\" aria-hidden=\"true\" tabindex=\"-1\"></a>    pAbusive <span class=\"op\">=</span> <span class=\"bu\">sum</span>(trainCategory) <span class=\"op\">/</span> <span class=\"bu\">float</span>(numTrainDocs)</span>\n<span id=\"cb20-5\"><a href=\"#cb20-5\" aria-hidden=\"true\" tabindex=\"-1\"></a>    p0Num <span class=\"op\">=</span> np.zeros(numWords) </span>\n<span id=\"cb20-6\"><a href=\"#cb20-6\" aria-hidden=\"true\" tabindex=\"-1\"></a>    p1Num <span class=\"op\">=</span> np.zeros(numWords)</span>\n<span id=\"cb20-7\"><a href=\"#cb20-7\" aria-hidden=\"true\" tabindex=\"-1\"></a>    p0Denom <span class=\"op\">=</span> <span class=\"fl\">0.0</span></span>\n<span id=\"cb20-8\"><a href=\"#cb20-8\" aria-hidden=\"true\" tabindex=\"-1\"></a>    p1Denom <span class=\"op\">=</span> <span class=\"fl\">0.0</span></span>\n<span id=\"cb20-9\"><a href=\"#cb20-9\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"cf\">for</span> i <span class=\"kw\">in</span> <span class=\"bu\">range</span>(numTrainDocs):</span>\n<span id=\"cb20-10\"><a href=\"#cb20-10\" aria-hidden=\"true\" tabindex=\"-1\"></a>        <span class=\"cf\">try</span>:</span>\n<span id=\"cb20-11\"><a href=\"#cb20-11\" aria-hidden=\"true\" tabindex=\"-1\"></a>            <span class=\"cf\">if</span> trainCategory[i] <span class=\"op\">==</span> <span class=\"dv\">1</span>:</span>\n<span id=\"cb20-12\"><a href=\"#cb20-12\" aria-hidden=\"true\" tabindex=\"-1\"></a>                p1Num <span class=\"op\">+=</span> trainMatrix[i]</span>\n<span id=\"cb20-13\"><a href=\"#cb20-13\" aria-hidden=\"true\" tabindex=\"-1\"></a>                p1Denom <span class=\"op\">+=</span> <span class=\"bu\">sum</span>(trainMatrix[i])</span>\n<span id=\"cb20-14\"><a href=\"#cb20-14\" aria-hidden=\"true\" tabindex=\"-1\"></a>            <span class=\"cf\">else</span>:</span>\n<span id=\"cb20-15\"><a href=\"#cb20-15\" aria-hidden=\"true\" tabindex=\"-1\"></a>                p0Num <span class=\"op\">+=</span> trainMatrix[i]</span>\n<span id=\"cb20-16\"><a href=\"#cb20-16\" aria-hidden=\"true\" tabindex=\"-1\"></a>                p0Denom <span class=\"op\">+=</span> <span class=\"bu\">sum</span>(trainMatrix[i])</span>\n<span id=\"cb20-17\"><a href=\"#cb20-17\" aria-hidden=\"true\" tabindex=\"-1\"></a>        <span class=\"cf\">except</span>:</span>\n<span id=\"cb20-18\"><a href=\"#cb20-18\" aria-hidden=\"true\" tabindex=\"-1\"></a>            <span class=\"cf\">continue</span></span>\n<span id=\"cb20-19\"><a href=\"#cb20-19\" aria-hidden=\"true\" tabindex=\"-1\"></a>    p1Vect <span class=\"op\">=</span> p1Num <span class=\"op\">/</span> p1Denom</span>\n<span id=\"cb20-20\"><a href=\"#cb20-20\" aria-hidden=\"true\" tabindex=\"-1\"></a>    p0Vect <span class=\"op\">=</span> p0Num <span class=\"op\">/</span> p0Denom</span>\n<span id=\"cb20-21\"><a href=\"#cb20-21\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"cf\">return</span> p0Vect,p1Vect,pAbusive</span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb21\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb21-1\"><a href=\"#cb21-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>listOPosts,listClasses <span class=\"op\">=</span> loadDataSet()</span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb22\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb22-1\"><a href=\"#cb22-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>myVocabList <span class=\"op\">=</span> createVocabList(listOPosts)</span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb23\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb23-1\"><a href=\"#cb23-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>trainMat <span class=\"op\">=</span> []</span>\n<span id=\"cb23-2\"><a href=\"#cb23-2\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"cf\">for</span> postinDoc <span class=\"kw\">in</span> listOPosts:</span>\n<span id=\"cb23-3\"><a href=\"#cb23-3\" aria-hidden=\"true\" tabindex=\"-1\"></a>    trainMat.append(setOfWord2Vec(myVocabList,postinDoc))</span>\n<span id=\"cb23-4\"><a href=\"#cb23-4\" aria-hidden=\"true\" tabindex=\"-1\"></a>p0V,p1V,pAb <span class=\"op\">=</span> trainNB0(trainMat,listClasses)</span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb24\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb24-1\"><a href=\"#cb24-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>pAb</span></code></pre></div>\n<pre><code>0.5</code></pre>\n<div class=\"sourceCode\" id=\"cb26\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb26-1\"><a href=\"#cb26-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>p0V</span></code></pre></div>\n<pre><code>array([0.04166667, 0.04166667, 0.        , 0.04166667, 0.125     ,\n       0.04166667, 0.04166667, 0.        , 0.04166667, 0.04166667,\n       0.08333333, 0.        , 0.04166667, 0.04166667, 0.04166667,\n       0.04166667, 0.04166667, 0.04166667, 0.        , 0.        ,\n       0.        , 0.        , 0.04166667, 0.04166667, 0.04166667,\n       0.        , 0.04166667, 0.        , 0.04166667, 0.04166667,\n       0.        , 0.        ])</code></pre>\n<div class=\"sourceCode\" id=\"cb28\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb28-1\"><a href=\"#cb28-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>p1V</span></code></pre></div>\n<pre><code>array([0.05263158, 0.        , 0.05263158, 0.        , 0.        ,\n       0.05263158, 0.        , 0.05263158, 0.        , 0.        ,\n       0.05263158, 0.05263158, 0.        , 0.        , 0.        ,\n       0.        , 0.        , 0.        , 0.05263158, 0.05263158,\n       0.05263158, 0.15789474, 0.        , 0.        , 0.10526316,\n       0.05263158, 0.        , 0.10526316, 0.        , 0.        ,\n       0.05263158, 0.05263158])</code></pre>\n<h4 id=\"æµ‹è¯•ç®—æ³•æ ¹æ®ç°å®æƒ…å†µä¿®æ”¹åˆ†ç±»å™¨\"><strong>æµ‹è¯•ç®—æ³•ï¼šæ ¹æ®ç°å®æƒ…å†µä¿®æ”¹åˆ†ç±»å™¨</strong></h4>\n<div class=\"sourceCode\" id=\"cb30\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb30-1\"><a href=\"#cb30-1\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">def</span> trainNB1(trainMatrix,trainCategory):</span>\n<span id=\"cb30-2\"><a href=\"#cb30-2\" aria-hidden=\"true\" tabindex=\"-1\"></a>    numTrainDocs <span class=\"op\">=</span> <span class=\"bu\">len</span>(trainMatrix)</span>\n<span id=\"cb30-3\"><a href=\"#cb30-3\" aria-hidden=\"true\" tabindex=\"-1\"></a>    numWords <span class=\"op\">=</span> <span class=\"bu\">len</span>(trainMatrix[<span class=\"dv\">0</span>])</span>\n<span id=\"cb30-4\"><a href=\"#cb30-4\" aria-hidden=\"true\" tabindex=\"-1\"></a>    pAbusive <span class=\"op\">=</span> <span class=\"bu\">sum</span>(trainCategory) <span class=\"op\">/</span> <span class=\"bu\">float</span>(numTrainDocs)</span>\n<span id=\"cb30-5\"><a href=\"#cb30-5\" aria-hidden=\"true\" tabindex=\"-1\"></a>    p0Num <span class=\"op\">=</span> np.ones(numWords) </span>\n<span id=\"cb30-6\"><a href=\"#cb30-6\" aria-hidden=\"true\" tabindex=\"-1\"></a>    p1Num <span class=\"op\">=</span> np.ones(numWords)</span>\n<span id=\"cb30-7\"><a href=\"#cb30-7\" aria-hidden=\"true\" tabindex=\"-1\"></a>    p0Denom <span class=\"op\">=</span> <span class=\"fl\">2.0</span></span>\n<span id=\"cb30-8\"><a href=\"#cb30-8\" aria-hidden=\"true\" tabindex=\"-1\"></a>    p1Denom <span class=\"op\">=</span> <span class=\"fl\">2.0</span></span>\n<span id=\"cb30-9\"><a href=\"#cb30-9\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"cf\">for</span> i <span class=\"kw\">in</span> <span class=\"bu\">range</span>(numTrainDocs):</span>\n<span id=\"cb30-10\"><a href=\"#cb30-10\" aria-hidden=\"true\" tabindex=\"-1\"></a>        <span class=\"cf\">try</span>:</span>\n<span id=\"cb30-11\"><a href=\"#cb30-11\" aria-hidden=\"true\" tabindex=\"-1\"></a>            <span class=\"cf\">if</span> trainCategory[i] <span class=\"op\">==</span> <span class=\"dv\">1</span>:</span>\n<span id=\"cb30-12\"><a href=\"#cb30-12\" aria-hidden=\"true\" tabindex=\"-1\"></a>                p1Num <span class=\"op\">+=</span> trainMatrix[i]</span>\n<span id=\"cb30-13\"><a href=\"#cb30-13\" aria-hidden=\"true\" tabindex=\"-1\"></a>                p1Denom <span class=\"op\">+=</span> <span class=\"bu\">sum</span>(trainMatrix[i])</span>\n<span id=\"cb30-14\"><a href=\"#cb30-14\" aria-hidden=\"true\" tabindex=\"-1\"></a>            <span class=\"cf\">else</span>:</span>\n<span id=\"cb30-15\"><a href=\"#cb30-15\" aria-hidden=\"true\" tabindex=\"-1\"></a>                p0Num <span class=\"op\">+=</span> trainMatrix[i]</span>\n<span id=\"cb30-16\"><a href=\"#cb30-16\" aria-hidden=\"true\" tabindex=\"-1\"></a>                p0Denom <span class=\"op\">+=</span> <span class=\"bu\">sum</span>(trainMatrix[i])</span>\n<span id=\"cb30-17\"><a href=\"#cb30-17\" aria-hidden=\"true\" tabindex=\"-1\"></a>        <span class=\"cf\">except</span>:</span>\n<span id=\"cb30-18\"><a href=\"#cb30-18\" aria-hidden=\"true\" tabindex=\"-1\"></a>            <span class=\"cf\">continue</span></span>\n<span id=\"cb30-19\"><a href=\"#cb30-19\" aria-hidden=\"true\" tabindex=\"-1\"></a>    p1Vect <span class=\"op\">=</span> np.log(p1Num <span class=\"op\">/</span> p1Denom)</span>\n<span id=\"cb30-20\"><a href=\"#cb30-20\" aria-hidden=\"true\" tabindex=\"-1\"></a>    p0Vect <span class=\"op\">=</span> np.log(p0Num <span class=\"op\">/</span> p0Denom)</span>\n<span id=\"cb30-21\"><a href=\"#cb30-21\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"cf\">return</span> p0Vect,p1Vect,pAbusive</span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb31\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb31-1\"><a href=\"#cb31-1\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">def</span> classifyNB(vec2Classify,p0Vec,p1Vec,pClass1):</span>\n<span id=\"cb31-2\"><a href=\"#cb31-2\" aria-hidden=\"true\" tabindex=\"-1\"></a>    p1<span class=\"op\">=</span><span class=\"bu\">sum</span>(vec2Classify <span class=\"op\">*</span> p1Vec) <span class=\"op\">+</span> np.log(pClass1)</span>\n<span id=\"cb31-3\"><a href=\"#cb31-3\" aria-hidden=\"true\" tabindex=\"-1\"></a>    p0<span class=\"op\">=</span> <span class=\"bu\">sum</span>(vec2Classify <span class=\"op\">*</span> p0Vec) <span class=\"op\">+</span> np.log(<span class=\"fl\">1.0</span><span class=\"op\">-</span> pClass1)</span>\n<span id=\"cb31-4\"><a href=\"#cb31-4\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"cf\">if</span> p1<span class=\"op\">&gt;</span>p0:</span>\n<span id=\"cb31-5\"><a href=\"#cb31-5\" aria-hidden=\"true\" tabindex=\"-1\"></a>        <span class=\"cf\">return</span> <span class=\"dv\">1</span></span>\n<span id=\"cb31-6\"><a href=\"#cb31-6\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"cf\">else</span>:</span>\n<span id=\"cb31-7\"><a href=\"#cb31-7\" aria-hidden=\"true\" tabindex=\"-1\"></a>        <span class=\"cf\">return</span> <span class=\"dv\">0</span></span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb32\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb32-1\"><a href=\"#cb32-1\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">def</span> testingNB():</span>\n<span id=\"cb32-2\"><a href=\"#cb32-2\" aria-hidden=\"true\" tabindex=\"-1\"></a>    listOPosts,listClasses <span class=\"op\">=</span> loadDataSet()</span>\n<span id=\"cb32-3\"><a href=\"#cb32-3\" aria-hidden=\"true\" tabindex=\"-1\"></a>    myVocabList <span class=\"op\">=</span> createVocabList(listOPosts)</span>\n<span id=\"cb32-4\"><a href=\"#cb32-4\" aria-hidden=\"true\" tabindex=\"-1\"></a>    trainMat <span class=\"op\">=</span> []</span>\n<span id=\"cb32-5\"><a href=\"#cb32-5\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"cf\">for</span> postinDoc <span class=\"kw\">in</span> listOPosts:</span>\n<span id=\"cb32-6\"><a href=\"#cb32-6\" aria-hidden=\"true\" tabindex=\"-1\"></a>        trainMat.append(setOfWord2Vec(myVocabList,postinDoc))</span>\n<span id=\"cb32-7\"><a href=\"#cb32-7\" aria-hidden=\"true\" tabindex=\"-1\"></a>    p0V,p1V,pAb <span class=\"op\">=</span> trainNB1(np.array(trainMat), np.array(listClasses))</span>\n<span id=\"cb32-8\"><a href=\"#cb32-8\" aria-hidden=\"true\" tabindex=\"-1\"></a>    testEntry1 <span class=\"op\">=</span> [<span class=\"st\">&#39;love&#39;</span>,<span class=\"st\">&#39;my&#39;</span>,<span class=\"st\">&#39;dalmation&#39;</span>]</span>\n<span id=\"cb32-9\"><a href=\"#cb32-9\" aria-hidden=\"true\" tabindex=\"-1\"></a>    thisDoc <span class=\"op\">=</span> np.array(setOfWord2Vec(myVocabList,testEntry1))</span>\n<span id=\"cb32-10\"><a href=\"#cb32-10\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"bu\">print</span>(testEntry1,<span class=\"st\">&#39;classified as: &#39;</span>,classifyNB(thisDoc,p0V,p1V,pAb))</span>\n<span id=\"cb32-11\"><a href=\"#cb32-11\" aria-hidden=\"true\" tabindex=\"-1\"></a>    </span>\n<span id=\"cb32-12\"><a href=\"#cb32-12\" aria-hidden=\"true\" tabindex=\"-1\"></a>    testEntry2 <span class=\"op\">=</span> [<span class=\"st\">&#39;stupid&#39;</span>,<span class=\"st\">&#39;garbage&#39;</span>]</span>\n<span id=\"cb32-13\"><a href=\"#cb32-13\" aria-hidden=\"true\" tabindex=\"-1\"></a>    thisDoc <span class=\"op\">=</span> np.array(setOfWord2Vec(myVocabList,testEntry2))</span>\n<span id=\"cb32-14\"><a href=\"#cb32-14\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"bu\">print</span>(testEntry2,<span class=\"st\">&#39;classified as: &#39;</span>,classifyNB(thisDoc,p0V,p1V,pAb))</span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb33\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb33-1\"><a href=\"#cb33-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>testingNB()</span></code></pre></div>\n<pre><code>[&#39;love&#39;, &#39;my&#39;, &#39;dalmation&#39;] classified as:  0\n[&#39;stupid&#39;, &#39;garbage&#39;] classified as:  1</code></pre>\n<h4 id=\"å‡†å¤‡æ•°æ®æ–‡æ¡£è¯è¢‹æ¨¡å‹\"><strong>å‡†å¤‡æ•°æ®ï¼šæ–‡æ¡£è¯è¢‹æ¨¡å‹</strong></h4>\n<ul>\n<li>å°†æ¯ä¸ªè¯çš„å‡ºç°ä¸å¦ä½œä¸ºä¸€ä¸ªç‰¹å¾ï¼Œè¿™å¯ä»¥è¢«æè¿°ä¸ºè¯é›†æ¨¡å‹(set-of-words\nmodel)ã€‚</li>\n<li>å¦‚æœä¸€ä¸ªè¯åœ¨æ–‡æ¡£ä¸­å‡ºç°ä¸æ­¢ä¸€æ¬¡ï¼Œè¿™å¯èƒ½æ„å‘³ç€åŒ…å«è¯¥è¯æ˜¯å¦å‡ºç°åœ¨æ–‡æ¡£ä¸­æ‰€ä¸èƒ½è¡¨\nè¾¾çš„æŸç§ä¿¡æ¯ï¼Œè¿™ç§æ–¹æ³•è¢«ç§°ä¸ºè¯è¢‹æ¨¡å‹(bag-of-words model)</li>\n</ul>\n<div class=\"sourceCode\" id=\"cb35\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb35-1\"><a href=\"#cb35-1\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">def</span> bagOfWords2VecMN(vocabList,inputSet):</span>\n<span id=\"cb35-2\"><a href=\"#cb35-2\" aria-hidden=\"true\" tabindex=\"-1\"></a>    returnVec <span class=\"op\">=</span> [<span class=\"dv\">0</span>] <span class=\"op\">*</span> <span class=\"bu\">len</span>(vocabList)</span>\n<span id=\"cb35-3\"><a href=\"#cb35-3\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"cf\">for</span> word <span class=\"kw\">in</span> inputSet:</span>\n<span id=\"cb35-4\"><a href=\"#cb35-4\" aria-hidden=\"true\" tabindex=\"-1\"></a>        <span class=\"cf\">if</span> word <span class=\"kw\">in</span> vocabList:</span>\n<span id=\"cb35-5\"><a href=\"#cb35-5\" aria-hidden=\"true\" tabindex=\"-1\"></a>            returnVec[vocabList.index[word]] <span class=\"op\">+=</span> <span class=\"dv\">1</span></span>\n<span id=\"cb35-6\"><a href=\"#cb35-6\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"cf\">return</span> returnVec</span></code></pre></div>\n<hr>\n<h3 id=\"about-me\">About ME</h3>\n<h5 id=\"è¯»ä¹¦åŸå—-åœ¨æœªæ¥é¢å‰æˆ‘ä»¬éƒ½æ˜¯å­©å­\">ğŸ‘‹ è¯»ä¹¦åŸå—ï¼ŒğŸ¤”\nåœ¨æœªæ¥é¢å‰ï¼Œæˆ‘ä»¬éƒ½æ˜¯å­©å­ï½</h5>\n<ul>\n<li>ğŸ“™\nä¸€ä¸ªçƒ­è¡·äºæ¢ç´¢å­¦ä¹ æ–°æ–¹å‘ã€æ–°äº‹ç‰©çš„æ™ºèƒ½äº§å“ç»ç†ï¼Œé—²æš‡æ—¶é—´å–œæ¬¢codingğŸ’»ã€ç”»å›¾ğŸ¨ã€éŸ³ä¹ğŸµã€å­¦ä¹ ing~</li>\n</ul>\n<h5 id=\"social-media\">ğŸ‘‹ Social Media</h5>\n<ul>\n<li><p>ğŸ› ï¸ Blog: <a href=\"http://oceaneyes.top\">http://oceaneyes.top</a></p></li>\n<li><p>âš¡ PMå¯¼èˆª: <a href=\"https://pmhub.oceangzy.top\">https://pmhub.oceangzy.top</a></p></li>\n<li><p>â˜˜ï¸ CNBLOG: <a href=\"https://www.cnblogs.com/oceaneyes-gzy/\">https://www.cnblogs.com/oceaneyes-gzy/</a></p></li>\n<li><p>ğŸŒ± AI PRJè‡ªå·±éƒ¨ç½²çš„ä¸€äº›ç®—æ³•demo: <a href=\"http://ai.oceangzy.top/\">http://ai.oceangzy.top/</a></p></li>\n<li><p>ğŸ“« Email: 1450136519@qq.com</p></li>\n<li><p>ğŸ’¬ WeChat: <a href=\"https://oceaneyes.top/img/wechatqrcode.jpg\">OCEANGZY</a></p></li>\n<li><p>ğŸ’¬ å…¬ä¼—å·: <a href=\"https://oceaneyes.top/img/wechatgzh.jpeg\">UncleJoker-GZY</a></p></li>\n</ul>\n<h5 id=\"åŠ å…¥å°ç»„\">ğŸ‘‹ åŠ å…¥å°ç»„~</h5>\n<p><img src=\"https://oceaneyes.top/img/zhishigroup.jpg\" title=\"åŠ å…¥ç»„ç»‡\" alt width=\"240\"></p>\n<h5 id=\"æ„Ÿè°¢æ‰“èµ\">ğŸ‘‹ æ„Ÿè°¢æ‰“èµ~</h5>\n<p><img src=\"https://oceaneyes.top/img/alipay.jpg\" title=\"æ”¯ä»˜å®æ‰“èµ\" alt width=\"140\">\n<img src=\"https://oceaneyes.top/img/wechatpay.jpg\" title=\"å¾®ä¿¡æ‰“èµ\" alt width=\"140\"></p>\n","more":"<h2 id=\"åŸºäºè´å¶æ–¯å†³ç­–ç†è®ºçš„åˆ†ç±»æ–¹æ³•\">åŸºäºè´å¶æ–¯å†³ç­–ç†è®ºçš„åˆ†ç±»æ–¹æ³•</h2>\n<p><strong>æœ´ç´ è´å¶æ–¯æ˜¯è´å¶æ–¯å†³ç­–ç†è®ºçš„ä¸€éƒ¨åˆ†</strong> -\nä¼˜ç‚¹ï¼šåœ¨æ•°æ®è¾ƒå°‘çš„æƒ…å†µä¸‹ä»ç„¶æœ‰æ•ˆï¼Œå¯ä»¥å¤„ç†å¤šç±»åˆ«é—®é¢˜ -\nç¼ºç‚¹ï¼šå¯¹äºè¾“å…¥æ•°æ®çš„å‡†å¤‡æ–¹å¼è¾ƒä¸ºæ•æ„Ÿ - é€‚ç”¨æ•°æ®ç±»å‹ï¼šæ ‡ç§°å‹æ•°æ®</p>\n<p><em>æ ‡ç§°å‹ï¼šä¸€èˆ¬åœ¨æœ‰é™çš„æ•°æ®ä¸­å–ï¼Œè€Œä¸”åªå­˜åœ¨â€˜æ˜¯â€™å’Œâ€˜å¦â€™ä¸¤ç§ä¸åŒçš„ç»“æœï¼ˆä¸€èˆ¬ç”¨äºåˆ†ç±»ï¼‰</em>\n<em>æ•°å€¼å‹ï¼šå¯ä»¥åœ¨æ— é™çš„æ•°æ®ä¸­å–ï¼Œè€Œä¸”æ•°å€¼æ¯”è¾ƒå…·ä½“åŒ–ï¼Œä¾‹å¦‚4.02,6.23è¿™ç§å€¼ï¼ˆä¸€èˆ¬ç”¨äºå›å½’åˆ†æï¼‰</em></p>\n<h4 id=\"è´å¶æ–¯å†³ç­–ç†è®ºçš„æ ¸å¿ƒæ€æƒ³å³é€‰æ‹©å…·æœ‰æœ€é«˜æ¦‚ç‡çš„å†³ç­–\"><strong>è´å¶æ–¯å†³ç­–ç†è®ºçš„æ ¸å¿ƒæ€æƒ³ï¼Œå³é€‰æ‹©å…·æœ‰æœ€é«˜æ¦‚ç‡çš„å†³ç­–</strong></h4>\n<ul>\n<li><p>å‡è®¾ç°åœ¨æˆ‘ä»¬æœ‰ä¸€ä¸ªæ•°æ®é›†ï¼Œå®ƒç”±ä¸¤ç±»æ•°æ®ç»„æˆï¼Œæ•°æ®åˆ†å¸ƒå¦‚å›¾ <img src=\"/.top//attachment:e36f25cc-1cec-4995-809d-c7812f629c99.png\" alt=\"image.png\"></p></li>\n<li><p>æˆ‘ä»¬ç°åœ¨ç”¨p1(x,y)è¡¨ç¤ºæ•°æ®ç‚¹(x,y)å±äºç±»åˆ«1ï¼ˆå›¾ä¸­ç”¨åœ†ç‚¹è¡¨ç¤ºçš„ç±»åˆ«ï¼‰çš„æ¦‚ç‡ï¼Œç”¨p2(x,y)è¡¨ç¤ºæ•°æ®ç‚¹(x,y)å±äºç±»åˆ«2ï¼ˆå›¾ä¸­ç”¨ä¸‰è§’å½¢è¡¨ç¤ºçš„ç±»åˆ«ï¼‰çš„æ¦‚ç‡ï¼Œé‚£ä¹ˆå¯¹äºä¸€ä¸ªæ–°æ•°æ®ç‚¹(x,y)ï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„è§„åˆ™æ¥åˆ¤æ–­å®ƒçš„ç±»åˆ«ï¼š</p></li>\n<li><p>å¦‚æœ p1(x,y) &gt; p2(x,y)ï¼Œé‚£ä¹ˆç±»åˆ«ä¸º1</p></li>\n<li><p>å¦‚æœ p2(x,y) &gt; p1(x,y)ï¼Œé‚£ä¹ˆç±»åˆ«ä¸º2</p></li>\n<li><p><strong>è®¡ç®—åˆ†ç±»çš„æ–¹æ³•</strong></p></li>\n<li><p>ä½¿ç”¨kNNï¼Œè¿›è¡Œ1000æ¬¡è·ç¦»è®¡ç®—ï¼›</p></li>\n<li><p>ä½¿ç”¨å†³ç­–æ ‘ï¼Œåˆ†åˆ«æ²¿xè½´ã€yè½´åˆ’åˆ†æ•°æ®ï¼›</p></li>\n<li><p>è®¡ç®—æ•°æ®ç‚¹å±äºæ¯ä¸ªç±»åˆ«çš„æ¦‚ç‡ï¼Œå¹¶è¿›è¡Œæ¯”è¾ƒ</p></li>\n</ul>\n<h4 id=\"æ¡ä»¶æ¦‚ç‡\"><strong>æ¡ä»¶æ¦‚ç‡</strong></h4>\n<p><img src=\"/.top//attachment:40d76e00-9bfb-4c92-af12-2257b8e49fc1.png\" alt=\"image.png\"> -\nè®¡ç®—ä»Bæ¡¶ä¸­å–åˆ°ç°è‰²çŸ³å¤´çš„æ¦‚ç‡çš„åŠæ³•ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„æ¡ä»¶æ¦‚ç‡ï¼ˆconditionalprobabilityï¼‰ã€‚å‡å®šè®¡ç®—çš„æ˜¯ä»Bæ¡¶å–åˆ°ç°è‰²çŸ³å¤´çš„æ¦‚ç‡ï¼Œè¿™ä¸ªæ¦‚ç‡å¯ä»¥è®°ä½œP(gray|bucketB)ï¼Œ\n-\næˆ‘ä»¬ç§°ä¹‹ä¸ºâ€œåœ¨å·²çŸ¥çŸ³å¤´å‡ºè‡ªBæ¡¶çš„æ¡ä»¶ä¸‹ï¼Œå–å‡ºç°è‰²çŸ³å¤´çš„æ¦‚ç‡â€ã€‚ä¸éš¾å¾—åˆ°ï¼ŒP(gray|bucketA)å€¼ä¸º2/4ï¼ŒP(gray|bucketB)\nçš„å€¼ä¸º1/3ã€‚ <img src=\"/.top//attachment:b6ba6689-3ad1-4a37-96c0-ccc2326b99a8.png\" alt=\"image.png\"></p>\n<h2 id=\"ä½¿ç”¨æ¡ä»¶æ¦‚ç‡åˆ†ç±»\"><strong>ä½¿ç”¨æ¡ä»¶æ¦‚ç‡åˆ†ç±»</strong></h2>\n<ul>\n<li><p>ä¹‹å‰è´å¶æ–¯å†³ç­–ç†è®ºè¦æ±‚è®¡ç®—ä¸¤ä¸ªæ¦‚ç‡p1(x, y)å’Œp2(x, y)ï¼š</p></li>\n<li><p>å¦‚æœp1(x, y) &gt; p2(x, y)ï¼Œé‚£ä¹ˆå±äºç±»åˆ«1ï¼›</p></li>\n<li><p>å¦‚æœp2(x, y) &gt; p1(x, y)ï¼Œé‚£ä¹ˆå±äºç±»åˆ«2ã€‚</p></li>\n<li><p>ä½¿ç”¨p1( )å’Œp2(\n)åªæ˜¯ä¸ºäº†å°½å¯èƒ½ç®€åŒ–æè¿°ï¼ŒçœŸæ­£éœ€è¦è®¡ç®—å’Œæ¯”è¾ƒçš„æ˜¯p(c1|x, y)å’Œp(c2|x,\ny)ã€‚è¿™äº›ç¬¦å·æ‰€ä»£è¡¨çš„å…·ä½“æ„ä¹‰æ˜¯ï¼š</p></li>\n<li><p>ç»™å®šæŸä¸ªç”±xã€yè¡¨ç¤ºçš„æ•°æ®ç‚¹ï¼Œé‚£ä¹ˆè¯¥æ•°æ®ç‚¹æ¥è‡ªç±»åˆ«c1çš„æ¦‚ç‡æ˜¯å¤šå°‘ï¼Ÿ</p></li>\n<li><p>æ•°æ®ç‚¹æ¥è‡ªç±»åˆ«c2çš„æ¦‚ç‡åˆæ˜¯å¤šå°‘ï¼Ÿ <img src=\"/.top//attachment:4ca58d34-234e-4fa6-b572-4b591bd36e18.png\" alt=\"image.png\"></p></li>\n<li><p>ä½¿ç”¨è¿™äº›å®šä¹‰ï¼Œå¯ä»¥å®šä¹‰è´å¶æ–¯åˆ†ç±»å‡†åˆ™ä¸ºï¼š</p></li>\n<li><p>å¦‚æœP(c1|x, y) &gt; P(c2|x, y)ï¼Œé‚£ä¹ˆå±äºç±»åˆ«c1ã€‚</p></li>\n<li><p>å¦‚æœP(c1|x, y) &lt; P(c2|x, y)ï¼Œé‚£ä¹ˆå±äºç±»åˆ«c2ã€‚</p></li>\n</ul>\n<h2 id=\"ä½¿ç”¨æœ´ç´ è´å¶æ–¯è¿›è¡Œæ–‡æœ¬åˆ†ç±»\"><strong>ä½¿ç”¨æœ´ç´ è´å¶æ–¯è¿›è¡Œæ–‡æœ¬åˆ†ç±»</strong></h2>\n<ul>\n<li><p>æœ´ç´ è´å¶æ–¯çš„ä¸€èˆ¬è¿‡ç¨‹</p></li>\n<li><p>æ”¶é›†æ•°æ®ï¼š</p></li>\n<li><p>å‡†å¤‡æ•°æ®ï¼šéœ€è¦æ•°å€¼å‹ æˆ–è€…å¸ƒå°”å‹æ•°æ®</p></li>\n<li><p>åˆ†ææ•°æ®ï¼šæœ‰å¤§é‡ç‰¹å¾æ—¶ï¼Œç»˜åˆ¶ç‰¹å¾ä½œç”¨ä¸å¤§ï¼Œ\næ­¤æ—¶ä½¿ç”¨ç›´æ–¹å›¾æ•ˆæœæ›´å¥½</p></li>\n<li><p>è®­ç»ƒç®—æ³•ï¼šè®¡ç®—ä¸åŒçš„ç‹¬ç«‹ç‰¹å¾çš„æ¡ä»¶æ¦‚ç‡</p></li>\n<li><p>æµ‹è¯•ç®—æ³•ï¼šè®¡ç®—é”™è¯¯ç‡</p></li>\n<li><p>ä½¿ç”¨ç®—æ³•ï¼šä¸€ä¸ªå¸¸è§çš„æœ´ç´ è´å¶æ–¯åº”ç”¨æ˜¯æ–‡æ¡£åˆ†ç±»ï¼Œå¯ä»¥ä»»æ„çš„åˆ†ç±»åœºæ™¯ä¸­ä½¿ç”¨æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨</p></li>\n<li><p>ç‰¹å¾ä¹‹é—´ç›¸äº’ç‹¬ç«‹ï¼ˆindependenceï¼‰ï¼šæŒ‡çš„æ˜¯ç»Ÿè®¡æ„ä¹‰ä¸Šçš„ç‹¬ç«‹ï¼Œå³ä¸€ä¸ªç‰¹å¾æˆ–è€…å•è¯å‡ºç°çš„å¯èƒ½æ€§ä¸å®ƒå’Œå…¶ä»–å•è¯ç›¸é‚»æ²¡æœ‰å…³ç³»</p></li>\n<li><p>æ¯ä¸ªç‰¹å¾åŒç­‰é‡è¦</p></li>\n</ul>\n<h2 id=\"æ–‡æœ¬åˆ†ç±»\"><strong>æ–‡æœ¬åˆ†ç±»</strong></h2>\n<h4 id=\"å‡†å¤‡æ•°æ®ä»æ–‡æœ¬ä¸­æ„å»ºè¯å‘é‡\"><strong>å‡†å¤‡æ•°æ®ï¼šä»æ–‡æœ¬ä¸­æ„å»ºè¯å‘é‡</strong></h4>\n<div class=\"sourceCode\" id=\"cb1\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb1-1\"><a href=\"#cb1-1\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"im\">import</span> sys</span>\n<span id=\"cb1-2\"><a href=\"#cb1-2\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"im\">import</span> numpy <span class=\"im\">as</span> np</span>\n<span id=\"cb1-3\"><a href=\"#cb1-3\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"bu\">print</span>(sys.executable)</span></code></pre></div>\n<pre><code>/Users/gaozhiyong/Documents/pyenv/pyenv3.6/bin/python</code></pre>\n<div class=\"sourceCode\" id=\"cb3\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb3-1\"><a href=\"#cb3-1\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">def</span> loadDataSet():</span>\n<span id=\"cb3-2\"><a href=\"#cb3-2\" aria-hidden=\"true\" tabindex=\"-1\"></a>    postingList <span class=\"op\">=</span> [</span>\n<span id=\"cb3-3\"><a href=\"#cb3-3\" aria-hidden=\"true\" tabindex=\"-1\"></a>        [<span class=\"st\">&#39;my&#39;</span>,<span class=\"st\">&#39;dog&#39;</span>,<span class=\"st\">&#39;has&#39;</span>,<span class=\"st\">&#39;flea&#39;</span>,<span class=\"st\">&#39;problems&#39;</span>,<span class=\"st\">&#39;help&#39;</span>,<span class=\"st\">&#39;please&#39;</span>],</span>\n<span id=\"cb3-4\"><a href=\"#cb3-4\" aria-hidden=\"true\" tabindex=\"-1\"></a>        [<span class=\"st\">&#39;maybe&#39;</span>,<span class=\"st\">&#39;not&#39;</span>,<span class=\"st\">&#39;take&#39;</span>,<span class=\"st\">&#39;him&#39;</span>,<span class=\"st\">&#39;to&#39;</span>,<span class=\"st\">&#39;dog&#39;</span>,<span class=\"st\">&#39;park&#39;</span>,<span class=\"st\">&#39;stupid&#39;</span>],</span>\n<span id=\"cb3-5\"><a href=\"#cb3-5\" aria-hidden=\"true\" tabindex=\"-1\"></a>        [<span class=\"st\">&#39;my&#39;</span>,<span class=\"st\">&#39;dalmation&#39;</span>,<span class=\"st\">&#39;is&#39;</span>,<span class=\"st\">&#39;so&#39;</span>,<span class=\"st\">&#39;cute&#39;</span>,<span class=\"st\">&#39;I&#39;</span>,<span class=\"st\">&#39;love&#39;</span>,<span class=\"st\">&#39;him&#39;</span>],</span>\n<span id=\"cb3-6\"><a href=\"#cb3-6\" aria-hidden=\"true\" tabindex=\"-1\"></a>        [<span class=\"st\">&#39;stop&#39;</span>,<span class=\"st\">&#39;posting&#39;</span>,<span class=\"st\">&#39;stupid&#39;</span>,<span class=\"st\">&#39;worthless&#39;</span>,<span class=\"st\">&#39;garbage&#39;</span>],</span>\n<span id=\"cb3-7\"><a href=\"#cb3-7\" aria-hidden=\"true\" tabindex=\"-1\"></a>        [<span class=\"st\">&#39;mr&#39;</span>,<span class=\"st\">&#39;licks&#39;</span>,<span class=\"st\">&#39;ate&#39;</span>,<span class=\"st\">&#39;my&#39;</span>,<span class=\"st\">&#39;steak&#39;</span>,<span class=\"st\">&#39;how&#39;</span>,<span class=\"st\">&#39;to&#39;</span>,<span class=\"st\">&#39;stop&#39;</span>,<span class=\"st\">&#39;him&#39;</span>],</span>\n<span id=\"cb3-8\"><a href=\"#cb3-8\" aria-hidden=\"true\" tabindex=\"-1\"></a>        [<span class=\"st\">&#39;quit&#39;</span>,<span class=\"st\">&#39;buying&#39;</span>,<span class=\"st\">&#39;worthless&#39;</span>,<span class=\"st\">&#39;dog&#39;</span>,<span class=\"st\">&#39;food&#39;</span>,<span class=\"st\">&#39;stupid&#39;</span>]</span>\n<span id=\"cb3-9\"><a href=\"#cb3-9\" aria-hidden=\"true\" tabindex=\"-1\"></a>    ]</span>\n<span id=\"cb3-10\"><a href=\"#cb3-10\" aria-hidden=\"true\" tabindex=\"-1\"></a>    classVec <span class=\"op\">=</span> [<span class=\"dv\">0</span>,<span class=\"dv\">1</span>,<span class=\"dv\">0</span>,<span class=\"dv\">1</span>,<span class=\"dv\">0</span>,<span class=\"dv\">1</span>]</span>\n<span id=\"cb3-11\"><a href=\"#cb3-11\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"cf\">return</span> postingList,classVec</span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb4\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb4-1\"><a href=\"#cb4-1\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">def</span> createVocabList(dataSet):</span>\n<span id=\"cb4-2\"><a href=\"#cb4-2\" aria-hidden=\"true\" tabindex=\"-1\"></a>    vocabSet <span class=\"op\">=</span> <span class=\"bu\">set</span>([])    <span class=\"co\">#åˆ›å»ºä¸€ä¸ªç©ºé›†</span></span>\n<span id=\"cb4-3\"><a href=\"#cb4-3\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"cf\">for</span> document <span class=\"kw\">in</span> dataSet:</span>\n<span id=\"cb4-4\"><a href=\"#cb4-4\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"co\">#         print(&#39;document&#39;,document)</span></span>\n<span id=\"cb4-5\"><a href=\"#cb4-5\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"co\">#         print(&quot;vocabSetä¹‹å‰&quot;,vocabSet)</span></span>\n<span id=\"cb4-6\"><a href=\"#cb4-6\" aria-hidden=\"true\" tabindex=\"-1\"></a>        vocabSet <span class=\"op\">=</span> vocabSet <span class=\"op\">|</span> <span class=\"bu\">set</span>(document)  <span class=\"co\">#åˆ›å»ºä¸¤ä¸ªé›†åˆçš„å¹¶é›†</span></span>\n<span id=\"cb4-7\"><a href=\"#cb4-7\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"co\">#         print(&quot;vocabSetä¹‹å&quot;,vocabSet)</span></span>\n<span id=\"cb4-8\"><a href=\"#cb4-8\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"cf\">return</span> <span class=\"bu\">list</span>(vocabSet)</span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb5\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb5-1\"><a href=\"#cb5-1\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">def</span> setOfWord2Vec(vocabList,inputSet):</span>\n<span id=\"cb5-2\"><a href=\"#cb5-2\" aria-hidden=\"true\" tabindex=\"-1\"></a>    returnVec <span class=\"op\">=</span> [<span class=\"dv\">0</span>] <span class=\"op\">*</span> <span class=\"bu\">len</span>(vocabList)</span>\n<span id=\"cb5-3\"><a href=\"#cb5-3\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"cf\">for</span> word <span class=\"kw\">in</span> inputSet:</span>\n<span id=\"cb5-4\"><a href=\"#cb5-4\" aria-hidden=\"true\" tabindex=\"-1\"></a>        <span class=\"cf\">if</span> word <span class=\"kw\">in</span> vocabList:</span>\n<span id=\"cb5-5\"><a href=\"#cb5-5\" aria-hidden=\"true\" tabindex=\"-1\"></a>            returnVec[vocabList.index(word)] <span class=\"op\">=</span> <span class=\"dv\">1</span></span>\n<span id=\"cb5-6\"><a href=\"#cb5-6\" aria-hidden=\"true\" tabindex=\"-1\"></a>        <span class=\"cf\">else</span>:</span>\n<span id=\"cb5-7\"><a href=\"#cb5-7\" aria-hidden=\"true\" tabindex=\"-1\"></a>            <span class=\"bu\">print</span>(<span class=\"st\">&quot;the word: </span><span class=\"sc\">%s</span><span class=\"st\"> is not in my Vocabulary!&quot;</span> <span class=\"op\">%</span> word )</span>\n<span id=\"cb5-8\"><a href=\"#cb5-8\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"cf\">return</span> returnVec</span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb6\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb6-1\"><a href=\"#cb6-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>listOPosts,listClasses <span class=\"op\">=</span> loadDataSet()</span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb7\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb7-1\"><a href=\"#cb7-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>listOPosts</span></code></pre></div>\n<pre><code>[[&#39;my&#39;, &#39;dog&#39;, &#39;has&#39;, &#39;flea&#39;, &#39;problems&#39;, &#39;help&#39;, &#39;please&#39;],\n [&#39;maybe&#39;, &#39;not&#39;, &#39;take&#39;, &#39;him&#39;, &#39;to&#39;, &#39;dog&#39;, &#39;park&#39;, &#39;stupid&#39;],\n [&#39;my&#39;, &#39;dalmation&#39;, &#39;is&#39;, &#39;so&#39;, &#39;cute&#39;, &#39;I&#39;, &#39;love&#39;, &#39;him&#39;],\n [&#39;stop&#39;, &#39;posting&#39;, &#39;stupid&#39;, &#39;worthless&#39;, &#39;garbage&#39;],\n [&#39;mr&#39;, &#39;licks&#39;, &#39;ate&#39;, &#39;my&#39;, &#39;steak&#39;, &#39;how&#39;, &#39;to&#39;, &#39;stop&#39;, &#39;him&#39;],\n [&#39;quit&#39;, &#39;buying&#39;, &#39;worthless&#39;, &#39;dog&#39;, &#39;food&#39;, &#39;stupid&#39;]]</code></pre>\n<div class=\"sourceCode\" id=\"cb9\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb9-1\"><a href=\"#cb9-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>listClasses</span></code></pre></div>\n<pre><code>[0, 1, 0, 1, 0, 1]</code></pre>\n<div class=\"sourceCode\" id=\"cb11\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb11-1\"><a href=\"#cb11-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>myVocabList <span class=\"op\">=</span> createVocabList(listOPosts)</span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb12\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb12-1\"><a href=\"#cb12-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>myVocabList</span></code></pre></div>\n<pre><code>[&#39;stop&#39;,\n &#39;dalmation&#39;,\n &#39;park&#39;,\n &#39;please&#39;,\n &#39;my&#39;,\n &#39;to&#39;,\n &#39;problems&#39;,\n &#39;posting&#39;,\n &#39;flea&#39;,\n &#39;steak&#39;,\n &#39;him&#39;,\n &#39;take&#39;,\n &#39;ate&#39;,\n &#39;is&#39;,\n &#39;help&#39;,\n &#39;how&#39;,\n &#39;cute&#39;,\n &#39;has&#39;,\n &#39;maybe&#39;,\n &#39;food&#39;,\n &#39;buying&#39;,\n &#39;stupid&#39;,\n &#39;licks&#39;,\n &#39;mr&#39;,\n &#39;dog&#39;,\n &#39;not&#39;,\n &#39;love&#39;,\n &#39;worthless&#39;,\n &#39;I&#39;,\n &#39;so&#39;,\n &#39;quit&#39;,\n &#39;garbage&#39;]</code></pre>\n<div class=\"sourceCode\" id=\"cb14\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb14-1\"><a href=\"#cb14-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>listOPosts[<span class=\"dv\">0</span>]</span></code></pre></div>\n<pre><code>[&#39;my&#39;, &#39;dog&#39;, &#39;has&#39;, &#39;flea&#39;, &#39;problems&#39;, &#39;help&#39;, &#39;please&#39;]</code></pre>\n<div class=\"sourceCode\" id=\"cb16\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb16-1\"><a href=\"#cb16-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>setOfWord2Vec(myVocabList,listOPosts[<span class=\"dv\">0</span>])</span></code></pre></div>\n<pre><code>[0,\n 0,\n 0,\n 1,\n 1,\n 0,\n 1,\n 0,\n 1,\n 0,\n 0,\n 0,\n 0,\n 0,\n 1,\n 0,\n 0,\n 1,\n 0,\n 0,\n 0,\n 0,\n 0,\n 0,\n 1,\n 0,\n 0,\n 0,\n 0,\n 0,\n 0,\n 0]</code></pre>\n<div class=\"sourceCode\" id=\"cb18\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb18-1\"><a href=\"#cb18-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>setOfWord2Vec(myVocabList,listOPosts[<span class=\"dv\">3</span>])</span></code></pre></div>\n<pre><code>[1,\n 0,\n 0,\n 0,\n 0,\n 0,\n 0,\n 1,\n 0,\n 0,\n 0,\n 0,\n 0,\n 0,\n 0,\n 0,\n 0,\n 0,\n 0,\n 0,\n 0,\n 1,\n 0,\n 0,\n 0,\n 0,\n 0,\n 1,\n 0,\n 0,\n 0,\n 1]</code></pre>\n<h4 id=\"è®­ç»ƒç®—æ³•ä»è¯å‘é‡è®¡ç®—æ¦‚ç‡\"><strong>è®­ç»ƒç®—æ³•ï¼šä»è¯å‘é‡è®¡ç®—æ¦‚ç‡</strong></h4>\n<p><img src=\"/.top//attachment:40c1d39c-159e-4c7f-a811-45a728741340.png\" alt=\"image.png\"> -\nä½¿ç”¨ä¸Šè¿°å…¬å¼ï¼Œå¯¹æ¯ä¸ªç±»è®¡ç®—è¯¥å€¼ï¼Œç„¶åæ¯”è¾ƒè¿™ä¸¤ä¸ªæ¦‚ç‡å€¼çš„å¤§å°ã€‚ -\nå¦‚ä½•è®¡ç®—å‘¢ï¼Ÿ -\né¦–å…ˆå¯ä»¥é€šè¿‡ç±»åˆ«iï¼ˆä¾®è¾±æ€§ç•™è¨€æˆ–éä¾®è¾±æ€§ç•™è¨€ï¼‰ä¸­æ–‡æ¡£æ•°é™¤ä»¥æ€»çš„æ–‡æ¡£æ•°æ¥è®¡ç®—æ¦‚ç‡p(ci)ã€‚\n- æ¥ä¸‹æ¥è®¡ç®—p(w|ci)ï¼Œè¿™é‡Œå°±è¦ç”¨åˆ°æœ´ç´ è´å¶æ–¯å‡è®¾ã€‚ -\nå¦‚æœå°†wå±•å¼€ä¸ºä¸€ä¸ªä¸ªç‹¬ç«‹ç‰¹å¾ï¼Œé‚£ä¹ˆå°±å¯ä»¥å°†ä¸Šè¿°æ¦‚ç‡å†™ä½œp(w0,w1,w2..wN|ci)ã€‚\n-\nè¿™é‡Œå‡è®¾æ‰€æœ‰è¯éƒ½äº’ç›¸ç‹¬ç«‹ï¼Œè¯¥å‡è®¾ä¹Ÿç§°ä½œæ¡ä»¶ç‹¬ç«‹æ€§å‡è®¾ï¼Œå®ƒæ„å‘³ç€å¯ä»¥ä½¿p(w0|ci)p(w1|ci)p(w2|ci)...p(wN|ci)æ¥è®¡ç®—ä¸Šè¿°æ¦‚ç‡</p>\n<h5 id=\"ä»£ç é€»è¾‘\"><strong>ä»£ç é€»è¾‘</strong></h5>\n<ul>\n<li>è®¡ç®—æ¯ä¸ªç±»åˆ«ä¸­çš„æ–‡æ¡£æ•°ç›®</li>\n<li>å¯¹æ¯ç¯‡è®­ç»ƒæ–‡æ¡£</li>\n<li>å¯¹æ¯ä¸ªç±»åˆ«\n<ul>\n<li>å¦‚æœè¯æ¡å‡ºç°åœ¨æ–‡æ¡£ä¸­ --- å¢åŠ è¯¥è¯æ¡çš„è®¡æ•°å€¼</li>\n<li>å¢åŠ æ‰€æœ‰è¯æ¡çš„è®¡æ•°å€¼</li>\n</ul></li>\n<li>å¯¹æ¯ä¸ªç±»åˆ«\n<ul>\n<li>å¯¹æ¯ä¸ªè¯æ¡\n<ul>\n<li>å°† <strong>è¯¥è¯æ¡çš„æ•°ç›®</strong> é™¤ä»¥ <strong>æ€»è¯æ•°ç›®</strong> å¾—åˆ°\n<strong>æ¡ä»¶æ¦‚ç‡</strong></li>\n</ul></li>\n</ul></li>\n<li>è¿”å›æ¯ä¸ªç±»åˆ«çš„æ¡ä»¶æ¦‚ç‡</li>\n</ul>\n<div class=\"sourceCode\" id=\"cb20\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb20-1\"><a href=\"#cb20-1\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">def</span> trainNB0(trainMatrix,trainCategory):</span>\n<span id=\"cb20-2\"><a href=\"#cb20-2\" aria-hidden=\"true\" tabindex=\"-1\"></a>    numTrainDocs <span class=\"op\">=</span> <span class=\"bu\">len</span>(trainMatrix)</span>\n<span id=\"cb20-3\"><a href=\"#cb20-3\" aria-hidden=\"true\" tabindex=\"-1\"></a>    numWords <span class=\"op\">=</span> <span class=\"bu\">len</span>(trainMatrix[<span class=\"dv\">0</span>])</span>\n<span id=\"cb20-4\"><a href=\"#cb20-4\" aria-hidden=\"true\" tabindex=\"-1\"></a>    pAbusive <span class=\"op\">=</span> <span class=\"bu\">sum</span>(trainCategory) <span class=\"op\">/</span> <span class=\"bu\">float</span>(numTrainDocs)</span>\n<span id=\"cb20-5\"><a href=\"#cb20-5\" aria-hidden=\"true\" tabindex=\"-1\"></a>    p0Num <span class=\"op\">=</span> np.zeros(numWords) </span>\n<span id=\"cb20-6\"><a href=\"#cb20-6\" aria-hidden=\"true\" tabindex=\"-1\"></a>    p1Num <span class=\"op\">=</span> np.zeros(numWords)</span>\n<span id=\"cb20-7\"><a href=\"#cb20-7\" aria-hidden=\"true\" tabindex=\"-1\"></a>    p0Denom <span class=\"op\">=</span> <span class=\"fl\">0.0</span></span>\n<span id=\"cb20-8\"><a href=\"#cb20-8\" aria-hidden=\"true\" tabindex=\"-1\"></a>    p1Denom <span class=\"op\">=</span> <span class=\"fl\">0.0</span></span>\n<span id=\"cb20-9\"><a href=\"#cb20-9\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"cf\">for</span> i <span class=\"kw\">in</span> <span class=\"bu\">range</span>(numTrainDocs):</span>\n<span id=\"cb20-10\"><a href=\"#cb20-10\" aria-hidden=\"true\" tabindex=\"-1\"></a>        <span class=\"cf\">try</span>:</span>\n<span id=\"cb20-11\"><a href=\"#cb20-11\" aria-hidden=\"true\" tabindex=\"-1\"></a>            <span class=\"cf\">if</span> trainCategory[i] <span class=\"op\">==</span> <span class=\"dv\">1</span>:</span>\n<span id=\"cb20-12\"><a href=\"#cb20-12\" aria-hidden=\"true\" tabindex=\"-1\"></a>                p1Num <span class=\"op\">+=</span> trainMatrix[i]</span>\n<span id=\"cb20-13\"><a href=\"#cb20-13\" aria-hidden=\"true\" tabindex=\"-1\"></a>                p1Denom <span class=\"op\">+=</span> <span class=\"bu\">sum</span>(trainMatrix[i])</span>\n<span id=\"cb20-14\"><a href=\"#cb20-14\" aria-hidden=\"true\" tabindex=\"-1\"></a>            <span class=\"cf\">else</span>:</span>\n<span id=\"cb20-15\"><a href=\"#cb20-15\" aria-hidden=\"true\" tabindex=\"-1\"></a>                p0Num <span class=\"op\">+=</span> trainMatrix[i]</span>\n<span id=\"cb20-16\"><a href=\"#cb20-16\" aria-hidden=\"true\" tabindex=\"-1\"></a>                p0Denom <span class=\"op\">+=</span> <span class=\"bu\">sum</span>(trainMatrix[i])</span>\n<span id=\"cb20-17\"><a href=\"#cb20-17\" aria-hidden=\"true\" tabindex=\"-1\"></a>        <span class=\"cf\">except</span>:</span>\n<span id=\"cb20-18\"><a href=\"#cb20-18\" aria-hidden=\"true\" tabindex=\"-1\"></a>            <span class=\"cf\">continue</span></span>\n<span id=\"cb20-19\"><a href=\"#cb20-19\" aria-hidden=\"true\" tabindex=\"-1\"></a>    p1Vect <span class=\"op\">=</span> p1Num <span class=\"op\">/</span> p1Denom</span>\n<span id=\"cb20-20\"><a href=\"#cb20-20\" aria-hidden=\"true\" tabindex=\"-1\"></a>    p0Vect <span class=\"op\">=</span> p0Num <span class=\"op\">/</span> p0Denom</span>\n<span id=\"cb20-21\"><a href=\"#cb20-21\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"cf\">return</span> p0Vect,p1Vect,pAbusive</span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb21\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb21-1\"><a href=\"#cb21-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>listOPosts,listClasses <span class=\"op\">=</span> loadDataSet()</span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb22\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb22-1\"><a href=\"#cb22-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>myVocabList <span class=\"op\">=</span> createVocabList(listOPosts)</span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb23\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb23-1\"><a href=\"#cb23-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>trainMat <span class=\"op\">=</span> []</span>\n<span id=\"cb23-2\"><a href=\"#cb23-2\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"cf\">for</span> postinDoc <span class=\"kw\">in</span> listOPosts:</span>\n<span id=\"cb23-3\"><a href=\"#cb23-3\" aria-hidden=\"true\" tabindex=\"-1\"></a>    trainMat.append(setOfWord2Vec(myVocabList,postinDoc))</span>\n<span id=\"cb23-4\"><a href=\"#cb23-4\" aria-hidden=\"true\" tabindex=\"-1\"></a>p0V,p1V,pAb <span class=\"op\">=</span> trainNB0(trainMat,listClasses)</span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb24\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb24-1\"><a href=\"#cb24-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>pAb</span></code></pre></div>\n<pre><code>0.5</code></pre>\n<div class=\"sourceCode\" id=\"cb26\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb26-1\"><a href=\"#cb26-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>p0V</span></code></pre></div>\n<pre><code>array([0.04166667, 0.04166667, 0.        , 0.04166667, 0.125     ,\n       0.04166667, 0.04166667, 0.        , 0.04166667, 0.04166667,\n       0.08333333, 0.        , 0.04166667, 0.04166667, 0.04166667,\n       0.04166667, 0.04166667, 0.04166667, 0.        , 0.        ,\n       0.        , 0.        , 0.04166667, 0.04166667, 0.04166667,\n       0.        , 0.04166667, 0.        , 0.04166667, 0.04166667,\n       0.        , 0.        ])</code></pre>\n<div class=\"sourceCode\" id=\"cb28\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb28-1\"><a href=\"#cb28-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>p1V</span></code></pre></div>\n<pre><code>array([0.05263158, 0.        , 0.05263158, 0.        , 0.        ,\n       0.05263158, 0.        , 0.05263158, 0.        , 0.        ,\n       0.05263158, 0.05263158, 0.        , 0.        , 0.        ,\n       0.        , 0.        , 0.        , 0.05263158, 0.05263158,\n       0.05263158, 0.15789474, 0.        , 0.        , 0.10526316,\n       0.05263158, 0.        , 0.10526316, 0.        , 0.        ,\n       0.05263158, 0.05263158])</code></pre>\n<h4 id=\"æµ‹è¯•ç®—æ³•æ ¹æ®ç°å®æƒ…å†µä¿®æ”¹åˆ†ç±»å™¨\"><strong>æµ‹è¯•ç®—æ³•ï¼šæ ¹æ®ç°å®æƒ…å†µä¿®æ”¹åˆ†ç±»å™¨</strong></h4>\n<div class=\"sourceCode\" id=\"cb30\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb30-1\"><a href=\"#cb30-1\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">def</span> trainNB1(trainMatrix,trainCategory):</span>\n<span id=\"cb30-2\"><a href=\"#cb30-2\" aria-hidden=\"true\" tabindex=\"-1\"></a>    numTrainDocs <span class=\"op\">=</span> <span class=\"bu\">len</span>(trainMatrix)</span>\n<span id=\"cb30-3\"><a href=\"#cb30-3\" aria-hidden=\"true\" tabindex=\"-1\"></a>    numWords <span class=\"op\">=</span> <span class=\"bu\">len</span>(trainMatrix[<span class=\"dv\">0</span>])</span>\n<span id=\"cb30-4\"><a href=\"#cb30-4\" aria-hidden=\"true\" tabindex=\"-1\"></a>    pAbusive <span class=\"op\">=</span> <span class=\"bu\">sum</span>(trainCategory) <span class=\"op\">/</span> <span class=\"bu\">float</span>(numTrainDocs)</span>\n<span id=\"cb30-5\"><a href=\"#cb30-5\" aria-hidden=\"true\" tabindex=\"-1\"></a>    p0Num <span class=\"op\">=</span> np.ones(numWords) </span>\n<span id=\"cb30-6\"><a href=\"#cb30-6\" aria-hidden=\"true\" tabindex=\"-1\"></a>    p1Num <span class=\"op\">=</span> np.ones(numWords)</span>\n<span id=\"cb30-7\"><a href=\"#cb30-7\" aria-hidden=\"true\" tabindex=\"-1\"></a>    p0Denom <span class=\"op\">=</span> <span class=\"fl\">2.0</span></span>\n<span id=\"cb30-8\"><a href=\"#cb30-8\" aria-hidden=\"true\" tabindex=\"-1\"></a>    p1Denom <span class=\"op\">=</span> <span class=\"fl\">2.0</span></span>\n<span id=\"cb30-9\"><a href=\"#cb30-9\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"cf\">for</span> i <span class=\"kw\">in</span> <span class=\"bu\">range</span>(numTrainDocs):</span>\n<span id=\"cb30-10\"><a href=\"#cb30-10\" aria-hidden=\"true\" tabindex=\"-1\"></a>        <span class=\"cf\">try</span>:</span>\n<span id=\"cb30-11\"><a href=\"#cb30-11\" aria-hidden=\"true\" tabindex=\"-1\"></a>            <span class=\"cf\">if</span> trainCategory[i] <span class=\"op\">==</span> <span class=\"dv\">1</span>:</span>\n<span id=\"cb30-12\"><a href=\"#cb30-12\" aria-hidden=\"true\" tabindex=\"-1\"></a>                p1Num <span class=\"op\">+=</span> trainMatrix[i]</span>\n<span id=\"cb30-13\"><a href=\"#cb30-13\" aria-hidden=\"true\" tabindex=\"-1\"></a>                p1Denom <span class=\"op\">+=</span> <span class=\"bu\">sum</span>(trainMatrix[i])</span>\n<span id=\"cb30-14\"><a href=\"#cb30-14\" aria-hidden=\"true\" tabindex=\"-1\"></a>            <span class=\"cf\">else</span>:</span>\n<span id=\"cb30-15\"><a href=\"#cb30-15\" aria-hidden=\"true\" tabindex=\"-1\"></a>                p0Num <span class=\"op\">+=</span> trainMatrix[i]</span>\n<span id=\"cb30-16\"><a href=\"#cb30-16\" aria-hidden=\"true\" tabindex=\"-1\"></a>                p0Denom <span class=\"op\">+=</span> <span class=\"bu\">sum</span>(trainMatrix[i])</span>\n<span id=\"cb30-17\"><a href=\"#cb30-17\" aria-hidden=\"true\" tabindex=\"-1\"></a>        <span class=\"cf\">except</span>:</span>\n<span id=\"cb30-18\"><a href=\"#cb30-18\" aria-hidden=\"true\" tabindex=\"-1\"></a>            <span class=\"cf\">continue</span></span>\n<span id=\"cb30-19\"><a href=\"#cb30-19\" aria-hidden=\"true\" tabindex=\"-1\"></a>    p1Vect <span class=\"op\">=</span> np.log(p1Num <span class=\"op\">/</span> p1Denom)</span>\n<span id=\"cb30-20\"><a href=\"#cb30-20\" aria-hidden=\"true\" tabindex=\"-1\"></a>    p0Vect <span class=\"op\">=</span> np.log(p0Num <span class=\"op\">/</span> p0Denom)</span>\n<span id=\"cb30-21\"><a href=\"#cb30-21\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"cf\">return</span> p0Vect,p1Vect,pAbusive</span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb31\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb31-1\"><a href=\"#cb31-1\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">def</span> classifyNB(vec2Classify,p0Vec,p1Vec,pClass1):</span>\n<span id=\"cb31-2\"><a href=\"#cb31-2\" aria-hidden=\"true\" tabindex=\"-1\"></a>    p1<span class=\"op\">=</span><span class=\"bu\">sum</span>(vec2Classify <span class=\"op\">*</span> p1Vec) <span class=\"op\">+</span> np.log(pClass1)</span>\n<span id=\"cb31-3\"><a href=\"#cb31-3\" aria-hidden=\"true\" tabindex=\"-1\"></a>    p0<span class=\"op\">=</span> <span class=\"bu\">sum</span>(vec2Classify <span class=\"op\">*</span> p0Vec) <span class=\"op\">+</span> np.log(<span class=\"fl\">1.0</span><span class=\"op\">-</span> pClass1)</span>\n<span id=\"cb31-4\"><a href=\"#cb31-4\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"cf\">if</span> p1<span class=\"op\">&gt;</span>p0:</span>\n<span id=\"cb31-5\"><a href=\"#cb31-5\" aria-hidden=\"true\" tabindex=\"-1\"></a>        <span class=\"cf\">return</span> <span class=\"dv\">1</span></span>\n<span id=\"cb31-6\"><a href=\"#cb31-6\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"cf\">else</span>:</span>\n<span id=\"cb31-7\"><a href=\"#cb31-7\" aria-hidden=\"true\" tabindex=\"-1\"></a>        <span class=\"cf\">return</span> <span class=\"dv\">0</span></span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb32\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb32-1\"><a href=\"#cb32-1\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">def</span> testingNB():</span>\n<span id=\"cb32-2\"><a href=\"#cb32-2\" aria-hidden=\"true\" tabindex=\"-1\"></a>    listOPosts,listClasses <span class=\"op\">=</span> loadDataSet()</span>\n<span id=\"cb32-3\"><a href=\"#cb32-3\" aria-hidden=\"true\" tabindex=\"-1\"></a>    myVocabList <span class=\"op\">=</span> createVocabList(listOPosts)</span>\n<span id=\"cb32-4\"><a href=\"#cb32-4\" aria-hidden=\"true\" tabindex=\"-1\"></a>    trainMat <span class=\"op\">=</span> []</span>\n<span id=\"cb32-5\"><a href=\"#cb32-5\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"cf\">for</span> postinDoc <span class=\"kw\">in</span> listOPosts:</span>\n<span id=\"cb32-6\"><a href=\"#cb32-6\" aria-hidden=\"true\" tabindex=\"-1\"></a>        trainMat.append(setOfWord2Vec(myVocabList,postinDoc))</span>\n<span id=\"cb32-7\"><a href=\"#cb32-7\" aria-hidden=\"true\" tabindex=\"-1\"></a>    p0V,p1V,pAb <span class=\"op\">=</span> trainNB1(np.array(trainMat), np.array(listClasses))</span>\n<span id=\"cb32-8\"><a href=\"#cb32-8\" aria-hidden=\"true\" tabindex=\"-1\"></a>    testEntry1 <span class=\"op\">=</span> [<span class=\"st\">&#39;love&#39;</span>,<span class=\"st\">&#39;my&#39;</span>,<span class=\"st\">&#39;dalmation&#39;</span>]</span>\n<span id=\"cb32-9\"><a href=\"#cb32-9\" aria-hidden=\"true\" tabindex=\"-1\"></a>    thisDoc <span class=\"op\">=</span> np.array(setOfWord2Vec(myVocabList,testEntry1))</span>\n<span id=\"cb32-10\"><a href=\"#cb32-10\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"bu\">print</span>(testEntry1,<span class=\"st\">&#39;classified as: &#39;</span>,classifyNB(thisDoc,p0V,p1V,pAb))</span>\n<span id=\"cb32-11\"><a href=\"#cb32-11\" aria-hidden=\"true\" tabindex=\"-1\"></a>    </span>\n<span id=\"cb32-12\"><a href=\"#cb32-12\" aria-hidden=\"true\" tabindex=\"-1\"></a>    testEntry2 <span class=\"op\">=</span> [<span class=\"st\">&#39;stupid&#39;</span>,<span class=\"st\">&#39;garbage&#39;</span>]</span>\n<span id=\"cb32-13\"><a href=\"#cb32-13\" aria-hidden=\"true\" tabindex=\"-1\"></a>    thisDoc <span class=\"op\">=</span> np.array(setOfWord2Vec(myVocabList,testEntry2))</span>\n<span id=\"cb32-14\"><a href=\"#cb32-14\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"bu\">print</span>(testEntry2,<span class=\"st\">&#39;classified as: &#39;</span>,classifyNB(thisDoc,p0V,p1V,pAb))</span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb33\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb33-1\"><a href=\"#cb33-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>testingNB()</span></code></pre></div>\n<pre><code>[&#39;love&#39;, &#39;my&#39;, &#39;dalmation&#39;] classified as:  0\n[&#39;stupid&#39;, &#39;garbage&#39;] classified as:  1</code></pre>\n<h4 id=\"å‡†å¤‡æ•°æ®æ–‡æ¡£è¯è¢‹æ¨¡å‹\"><strong>å‡†å¤‡æ•°æ®ï¼šæ–‡æ¡£è¯è¢‹æ¨¡å‹</strong></h4>\n<ul>\n<li>å°†æ¯ä¸ªè¯çš„å‡ºç°ä¸å¦ä½œä¸ºä¸€ä¸ªç‰¹å¾ï¼Œè¿™å¯ä»¥è¢«æè¿°ä¸ºè¯é›†æ¨¡å‹(set-of-words\nmodel)ã€‚</li>\n<li>å¦‚æœä¸€ä¸ªè¯åœ¨æ–‡æ¡£ä¸­å‡ºç°ä¸æ­¢ä¸€æ¬¡ï¼Œè¿™å¯èƒ½æ„å‘³ç€åŒ…å«è¯¥è¯æ˜¯å¦å‡ºç°åœ¨æ–‡æ¡£ä¸­æ‰€ä¸èƒ½è¡¨\nè¾¾çš„æŸç§ä¿¡æ¯ï¼Œè¿™ç§æ–¹æ³•è¢«ç§°ä¸ºè¯è¢‹æ¨¡å‹(bag-of-words model)</li>\n</ul>\n<div class=\"sourceCode\" id=\"cb35\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb35-1\"><a href=\"#cb35-1\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">def</span> bagOfWords2VecMN(vocabList,inputSet):</span>\n<span id=\"cb35-2\"><a href=\"#cb35-2\" aria-hidden=\"true\" tabindex=\"-1\"></a>    returnVec <span class=\"op\">=</span> [<span class=\"dv\">0</span>] <span class=\"op\">*</span> <span class=\"bu\">len</span>(vocabList)</span>\n<span id=\"cb35-3\"><a href=\"#cb35-3\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"cf\">for</span> word <span class=\"kw\">in</span> inputSet:</span>\n<span id=\"cb35-4\"><a href=\"#cb35-4\" aria-hidden=\"true\" tabindex=\"-1\"></a>        <span class=\"cf\">if</span> word <span class=\"kw\">in</span> vocabList:</span>\n<span id=\"cb35-5\"><a href=\"#cb35-5\" aria-hidden=\"true\" tabindex=\"-1\"></a>            returnVec[vocabList.index[word]] <span class=\"op\">+=</span> <span class=\"dv\">1</span></span>\n<span id=\"cb35-6\"><a href=\"#cb35-6\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"cf\">return</span> returnVec</span></code></pre></div>\n<hr>\n<h3 id=\"about-me\">About ME</h3>\n<h5 id=\"è¯»ä¹¦åŸå—-åœ¨æœªæ¥é¢å‰æˆ‘ä»¬éƒ½æ˜¯å­©å­\">ğŸ‘‹ è¯»ä¹¦åŸå—ï¼ŒğŸ¤”\nåœ¨æœªæ¥é¢å‰ï¼Œæˆ‘ä»¬éƒ½æ˜¯å­©å­ï½</h5>\n<ul>\n<li>ğŸ“™\nä¸€ä¸ªçƒ­è¡·äºæ¢ç´¢å­¦ä¹ æ–°æ–¹å‘ã€æ–°äº‹ç‰©çš„æ™ºèƒ½äº§å“ç»ç†ï¼Œé—²æš‡æ—¶é—´å–œæ¬¢codingğŸ’»ã€ç”»å›¾ğŸ¨ã€éŸ³ä¹ğŸµã€å­¦ä¹ ing~</li>\n</ul>\n<h5 id=\"social-media\">ğŸ‘‹ Social Media</h5>\n<ul>\n<li><p>ğŸ› ï¸ Blog: <a href=\"http://oceaneyes.top\">http://oceaneyes.top</a></p></li>\n<li><p>âš¡ PMå¯¼èˆª: <a href=\"https://pmhub.oceangzy.top\">https://pmhub.oceangzy.top</a></p></li>\n<li><p>â˜˜ï¸ CNBLOG: <a href=\"https://www.cnblogs.com/oceaneyes-gzy/\">https://www.cnblogs.com/oceaneyes-gzy/</a></p></li>\n<li><p>ğŸŒ± AI PRJè‡ªå·±éƒ¨ç½²çš„ä¸€äº›ç®—æ³•demo: <a href=\"http://ai.oceangzy.top/\">http://ai.oceangzy.top/</a></p></li>\n<li><p>ğŸ“« Email: 1450136519@qq.com</p></li>\n<li><p>ğŸ’¬ WeChat: <a href=\"https://oceaneyes.top/img/wechatqrcode.jpg\">OCEANGZY</a></p></li>\n<li><p>ğŸ’¬ å…¬ä¼—å·: <a href=\"https://oceaneyes.top/img/wechatgzh.jpeg\">UncleJoker-GZY</a></p></li>\n</ul>\n<h5 id=\"åŠ å…¥å°ç»„\">ğŸ‘‹ åŠ å…¥å°ç»„~</h5>\n<p><img src=\"https://oceaneyes.top/img/zhishigroup.jpg\" title=\"åŠ å…¥ç»„ç»‡\" alt width=\"240\"></p>\n<h5 id=\"æ„Ÿè°¢æ‰“èµ\">ğŸ‘‹ æ„Ÿè°¢æ‰“èµ~</h5>\n<p><img src=\"https://oceaneyes.top/img/alipay.jpg\" title=\"æ”¯ä»˜å®æ‰“èµ\" alt width=\"140\">\n<img src=\"https://oceaneyes.top/img/wechatpay.jpg\" title=\"å¾®ä¿¡æ‰“èµ\" alt width=\"140\"></p>\n","categories":[{"name":"Artificial Intelligence","path":"api/categories/Artificial Intelligence.json"},{"name":"Machine Learning","path":"api/categories/Machine Learning.json"},{"name":"Algorithm","path":"api/categories/Algorithm.json"}],"tags":[{"name":"Machine Learning","path":"api/tags/Machine Learning.json"},{"name":"Algorithm","path":"api/tags/Algorithm.json"},{"name":"æœ´ç´ è´å¶æ–¯","path":"api/tags/æœ´ç´ è´å¶æ–¯.json"}]}
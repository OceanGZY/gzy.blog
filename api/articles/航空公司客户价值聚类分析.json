{"title":"航空公司客户价值聚类分析","slug":"航空公司客户价值聚类分析","date":"2021-02-17T15:20:07.000Z","updated":"2022-09-30T06:56:37.204Z","comments":true,"path":"api/articles/航空公司客户价值聚类分析.json","excerpt":null,"covers":["/.top//01.png","/.top//02.png","/.top//Users\\YSilhouette\\AppData\\Local\\Temp\\360zip$Temp\\360output_55_0.png\\output_55_0.png","/.top//output_57_0.png","/.top//output_57_1.png","https://oceaneyes.top/img/zhishigroup.jpg","https://oceaneyes.top/img/alipay.jpg","https://oceaneyes.top/img/wechatpay.jpg"],"content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><h2 id=\"航空公司客户价值聚类分析\">航空公司客户价值聚类分析</h2>\n<ul>\n<li>特征工程</li>\n<li>K-means聚类</li>\n<li>RFM模型</li>\n<li>DBSCAN算法</li>\n</ul>\n<h4 id=\"描述\">描述</h4>\n<p>信息时代的来临使得企业营销焦点从产品中心转变成客户中心。具体地，对不同的客户进行分类管理，给予不同类型的客户制定优化的个性化服务方案，采取不同的营销策略。将有限的营销资源集中于高价值的客户，实现企业利润最大化</p>\n<ol type=\"1\">\n<li>借助航空公司数据，对客户进行分类</li>\n<li>对不同类别的客户进行特征分析，比较不同类别客户的价值</li>\n<li>对不同价值的客户类别进行个性化服务，制定相应的营销策略</li>\n</ol>\n<h4 id=\"思路\">思路</h4>\n<figure>\n<img src=\"/.top//01.png\" alt=\"image.png\">\n<figcaption aria-hidden=\"true\">image.png</figcaption>\n</figure>\n<h4 id=\"数据\">数据</h4>\n<h5 id=\"数据集中字段含义\">数据集中字段含义</h5>\n<p><img src=\"/.top//02.png\" alt=\"image.png\"> <img src=\"/.top//03.png\" alt=\"image.png\"></p>\n<h5 id=\"数据预处理\">数据预处理</h5>\n<div class=\"sourceCode\" id=\"cb1\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb1-1\"><a href=\"#cb1-1\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"im\">import</span> pandas <span class=\"im\">as</span> pd</span>\n<span id=\"cb1-2\"><a href=\"#cb1-2\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"im\">import</span> numpy <span class=\"im\">as</span> np</span>\n<span id=\"cb1-3\"><a href=\"#cb1-3\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"im\">import</span> matplotlib.pyplot <span class=\"im\">as</span> plt</span>\n<span id=\"cb1-4\"><a href=\"#cb1-4\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"im\">import</span> datetime</span>\n<span id=\"cb1-5\"><a href=\"#cb1-5\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"im\">import</span> sklearn.preprocessing</span>\n<span id=\"cb1-6\"><a href=\"#cb1-6\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"im\">import</span> sklearn.cluster</span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb2\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb2-1\"><a href=\"#cb2-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>air_data_path <span class=\"op\">=</span> <span class=\"st\">&quot;./dataset/air_data.csv&quot;</span></span>\n<span id=\"cb2-2\"><a href=\"#cb2-2\" aria-hidden=\"true\" tabindex=\"-1\"></a>air_data <span class=\"op\">=</span> pd.read_csv(air_data_path)</span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb3\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb3-1\"><a href=\"#cb3-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>air_data.shape</span></code></pre></div>\n<pre><code>(62988, 44)</code></pre>\n<div class=\"sourceCode\" id=\"cb5\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb5-1\"><a href=\"#cb5-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>air_data.head()</span></code></pre></div>\n<table border=\"1\" class=\"dataframe\">\n<thead>\n<tr style=\"text-align: right;\">\n<th>\n</th>\n<th>\nMEMBER_NO\n</th>\n<th>\nFFP_DATE\n</th>\n<th>\nFIRST_FLIGHT_DATE\n</th>\n<th>\nGENDER\n</th>\n<th>\nFFP_TIER\n</th>\n<th>\nWORK_CITY\n</th>\n<th>\nWORK_PROVINCE\n</th>\n<th>\nWORK_COUNTRY\n</th>\n<th>\nAGE\n</th>\n<th>\nLOAD_TIME\n</th>\n<th>\n...\n</th>\n<th>\nADD_Point_SUM\n</th>\n<th>\nEli_Add_Point_Sum\n</th>\n<th>\nL1Y_ELi_Add_Points\n</th>\n<th>\nPoints_Sum\n</th>\n<th>\nL1Y_Points_Sum\n</th>\n<th>\nRation_L1Y_Flight_Count\n</th>\n<th>\nRation_P1Y_Flight_Count\n</th>\n<th>\nRation_P1Y_BPS\n</th>\n<th>\nRation_L1Y_BPS\n</th>\n<th>\nPoint_NotFlight\n</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<th>\n0\n</th>\n<td>\n54993\n</td>\n<td>\n2006/11/02\n</td>\n<td>\n2008/12/24\n</td>\n<td>\n男\n</td>\n<td>\n6\n</td>\n<td>\n.\n</td>\n<td>\n北京\n</td>\n<td>\nCN\n</td>\n<td>\n31.0\n</td>\n<td>\n2014/03/31\n</td>\n<td>\n...\n</td>\n<td>\n39992\n</td>\n<td>\n114452\n</td>\n<td>\n111100\n</td>\n<td>\n619760\n</td>\n<td>\n370211\n</td>\n<td>\n0.509524\n</td>\n<td>\n0.490476\n</td>\n<td>\n0.487221\n</td>\n<td>\n0.512777\n</td>\n<td>\n50\n</td>\n</tr>\n<tr>\n<th>\n1\n</th>\n<td>\n28065\n</td>\n<td>\n2007/02/19\n</td>\n<td>\n2007/08/03\n</td>\n<td>\n男\n</td>\n<td>\n6\n</td>\n<td>\nNaN\n</td>\n<td>\n北京\n</td>\n<td>\nCN\n</td>\n<td>\n42.0\n</td>\n<td>\n2014/03/31\n</td>\n<td>\n...\n</td>\n<td>\n12000\n</td>\n<td>\n53288\n</td>\n<td>\n53288\n</td>\n<td>\n415768\n</td>\n<td>\n238410\n</td>\n<td>\n0.514286\n</td>\n<td>\n0.485714\n</td>\n<td>\n0.489289\n</td>\n<td>\n0.510708\n</td>\n<td>\n33\n</td>\n</tr>\n<tr>\n<th>\n2\n</th>\n<td>\n55106\n</td>\n<td>\n2007/02/01\n</td>\n<td>\n2007/08/30\n</td>\n<td>\n男\n</td>\n<td>\n6\n</td>\n<td>\n.\n</td>\n<td>\n北京\n</td>\n<td>\nCN\n</td>\n<td>\n40.0\n</td>\n<td>\n2014/03/31\n</td>\n<td>\n...\n</td>\n<td>\n15491\n</td>\n<td>\n55202\n</td>\n<td>\n51711\n</td>\n<td>\n406361\n</td>\n<td>\n233798\n</td>\n<td>\n0.518519\n</td>\n<td>\n0.481481\n</td>\n<td>\n0.481467\n</td>\n<td>\n0.518530\n</td>\n<td>\n26\n</td>\n</tr>\n<tr>\n<th>\n3\n</th>\n<td>\n21189\n</td>\n<td>\n2008/08/22\n</td>\n<td>\n2008/08/23\n</td>\n<td>\n男\n</td>\n<td>\n5\n</td>\n<td>\nLos Angeles\n</td>\n<td>\nCA\n</td>\n<td>\nUS\n</td>\n<td>\n64.0\n</td>\n<td>\n2014/03/31\n</td>\n<td>\n...\n</td>\n<td>\n0\n</td>\n<td>\n34890\n</td>\n<td>\n34890\n</td>\n<td>\n372204\n</td>\n<td>\n186100\n</td>\n<td>\n0.434783\n</td>\n<td>\n0.565217\n</td>\n<td>\n0.551722\n</td>\n<td>\n0.448275\n</td>\n<td>\n12\n</td>\n</tr>\n<tr>\n<th>\n4\n</th>\n<td>\n39546\n</td>\n<td>\n2009/04/10\n</td>\n<td>\n2009/04/15\n</td>\n<td>\n男\n</td>\n<td>\n6\n</td>\n<td>\n贵阳\n</td>\n<td>\n贵州\n</td>\n<td>\nCN\n</td>\n<td>\n48.0\n</td>\n<td>\n2014/03/31\n</td>\n<td>\n...\n</td>\n<td>\n22704\n</td>\n<td>\n64969\n</td>\n<td>\n64969\n</td>\n<td>\n338813\n</td>\n<td>\n210365\n</td>\n<td>\n0.532895\n</td>\n<td>\n0.467105\n</td>\n<td>\n0.469054\n</td>\n<td>\n0.530943\n</td>\n<td>\n39\n</td>\n</tr>\n</tbody>\n</table>\n<p>\n5 rows × 44 columns\n</p>\n<div class=\"sourceCode\" id=\"cb6\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb6-1\"><a href=\"#cb6-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>air_data.dtypes</span></code></pre></div>\n<pre><code>MEMBER_NO                    int64\nFFP_DATE                    object\nFIRST_FLIGHT_DATE           object\nGENDER                      object\nFFP_TIER                     int64\nWORK_CITY                   object\nWORK_PROVINCE               object\nWORK_COUNTRY                object\nAGE                        float64\nLOAD_TIME                   object\nFLIGHT_COUNT                 int64\nBP_SUM                       int64\nEP_SUM_YR_1                  int64\nEP_SUM_YR_2                  int64\nSUM_YR_1                   float64\nSUM_YR_2                   float64\nSEG_KM_SUM                   int64\nWEIGHTED_SEG_KM            float64\nLAST_FLIGHT_DATE            object\nAVG_FLIGHT_COUNT           float64\nAVG_BP_SUM                 float64\nBEGIN_TO_FIRST               int64\nLAST_TO_END                  int64\nAVG_INTERVAL               float64\nMAX_INTERVAL                 int64\nADD_POINTS_SUM_YR_1          int64\nADD_POINTS_SUM_YR_2          int64\nEXCHANGE_COUNT               int64\navg_discount               float64\nP1Y_Flight_Count             int64\nL1Y_Flight_Count             int64\nP1Y_BP_SUM                   int64\nL1Y_BP_SUM                   int64\nEP_SUM                       int64\nADD_Point_SUM                int64\nEli_Add_Point_Sum            int64\nL1Y_ELi_Add_Points           int64\nPoints_Sum                   int64\nL1Y_Points_Sum               int64\nRation_L1Y_Flight_Count    float64\nRation_P1Y_Flight_Count    float64\nRation_P1Y_BPS             float64\nRation_L1Y_BPS             float64\nPoint_NotFlight              int64\ndtype: object</code></pre>\n<div class=\"sourceCode\" id=\"cb8\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb8-1\"><a href=\"#cb8-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>air_data.describe().T</span></code></pre></div>\n<table border=\"1\" class=\"dataframe\">\n<thead>\n<tr style=\"text-align: right;\">\n<th>\n</th>\n<th>\ncount\n</th>\n<th>\nmean\n</th>\n<th>\nstd\n</th>\n<th>\nmin\n</th>\n<th>\n25%\n</th>\n<th>\n50%\n</th>\n<th>\n75%\n</th>\n<th>\nmax\n</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<th>\nMEMBER_NO\n</th>\n<td>\n62988.0\n</td>\n<td>\n31494.500000\n</td>\n<td>\n18183.213715\n</td>\n<td>\n1.00\n</td>\n<td>\n15747.750000\n</td>\n<td>\n31494.500000\n</td>\n<td>\n47241.250000\n</td>\n<td>\n62988.000000\n</td>\n</tr>\n<tr>\n<th>\nFFP_TIER\n</th>\n<td>\n62988.0\n</td>\n<td>\n4.102162\n</td>\n<td>\n0.373856\n</td>\n<td>\n4.00\n</td>\n<td>\n4.000000\n</td>\n<td>\n4.000000\n</td>\n<td>\n4.000000\n</td>\n<td>\n6.000000\n</td>\n</tr>\n<tr>\n<th>\nAGE\n</th>\n<td>\n62568.0\n</td>\n<td>\n42.476346\n</td>\n<td>\n9.885915\n</td>\n<td>\n6.00\n</td>\n<td>\n35.000000\n</td>\n<td>\n41.000000\n</td>\n<td>\n48.000000\n</td>\n<td>\n110.000000\n</td>\n</tr>\n<tr>\n<th>\nFLIGHT_COUNT\n</th>\n<td>\n62988.0\n</td>\n<td>\n11.839414\n</td>\n<td>\n14.049471\n</td>\n<td>\n2.00\n</td>\n<td>\n3.000000\n</td>\n<td>\n7.000000\n</td>\n<td>\n15.000000\n</td>\n<td>\n213.000000\n</td>\n</tr>\n<tr>\n<th>\nBP_SUM\n</th>\n<td>\n62988.0\n</td>\n<td>\n10925.081254\n</td>\n<td>\n16339.486151\n</td>\n<td>\n0.00\n</td>\n<td>\n2518.000000\n</td>\n<td>\n5700.000000\n</td>\n<td>\n12831.000000\n</td>\n<td>\n505308.000000\n</td>\n</tr>\n<tr>\n<th>\nEP_SUM_YR_1\n</th>\n<td>\n62988.0\n</td>\n<td>\n0.000000\n</td>\n<td>\n0.000000\n</td>\n<td>\n0.00\n</td>\n<td>\n0.000000\n</td>\n<td>\n0.000000\n</td>\n<td>\n0.000000\n</td>\n<td>\n0.000000\n</td>\n</tr>\n<tr>\n<th>\nEP_SUM_YR_2\n</th>\n<td>\n62988.0\n</td>\n<td>\n265.689623\n</td>\n<td>\n1645.702854\n</td>\n<td>\n0.00\n</td>\n<td>\n0.000000\n</td>\n<td>\n0.000000\n</td>\n<td>\n0.000000\n</td>\n<td>\n74460.000000\n</td>\n</tr>\n<tr>\n<th>\nSUM_YR_1\n</th>\n<td>\n62437.0\n</td>\n<td>\n5355.376064\n</td>\n<td>\n8109.450147\n</td>\n<td>\n0.00\n</td>\n<td>\n1003.000000\n</td>\n<td>\n2800.000000\n</td>\n<td>\n6574.000000\n</td>\n<td>\n239560.000000\n</td>\n</tr>\n<tr>\n<th>\nSUM_YR_2\n</th>\n<td>\n62850.0\n</td>\n<td>\n5604.026014\n</td>\n<td>\n8703.364247\n</td>\n<td>\n0.00\n</td>\n<td>\n780.000000\n</td>\n<td>\n2773.000000\n</td>\n<td>\n6845.750000\n</td>\n<td>\n234188.000000\n</td>\n</tr>\n<tr>\n<th>\nSEG_KM_SUM\n</th>\n<td>\n62988.0\n</td>\n<td>\n17123.878691\n</td>\n<td>\n20960.844623\n</td>\n<td>\n368.00\n</td>\n<td>\n4747.000000\n</td>\n<td>\n9994.000000\n</td>\n<td>\n21271.250000\n</td>\n<td>\n580717.000000\n</td>\n</tr>\n<tr>\n<th>\nWEIGHTED_SEG_KM\n</th>\n<td>\n62988.0\n</td>\n<td>\n12777.152439\n</td>\n<td>\n17578.586695\n</td>\n<td>\n0.00\n</td>\n<td>\n3219.045000\n</td>\n<td>\n6978.255000\n</td>\n<td>\n15299.632500\n</td>\n<td>\n558440.140000\n</td>\n</tr>\n<tr>\n<th>\nAVG_FLIGHT_COUNT\n</th>\n<td>\n62988.0\n</td>\n<td>\n1.542154\n</td>\n<td>\n1.786996\n</td>\n<td>\n0.25\n</td>\n<td>\n0.428571\n</td>\n<td>\n0.875000\n</td>\n<td>\n1.875000\n</td>\n<td>\n26.625000\n</td>\n</tr>\n<tr>\n<th>\nAVG_BP_SUM\n</th>\n<td>\n62988.0\n</td>\n<td>\n1421.440249\n</td>\n<td>\n2083.121324\n</td>\n<td>\n0.00\n</td>\n<td>\n336.000000\n</td>\n<td>\n752.375000\n</td>\n<td>\n1690.270833\n</td>\n<td>\n63163.500000\n</td>\n</tr>\n<tr>\n<th>\nBEGIN_TO_FIRST\n</th>\n<td>\n62988.0\n</td>\n<td>\n120.145488\n</td>\n<td>\n159.572867\n</td>\n<td>\n0.00\n</td>\n<td>\n9.000000\n</td>\n<td>\n50.000000\n</td>\n<td>\n166.000000\n</td>\n<td>\n729.000000\n</td>\n</tr>\n<tr>\n<th>\nLAST_TO_END\n</th>\n<td>\n62988.0\n</td>\n<td>\n176.120102\n</td>\n<td>\n183.822223\n</td>\n<td>\n1.00\n</td>\n<td>\n29.000000\n</td>\n<td>\n108.000000\n</td>\n<td>\n268.000000\n</td>\n<td>\n731.000000\n</td>\n</tr>\n<tr>\n<th>\nAVG_INTERVAL\n</th>\n<td>\n62988.0\n</td>\n<td>\n67.749788\n</td>\n<td>\n77.517866\n</td>\n<td>\n0.00\n</td>\n<td>\n23.370370\n</td>\n<td>\n44.666667\n</td>\n<td>\n82.000000\n</td>\n<td>\n728.000000\n</td>\n</tr>\n<tr>\n<th>\nMAX_INTERVAL\n</th>\n<td>\n62988.0\n</td>\n<td>\n166.033895\n</td>\n<td>\n123.397180\n</td>\n<td>\n0.00\n</td>\n<td>\n79.000000\n</td>\n<td>\n143.000000\n</td>\n<td>\n228.000000\n</td>\n<td>\n728.000000\n</td>\n</tr>\n<tr>\n<th>\nADD_POINTS_SUM_YR_1\n</th>\n<td>\n62988.0\n</td>\n<td>\n540.316965\n</td>\n<td>\n3956.083455\n</td>\n<td>\n0.00\n</td>\n<td>\n0.000000\n</td>\n<td>\n0.000000\n</td>\n<td>\n0.000000\n</td>\n<td>\n600000.000000\n</td>\n</tr>\n<tr>\n<th>\nADD_POINTS_SUM_YR_2\n</th>\n<td>\n62988.0\n</td>\n<td>\n814.689258\n</td>\n<td>\n5121.796929\n</td>\n<td>\n0.00\n</td>\n<td>\n0.000000\n</td>\n<td>\n0.000000\n</td>\n<td>\n0.000000\n</td>\n<td>\n728282.000000\n</td>\n</tr>\n<tr>\n<th>\nEXCHANGE_COUNT\n</th>\n<td>\n62988.0\n</td>\n<td>\n0.319775\n</td>\n<td>\n1.136004\n</td>\n<td>\n0.00\n</td>\n<td>\n0.000000\n</td>\n<td>\n0.000000\n</td>\n<td>\n0.000000\n</td>\n<td>\n46.000000\n</td>\n</tr>\n<tr>\n<th>\navg_discount\n</th>\n<td>\n62988.0\n</td>\n<td>\n0.721558\n</td>\n<td>\n0.185427\n</td>\n<td>\n0.00\n</td>\n<td>\n0.611997\n</td>\n<td>\n0.711856\n</td>\n<td>\n0.809476\n</td>\n<td>\n1.500000\n</td>\n</tr>\n<tr>\n<th>\nP1Y_Flight_Count\n</th>\n<td>\n62988.0\n</td>\n<td>\n5.766257\n</td>\n<td>\n7.210922\n</td>\n<td>\n0.00\n</td>\n<td>\n2.000000\n</td>\n<td>\n3.000000\n</td>\n<td>\n7.000000\n</td>\n<td>\n118.000000\n</td>\n</tr>\n<tr>\n<th>\nL1Y_Flight_Count\n</th>\n<td>\n62988.0\n</td>\n<td>\n6.073157\n</td>\n<td>\n8.175127\n</td>\n<td>\n0.00\n</td>\n<td>\n1.000000\n</td>\n<td>\n3.000000\n</td>\n<td>\n8.000000\n</td>\n<td>\n111.000000\n</td>\n</tr>\n<tr>\n<th>\nP1Y_BP_SUM\n</th>\n<td>\n62988.0\n</td>\n<td>\n5366.720550\n</td>\n<td>\n8537.773021\n</td>\n<td>\n0.00\n</td>\n<td>\n946.000000\n</td>\n<td>\n2692.000000\n</td>\n<td>\n6485.250000\n</td>\n<td>\n246197.000000\n</td>\n</tr>\n<tr>\n<th>\nL1Y_BP_SUM\n</th>\n<td>\n62988.0\n</td>\n<td>\n5558.360704\n</td>\n<td>\n9351.956952\n</td>\n<td>\n0.00\n</td>\n<td>\n545.000000\n</td>\n<td>\n2547.000000\n</td>\n<td>\n6619.250000\n</td>\n<td>\n259111.000000\n</td>\n</tr>\n<tr>\n<th>\nEP_SUM\n</th>\n<td>\n62988.0\n</td>\n<td>\n265.689623\n</td>\n<td>\n1645.702854\n</td>\n<td>\n0.00\n</td>\n<td>\n0.000000\n</td>\n<td>\n0.000000\n</td>\n<td>\n0.000000\n</td>\n<td>\n74460.000000\n</td>\n</tr>\n<tr>\n<th>\nADD_Point_SUM\n</th>\n<td>\n62988.0\n</td>\n<td>\n1355.006223\n</td>\n<td>\n7868.477000\n</td>\n<td>\n0.00\n</td>\n<td>\n0.000000\n</td>\n<td>\n0.000000\n</td>\n<td>\n0.000000\n</td>\n<td>\n984938.000000\n</td>\n</tr>\n<tr>\n<th>\nEli_Add_Point_Sum\n</th>\n<td>\n62988.0\n</td>\n<td>\n1620.695847\n</td>\n<td>\n8294.398955\n</td>\n<td>\n0.00\n</td>\n<td>\n0.000000\n</td>\n<td>\n0.000000\n</td>\n<td>\n345.000000\n</td>\n<td>\n984938.000000\n</td>\n</tr>\n<tr>\n<th>\nL1Y_ELi_Add_Points\n</th>\n<td>\n62988.0\n</td>\n<td>\n1080.378882\n</td>\n<td>\n5639.857254\n</td>\n<td>\n0.00\n</td>\n<td>\n0.000000\n</td>\n<td>\n0.000000\n</td>\n<td>\n0.000000\n</td>\n<td>\n728282.000000\n</td>\n</tr>\n<tr>\n<th>\nPoints_Sum\n</th>\n<td>\n62988.0\n</td>\n<td>\n12545.777100\n</td>\n<td>\n20507.816700\n</td>\n<td>\n0.00\n</td>\n<td>\n2775.000000\n</td>\n<td>\n6328.500000\n</td>\n<td>\n14302.500000\n</td>\n<td>\n985572.000000\n</td>\n</tr>\n<tr>\n<th>\nL1Y_Points_Sum\n</th>\n<td>\n62988.0\n</td>\n<td>\n6638.739585\n</td>\n<td>\n12601.819863\n</td>\n<td>\n0.00\n</td>\n<td>\n700.000000\n</td>\n<td>\n2860.500000\n</td>\n<td>\n7500.000000\n</td>\n<td>\n728282.000000\n</td>\n</tr>\n<tr>\n<th>\nRation_L1Y_Flight_Count\n</th>\n<td>\n62988.0\n</td>\n<td>\n0.486419\n</td>\n<td>\n0.319105\n</td>\n<td>\n0.00\n</td>\n<td>\n0.250000\n</td>\n<td>\n0.500000\n</td>\n<td>\n0.711111\n</td>\n<td>\n1.000000\n</td>\n</tr>\n<tr>\n<th>\nRation_P1Y_Flight_Count\n</th>\n<td>\n62988.0\n</td>\n<td>\n0.513581\n</td>\n<td>\n0.319105\n</td>\n<td>\n0.00\n</td>\n<td>\n0.288889\n</td>\n<td>\n0.500000\n</td>\n<td>\n0.750000\n</td>\n<td>\n1.000000\n</td>\n</tr>\n<tr>\n<th>\nRation_P1Y_BPS\n</th>\n<td>\n62988.0\n</td>\n<td>\n0.522293\n</td>\n<td>\n0.339632\n</td>\n<td>\n0.00\n</td>\n<td>\n0.258150\n</td>\n<td>\n0.514252\n</td>\n<td>\n0.815091\n</td>\n<td>\n0.999989\n</td>\n</tr>\n<tr>\n<th>\nRation_L1Y_BPS\n</th>\n<td>\n62988.0\n</td>\n<td>\n0.468422\n</td>\n<td>\n0.338956\n</td>\n<td>\n0.00\n</td>\n<td>\n0.167954\n</td>\n<td>\n0.476747\n</td>\n<td>\n0.728375\n</td>\n<td>\n0.999993\n</td>\n</tr>\n<tr>\n<th>\nPoint_NotFlight\n</th>\n<td>\n62988.0\n</td>\n<td>\n2.728155\n</td>\n<td>\n7.364164\n</td>\n<td>\n0.00\n</td>\n<td>\n0.000000\n</td>\n<td>\n0.000000\n</td>\n<td>\n1.000000\n</td>\n<td>\n140.000000\n</td>\n</tr>\n</tbody>\n</table>\n<h5 id=\"判断重复值是否有重复的会员id\">判断重复值：是否有重复的会员ID</h5>\n<div class=\"sourceCode\" id=\"cb9\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb9-1\"><a href=\"#cb9-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>air_data[<span class=\"st\">&#39;MEMBER_NO&#39;</span>].duplicated()</span></code></pre></div>\n<pre><code>0        False\n1        False\n2        False\n3        False\n4        False\n         ...  \n62983    False\n62984    False\n62985    False\n62986    False\n62987    False\nName: MEMBER_NO, Length: 62988, dtype: bool</code></pre>\n<div class=\"sourceCode\" id=\"cb11\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb11-1\"><a href=\"#cb11-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>air_data[air_data[<span class=\"st\">&#39;MEMBER_NO&#39;</span>].duplicated()]</span></code></pre></div>\n<table border=\"1\" class=\"dataframe\">\n<thead>\n<tr style=\"text-align: right;\">\n<th>\n</th>\n<th>\nMEMBER_NO\n</th>\n<th>\nFFP_DATE\n</th>\n<th>\nFIRST_FLIGHT_DATE\n</th>\n<th>\nGENDER\n</th>\n<th>\nFFP_TIER\n</th>\n<th>\nWORK_CITY\n</th>\n<th>\nWORK_PROVINCE\n</th>\n<th>\nWORK_COUNTRY\n</th>\n<th>\nAGE\n</th>\n<th>\nLOAD_TIME\n</th>\n<th>\n...\n</th>\n<th>\nADD_Point_SUM\n</th>\n<th>\nEli_Add_Point_Sum\n</th>\n<th>\nL1Y_ELi_Add_Points\n</th>\n<th>\nPoints_Sum\n</th>\n<th>\nL1Y_Points_Sum\n</th>\n<th>\nRation_L1Y_Flight_Count\n</th>\n<th>\nRation_P1Y_Flight_Count\n</th>\n<th>\nRation_P1Y_BPS\n</th>\n<th>\nRation_L1Y_BPS\n</th>\n<th>\nPoint_NotFlight\n</th>\n</tr>\n</thead>\n<tbody>\n</tbody>\n</table>\n<p>\n0 rows × 44 columns\n</p>\n<div class=\"sourceCode\" id=\"cb12\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb12-1\"><a href=\"#cb12-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>air_data.isna().<span class=\"bu\">any</span>()</span></code></pre></div>\n<pre><code>MEMBER_NO                  False\nFFP_DATE                   False\nFIRST_FLIGHT_DATE          False\nGENDER                      True\nFFP_TIER                   False\nWORK_CITY                   True\nWORK_PROVINCE               True\nWORK_COUNTRY                True\nAGE                         True\nLOAD_TIME                  False\nFLIGHT_COUNT               False\nBP_SUM                     False\nEP_SUM_YR_1                False\nEP_SUM_YR_2                False\nSUM_YR_1                    True\nSUM_YR_2                    True\nSEG_KM_SUM                 False\nWEIGHTED_SEG_KM            False\nLAST_FLIGHT_DATE           False\nAVG_FLIGHT_COUNT           False\nAVG_BP_SUM                 False\nBEGIN_TO_FIRST             False\nLAST_TO_END                False\nAVG_INTERVAL               False\nMAX_INTERVAL               False\nADD_POINTS_SUM_YR_1        False\nADD_POINTS_SUM_YR_2        False\nEXCHANGE_COUNT             False\navg_discount               False\nP1Y_Flight_Count           False\nL1Y_Flight_Count           False\nP1Y_BP_SUM                 False\nL1Y_BP_SUM                 False\nEP_SUM                     False\nADD_Point_SUM              False\nEli_Add_Point_Sum          False\nL1Y_ELi_Add_Points         False\nPoints_Sum                 False\nL1Y_Points_Sum             False\nRation_L1Y_Flight_Count    False\nRation_P1Y_Flight_Count    False\nRation_P1Y_BPS             False\nRation_L1Y_BPS             False\nPoint_NotFlight            False\ndtype: bool</code></pre>\n<div class=\"sourceCode\" id=\"cb14\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb14-1\"><a href=\"#cb14-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>air_data.isnull().<span class=\"bu\">any</span>()</span></code></pre></div>\n<pre><code>MEMBER_NO                  False\nFFP_DATE                   False\nFIRST_FLIGHT_DATE          False\nGENDER                      True\nFFP_TIER                   False\nWORK_CITY                   True\nWORK_PROVINCE               True\nWORK_COUNTRY                True\nAGE                         True\nLOAD_TIME                  False\nFLIGHT_COUNT               False\nBP_SUM                     False\nEP_SUM_YR_1                False\nEP_SUM_YR_2                False\nSUM_YR_1                    True\nSUM_YR_2                    True\nSEG_KM_SUM                 False\nWEIGHTED_SEG_KM            False\nLAST_FLIGHT_DATE           False\nAVG_FLIGHT_COUNT           False\nAVG_BP_SUM                 False\nBEGIN_TO_FIRST             False\nLAST_TO_END                False\nAVG_INTERVAL               False\nMAX_INTERVAL               False\nADD_POINTS_SUM_YR_1        False\nADD_POINTS_SUM_YR_2        False\nEXCHANGE_COUNT             False\navg_discount               False\nP1Y_Flight_Count           False\nL1Y_Flight_Count           False\nP1Y_BP_SUM                 False\nL1Y_BP_SUM                 False\nEP_SUM                     False\nADD_Point_SUM              False\nEli_Add_Point_Sum          False\nL1Y_ELi_Add_Points         False\nPoints_Sum                 False\nL1Y_Points_Sum             False\nRation_L1Y_Flight_Count    False\nRation_P1Y_Flight_Count    False\nRation_P1Y_BPS             False\nRation_L1Y_BPS             False\nPoint_NotFlight            False\ndtype: bool</code></pre>\n<div class=\"sourceCode\" id=\"cb16\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb16-1\"><a href=\"#cb16-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>boolean_filter <span class=\"op\">=</span> air_data[<span class=\"st\">&#39;SUM_YR_1&#39;</span>].notnull() <span class=\"op\">&amp;</span> air_data[<span class=\"st\">&#39;SUM_YR_2&#39;</span>].notnull()</span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb17\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb17-1\"><a href=\"#cb17-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>boolean_filter</span></code></pre></div>\n<pre><code>0         True1         True2         True3         True4         True         ...  62983     True62984     True62985     True62986     True62987    FalseLength: 62988, dtype: bool</code></pre>\n<div class=\"sourceCode\" id=\"cb19\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb19-1\"><a href=\"#cb19-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>air_data <span class=\"op\">=</span> air_data[boolean_filter]</span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb20\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb20-1\"><a href=\"#cb20-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>filter1 <span class=\"op\">=</span> air_data[<span class=\"st\">&#39;SUM_YR_1&#39;</span>] <span class=\"op\">!=</span> <span class=\"dv\">0</span><span class=\"er\">filter2</span> <span class=\"op\">=</span> air_data[<span class=\"st\">&#39;SUM_YR_2&#39;</span>] <span class=\"op\">!=</span> <span class=\"dv\">0</span></span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb21\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb21-1\"><a href=\"#cb21-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>air_data <span class=\"op\">=</span> air_data[filter1 <span class=\"op\">|</span> filter2]</span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb22\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb22-1\"><a href=\"#cb22-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>air_data.shape</span></code></pre></div>\n<pre><code>(62044, 44)</code></pre>\n<h4 id=\"特征工程\">特征工程</h4>\n<h5 id=\"rfm模型\">RFM模型</h5>\n<p>对于客户价值分析的一个经典模型是 RFM 模型。</p>\n<ul>\n<li>Recency: 最近消费时间间隔。</li>\n<li>Frequency: 客户消费频率。</li>\n<li>Monetary Value: 客户总消费金额。</li>\n</ul>\n<h5 id=\"变体---lrfmc-模型\">变体 - LRFMC 模型</h5>\n<ul>\n<li>Length of Relationship: 客户关系时长，反映可能的活跃时长。</li>\n<li>Recency: 最近消费时间间隔，反映当前的活跃状态。</li>\n<li>Frequency: 客户消费频率，反映客户的忠诚度。</li>\n<li>Mileage: 客户总飞行里程，反映客户对乘机的依赖性。</li>\n<li>Coefficient of Discount:\n客户所享受的平均折扣率，侧面反映客户价值高低。</li>\n</ul>\n<div class=\"sourceCode\" id=\"cb24\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb24-1\"><a href=\"#cb24-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>load_time <span class=\"op\">=</span> datetime.datetime.strptime(<span class=\"st\">&#39;2014/03/31&#39;</span>,<span class=\"st\">&#39;%Y/%m/</span><span class=\"sc\">%d</span><span class=\"st\">&#39;</span>)</span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb25\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb25-1\"><a href=\"#cb25-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>load_time</span></code></pre></div>\n<pre><code>datetime.datetime(2014, 3, 31, 0, 0)</code></pre>\n<div class=\"sourceCode\" id=\"cb27\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb27-1\"><a href=\"#cb27-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>ffp_dates <span class=\"op\">=</span> [datetime.datetime.strptime(ffp_date,<span class=\"st\">&#39;%Y/%m/</span><span class=\"sc\">%d</span><span class=\"st\">&#39;</span>) <span class=\"cf\">for</span> ffp_date <span class=\"kw\">in</span> air_data[<span class=\"st\">&#39;FFP_DATE&#39;</span>]]</span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb28\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb28-1\"><a href=\"#cb28-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>length_of_relationship  <span class=\"op\">=</span> [(load_time<span class=\"op\">-</span>ffp_date).days <span class=\"cf\">for</span> ffp_date <span class=\"kw\">in</span> ffp_dates]</span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb29\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb29-1\"><a href=\"#cb29-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>air_data[<span class=\"st\">&#39;LEN_REL&#39;</span>] <span class=\"op\">=</span> length_of_relationship</span></code></pre></div>\n<h5 id=\"移除非重要列-只保留lrfmc模型所需的属性\">移除非重要列，\n只保留LRFMC模型所需的属性</h5>\n<div class=\"sourceCode\" id=\"cb30\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb30-1\"><a href=\"#cb30-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>features <span class=\"op\">=</span> [<span class=\"st\">&#39;LEN_REL&#39;</span>,<span class=\"st\">&#39;FLIGHT_COUNT&#39;</span>,<span class=\"st\">&#39;avg_discount&#39;</span>,<span class=\"st\">&#39;SEG_KM_SUM&#39;</span>,<span class=\"st\">&#39;LAST_TO_END&#39;</span>]</span>\n<span id=\"cb30-2\"><a href=\"#cb30-2\" aria-hidden=\"true\" tabindex=\"-1\"></a>data <span class=\"op\">=</span> air_data[features]</span>\n<span id=\"cb30-3\"><a href=\"#cb30-3\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb30-4\"><a href=\"#cb30-4\" aria-hidden=\"true\" tabindex=\"-1\"></a>features <span class=\"op\">=</span> [<span class=\"st\">&#39;L&#39;</span>,<span class=\"st\">&#39;F&#39;</span>,<span class=\"st\">&#39;C&#39;</span>,<span class=\"st\">&#39;M&#39;</span>,<span class=\"st\">&#39;R&#39;</span>]</span>\n<span id=\"cb30-5\"><a href=\"#cb30-5\" aria-hidden=\"true\" tabindex=\"-1\"></a>data.columns <span class=\"op\">=</span> features</span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb31\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb31-1\"><a href=\"#cb31-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>data.shape</span></code></pre></div>\n<pre><code>(62044, 5)</code></pre>\n<div class=\"sourceCode\" id=\"cb33\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb33-1\"><a href=\"#cb33-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>data.head()</span></code></pre></div>\n<table border=\"1\" class=\"dataframe\">\n<thead>\n<tr style=\"text-align: right;\">\n<th>\n</th>\n<th>\nL\n</th>\n<th>\nF\n</th>\n<th>\nC\n</th>\n<th>\nM\n</th>\n<th>\nR\n</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<th>\n0\n</th>\n<td>\n2706\n</td>\n<td>\n210\n</td>\n<td>\n0.961639\n</td>\n<td>\n580717\n</td>\n<td>\n1\n</td>\n</tr>\n<tr>\n<th>\n1\n</th>\n<td>\n2597\n</td>\n<td>\n140\n</td>\n<td>\n1.252314\n</td>\n<td>\n293678\n</td>\n<td>\n7\n</td>\n</tr>\n<tr>\n<th>\n2\n</th>\n<td>\n2615\n</td>\n<td>\n135\n</td>\n<td>\n1.254676\n</td>\n<td>\n283712\n</td>\n<td>\n11\n</td>\n</tr>\n<tr>\n<th>\n3\n</th>\n<td>\n2047\n</td>\n<td>\n23\n</td>\n<td>\n1.090870\n</td>\n<td>\n281336\n</td>\n<td>\n97\n</td>\n</tr>\n<tr>\n<th>\n4\n</th>\n<td>\n1816\n</td>\n<td>\n152\n</td>\n<td>\n0.970658\n</td>\n<td>\n309928\n</td>\n<td>\n5\n</td>\n</tr>\n</tbody>\n</table>\n<div class=\"sourceCode\" id=\"cb34\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb34-1\"><a href=\"#cb34-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>data.describe().T</span></code></pre></div>\n<table border=\"1\" class=\"dataframe\">\n<thead>\n<tr style=\"text-align: right;\">\n<th>\n</th>\n<th>\ncount\n</th>\n<th>\nmean\n</th>\n<th>\nstd\n</th>\n<th>\nmin\n</th>\n<th>\n25%\n</th>\n<th>\n50%\n</th>\n<th>\n75%\n</th>\n<th>\nmax\n</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<th>\nL\n</th>\n<td>\n62044.0\n</td>\n<td>\n1488.691090\n</td>\n<td>\n847.880920\n</td>\n<td>\n365.000000\n</td>\n<td>\n735.000000\n</td>\n<td>\n1278.000000\n</td>\n<td>\n2182.000000\n</td>\n<td>\n3437.0\n</td>\n</tr>\n<tr>\n<th>\nF\n</th>\n<td>\n62044.0\n</td>\n<td>\n11.971359\n</td>\n<td>\n14.110619\n</td>\n<td>\n2.000000\n</td>\n<td>\n3.000000\n</td>\n<td>\n7.000000\n</td>\n<td>\n15.000000\n</td>\n<td>\n213.0\n</td>\n</tr>\n<tr>\n<th>\nC\n</th>\n<td>\n62044.0\n</td>\n<td>\n0.722180\n</td>\n<td>\n0.184833\n</td>\n<td>\n0.136017\n</td>\n<td>\n0.613085\n</td>\n<td>\n0.712162\n</td>\n<td>\n0.809293\n</td>\n<td>\n1.5\n</td>\n</tr>\n<tr>\n<th>\nM\n</th>\n<td>\n62044.0\n</td>\n<td>\n17321.694749\n</td>\n<td>\n21052.728111\n</td>\n<td>\n368.000000\n</td>\n<td>\n4874.000000\n</td>\n<td>\n10200.000000\n</td>\n<td>\n21522.500000\n</td>\n<td>\n580717.0\n</td>\n</tr>\n<tr>\n<th>\nR\n</th>\n<td>\n62044.0\n</td>\n<td>\n172.532703\n</td>\n<td>\n181.526164\n</td>\n<td>\n1.000000\n</td>\n<td>\n29.000000\n</td>\n<td>\n105.000000\n</td>\n<td>\n260.000000\n</td>\n<td>\n731.0\n</td>\n</tr>\n</tbody>\n</table>\n\n<h3 id=\"标准化\">标准化</h3>\n<p>让不同属性的取值范围一致，即数据的标准化。标准化方法有极大极小标准化、标准差标准化等方法。</p>\n<ul>\n<li>对特征标准化，使得各特征的均值为0、方差为1</li>\n</ul>\n<div class=\"sourceCode\" id=\"cb35\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb35-1\"><a href=\"#cb35-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>((data <span class=\"op\">-</span>data.mean(axis<span class=\"op\">=</span><span class=\"dv\">0</span>)) <span class=\"op\">/</span>data.std(axis<span class=\"op\">=</span><span class=\"dv\">0</span>)).describe().T</span></code></pre></div>\n<table border=\"1\" class=\"dataframe\">\n<thead>\n<tr style=\"text-align: right;\">\n<th>\n</th>\n<th>\ncount\n</th>\n<th>\nmean\n</th>\n<th>\nstd\n</th>\n<th>\nmin\n</th>\n<th>\n25%\n</th>\n<th>\n50%\n</th>\n<th>\n75%\n</th>\n<th>\nmax\n</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<th>\nL\n</th>\n<td>\n62044.0\n</td>\n<td>\n1.117739e-16\n</td>\n<td>\n1.0\n</td>\n<td>\n-1.325294\n</td>\n<td>\n-0.888911\n</td>\n<td>\n-0.248491\n</td>\n<td>\n0.817696\n</td>\n<td>\n2.297857\n</td>\n</tr>\n<tr>\n<th>\nF\n</th>\n<td>\n62044.0\n</td>\n<td>\n3.664717e-17\n</td>\n<td>\n1.0\n</td>\n<td>\n-0.706656\n</td>\n<td>\n-0.635788\n</td>\n<td>\n-0.352313\n</td>\n<td>\n0.214636\n</td>\n<td>\n14.246621\n</td>\n</tr>\n<tr>\n<th>\nC\n</th>\n<td>\n62044.0\n</td>\n<td>\n4.251071e-16\n</td>\n<td>\n1.0\n</td>\n<td>\n-3.171310\n</td>\n<td>\n-0.590233\n</td>\n<td>\n-0.054199\n</td>\n<td>\n0.471304\n</td>\n<td>\n4.208225\n</td>\n</tr>\n<tr>\n<th>\nM\n</th>\n<td>\n62044.0\n</td>\n<td>\n-5.863547e-17\n</td>\n<td>\n1.0\n</td>\n<td>\n-0.805297\n</td>\n<td>\n-0.591263\n</td>\n<td>\n-0.338279\n</td>\n<td>\n0.199537\n</td>\n<td>\n26.761154\n</td>\n</tr>\n<tr>\n<th>\nR\n</th>\n<td>\n62044.0\n</td>\n<td>\n1.465887e-16\n</td>\n<td>\n1.0\n</td>\n<td>\n-0.944948\n</td>\n<td>\n-0.790700\n</td>\n<td>\n-0.372027\n</td>\n<td>\n0.481844\n</td>\n<td>\n3.076511\n</td>\n</tr>\n</tbody>\n</table>\n<div class=\"sourceCode\" id=\"cb36\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb36-1\"><a href=\"#cb36-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>ss <span class=\"op\">=</span> sklearn.preprocessing.StandardScaler(with_mean<span class=\"op\">=</span><span class=\"va\">True</span>,with_std<span class=\"op\">=</span><span class=\"va\">True</span>)</span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb37\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb37-1\"><a href=\"#cb37-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>data <span class=\"op\">=</span> ss.fit_transform(data)</span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb38\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb38-1\"><a href=\"#cb38-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>data</span></code></pre></div>\n<pre><code>array([[ 1.43571897, 14.03412875,  1.29555058, 26.76136996, -0.94495516],       [ 1.30716214,  9.07328567,  2.86819902, 13.1269701 , -0.9119018 ],       [ 1.32839171,  8.71893974,  2.88097321, 12.65358345, -0.88986623],       ...,       [-0.14942206, -0.70666211, -2.68990622, -0.77233818, -0.73561725],       [-1.20618274, -0.70666211, -2.55464809, -0.77984321,  1.6056619 ],       [-0.47965977, -0.70666211, -2.39233833, -0.78668323,  0.60304353]])</code></pre>\n<div class=\"sourceCode\" id=\"cb40\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb40-1\"><a href=\"#cb40-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>data <span class=\"op\">=</span> pd.DataFrame(data,columns<span class=\"op\">=</span>features)</span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb41\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb41-1\"><a href=\"#cb41-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>data.head()</span></code></pre></div>\n<table border=\"1\" class=\"dataframe\">\n<thead>\n<tr style=\"text-align: right;\">\n<th>\n</th>\n<th>\nL\n</th>\n<th>\nF\n</th>\n<th>\nC\n</th>\n<th>\nM\n</th>\n<th>\nR\n</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<th>\n0\n</th>\n<td>\n1.435719\n</td>\n<td>\n14.034129\n</td>\n<td>\n1.295551\n</td>\n<td>\n26.761370\n</td>\n<td>\n-0.944955\n</td>\n</tr>\n<tr>\n<th>\n1\n</th>\n<td>\n1.307162\n</td>\n<td>\n9.073286\n</td>\n<td>\n2.868199\n</td>\n<td>\n13.126970\n</td>\n<td>\n-0.911902\n</td>\n</tr>\n<tr>\n<th>\n2\n</th>\n<td>\n1.328392\n</td>\n<td>\n8.718940\n</td>\n<td>\n2.880973\n</td>\n<td>\n12.653583\n</td>\n<td>\n-0.889866\n</td>\n</tr>\n<tr>\n<th>\n3\n</th>\n<td>\n0.658481\n</td>\n<td>\n0.781591\n</td>\n<td>\n1.994730\n</td>\n<td>\n12.540723\n</td>\n<td>\n-0.416102\n</td>\n</tr>\n<tr>\n<th>\n4\n</th>\n<td>\n0.386035\n</td>\n<td>\n9.923716\n</td>\n<td>\n1.344346\n</td>\n<td>\n13.898848\n</td>\n<td>\n-0.922920\n</td>\n</tr>\n</tbody>\n</table>\n<div class=\"sourceCode\" id=\"cb42\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb42-1\"><a href=\"#cb42-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>data_db <span class=\"op\">=</span> data.copy()</span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb43\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb43-1\"><a href=\"#cb43-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>data_db.describe().T</span></code></pre></div>\n<table border=\"1\" class=\"dataframe\">\n<thead>\n<tr style=\"text-align: right;\">\n<th>\n</th>\n<th>\ncount\n</th>\n<th>\nmean\n</th>\n<th>\nstd\n</th>\n<th>\nmin\n</th>\n<th>\n25%\n</th>\n<th>\n50%\n</th>\n<th>\n75%\n</th>\n<th>\nmax\n</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<th>\nL\n</th>\n<td>\n62044.0\n</td>\n<td>\n1.246004e-16\n</td>\n<td>\n1.000008\n</td>\n<td>\n-1.325304\n</td>\n<td>\n-0.888919\n</td>\n<td>\n-0.248493\n</td>\n<td>\n0.817703\n</td>\n<td>\n2.297875\n</td>\n</tr>\n<tr>\n<th>\nF\n</th>\n<td>\n62044.0\n</td>\n<td>\n5.863547e-17\n</td>\n<td>\n1.000008\n</td>\n<td>\n-0.706662\n</td>\n<td>\n-0.635793\n</td>\n<td>\n-0.352316\n</td>\n<td>\n0.214637\n</td>\n<td>\n14.246736\n</td>\n</tr>\n<tr>\n<th>\nC\n</th>\n<td>\n62044.0\n</td>\n<td>\n3.957894e-16\n</td>\n<td>\n1.000008\n</td>\n<td>\n-3.171335\n</td>\n<td>\n-0.590238\n</td>\n<td>\n-0.054200\n</td>\n<td>\n0.471308\n</td>\n<td>\n4.208258\n</td>\n</tr>\n<tr>\n<th>\nM\n</th>\n<td>\n62044.0\n</td>\n<td>\n-1.026121e-16\n</td>\n<td>\n1.000008\n</td>\n<td>\n-0.805303\n</td>\n<td>\n-0.591268\n</td>\n<td>\n-0.338282\n</td>\n<td>\n0.199539\n</td>\n<td>\n26.761370\n</td>\n</tr>\n<tr>\n<th>\nR\n</th>\n<td>\n62044.0\n</td>\n<td>\n4.397660e-17\n</td>\n<td>\n1.000008\n</td>\n<td>\n-0.944955\n</td>\n<td>\n-0.790706\n</td>\n<td>\n-0.372030\n</td>\n<td>\n0.481848\n</td>\n<td>\n3.076536\n</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"模型训练与-数据的预测\">模型训练与 数据的预测</h3>\n<p>将客户群体细分为重要保持客户、重要发展客户、重要挽留客户、一般客户、低价值客户五类</p>\n<h4 id=\"k-means聚类算法\">K-means聚类算法</h4>\n<ul>\n<li>目标是把 <span class=\"math inline\">\\(n\\)</span> 个观测样本划分成\n<span class=\"math inline\">\\(k\\)</span>\n个群体（cluster），每个群体都有一个中心（mean）。</li>\n<li>每个样本仅属于其中一个群体，即与这个样本距离最近的中心的群体。</li>\n<li>符号: <span class=\"math inline\">\\(S_{i}\\)</span> 是一个群体, <span class=\"math inline\">\\(m_{i}\\)</span> 是群体 <span class=\"math inline\">\\(S_{i}\\)</span> 里的样本的中心, <span class=\"math inline\">\\(x_{i}\\)</span> 是一个样本点。</li>\n<li>Assignment step (expectation step):\n把每个样本分配给距离最近的中心的群体</li>\n<li>Update step (maximization step):\n根据当前的样本及其所属群体，重新计算各群体的中心</li>\n</ul>\n<div class=\"sourceCode\" id=\"cb44\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb44-1\"><a href=\"#cb44-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>num_clusters <span class=\"op\">=</span> <span class=\"dv\">5</span>  <span class=\"co\"># 设置类别为5</span></span>\n<span id=\"cb44-2\"><a href=\"#cb44-2\" aria-hidden=\"true\" tabindex=\"-1\"></a>km <span class=\"op\">=</span> sklearn.cluster.KMeans(n_clusters<span class=\"op\">=</span>num_clusters, n_jobs<span class=\"op\">=</span><span class=\"dv\">4</span>)  <span class=\"co\">#模型加载</span></span>\n<span id=\"cb44-3\"><a href=\"#cb44-3\" aria-hidden=\"true\" tabindex=\"-1\"></a>km.fit(data) <span class=\"co\"># 模型训练</span></span></code></pre></div>\n<pre><code>/Users/gaozhiyong/Documents/pyenv/pyenv3.6/lib/python3.6/site-packages/sklearn/cluster/_kmeans.py:793: FutureWarning: &#39;n_jobs&#39; was deprecated in version 0.23 and will be removed in 1.0 (renaming of 0.25).\n  &quot; removed in 1.0 (renaming of 0.25).&quot;, FutureWarning)\n\nKMeans(n_clusters=5, n_jobs=4)</code></pre>\n<div class=\"sourceCode\" id=\"cb46\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb46-1\"><a href=\"#cb46-1\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"co\"># 查看模型学习出来的5个群体的中心， 以及5哥群体所包含的样本个数</span></span>\n<span id=\"cb46-2\"><a href=\"#cb46-2\" aria-hidden=\"true\" tabindex=\"-1\"></a>r1 <span class=\"op\">=</span> pd.Series(km.labels_).value_counts()</span>\n<span id=\"cb46-3\"><a href=\"#cb46-3\" aria-hidden=\"true\" tabindex=\"-1\"></a>r2 <span class=\"op\">=</span> pd.DataFrame(km.cluster_centers_)</span>\n<span id=\"cb46-4\"><a href=\"#cb46-4\" aria-hidden=\"true\" tabindex=\"-1\"></a>r <span class=\"op\">=</span> pd.concat([r2,r1],axis<span class=\"op\">=</span><span class=\"dv\">1</span>)</span>\n<span id=\"cb46-5\"><a href=\"#cb46-5\" aria-hidden=\"true\" tabindex=\"-1\"></a>r.columns <span class=\"op\">=</span> <span class=\"bu\">list</span>(data.columns) <span class=\"op\">+</span> [<span class=\"st\">&#39;counts&#39;</span>]</span>\n<span id=\"cb46-6\"><a href=\"#cb46-6\" aria-hidden=\"true\" tabindex=\"-1\"></a>r</span></code></pre></div>\n<table border=\"1\" class=\"dataframe\">\n<thead>\n<tr style=\"text-align: right;\">\n<th>\n</th>\n<th>\nL\n</th>\n<th>\nF\n</th>\n<th>\nC\n</th>\n<th>\nM\n</th>\n<th>\nR\n</th>\n<th>\ncounts\n</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<th>\n0\n</th>\n<td>\n0.482004\n</td>\n<td>\n2.478716\n</td>\n<td>\n0.298630\n</td>\n<td>\n2.420403\n</td>\n<td>\n-0.798959\n</td>\n<td>\n5338\n</td>\n</tr>\n<tr>\n<th>\n1\n</th>\n<td>\n1.155203\n</td>\n<td>\n-0.091881\n</td>\n<td>\n-0.150515\n</td>\n<td>\n-0.099938\n</td>\n<td>\n-0.373781\n</td>\n<td>\n15858\n</td>\n</tr>\n<tr>\n<th>\n2\n</th>\n<td>\n0.110721\n</td>\n<td>\n-0.189617\n</td>\n<td>\n2.353276\n</td>\n<td>\n-0.185116\n</td>\n<td>\n-0.015167\n</td>\n<td>\n3684\n</td>\n</tr>\n<tr>\n<th>\n3\n</th>\n<td>\n-0.700396\n</td>\n<td>\n-0.164828\n</td>\n<td>\n-0.234397\n</td>\n<td>\n-0.165888\n</td>\n<td>\n-0.410842\n</td>\n<td>\n24970\n</td>\n</tr>\n<tr>\n<th>\n4\n</th>\n<td>\n-0.315083\n</td>\n<td>\n-0.574115\n</td>\n<td>\n-0.162570\n</td>\n<td>\n-0.537185\n</td>\n<td>\n1.684579\n</td>\n<td>\n12194\n</td>\n</tr>\n</tbody>\n</table>\n<div class=\"sourceCode\" id=\"cb47\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb47-1\"><a href=\"#cb47-1\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"co\"># 查看模型对每个样本预测的群体标签</span></span>\n<span id=\"cb47-2\"><a href=\"#cb47-2\" aria-hidden=\"true\" tabindex=\"-1\"></a>km.labels_</span></code></pre></div>\n<pre><code>array([0, 0, 0, ..., 3, 4, 4], dtype=int32)</code></pre>\n<h4 id=\"尝试使用rfm模型\">尝试使用RFM模型</h4>\n<div class=\"sourceCode\" id=\"cb49\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb49-1\"><a href=\"#cb49-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>data_rfm <span class=\"op\">=</span> data[[<span class=\"st\">&#39;R&#39;</span>,<span class=\"st\">&#39;F&#39;</span>,<span class=\"st\">&#39;M&#39;</span>]]</span>\n<span id=\"cb49-2\"><a href=\"#cb49-2\" aria-hidden=\"true\" tabindex=\"-1\"></a>data_rfm.head()</span></code></pre></div>\n<table border=\"1\" class=\"dataframe\">\n<thead>\n<tr style=\"text-align: right;\">\n<th>\n</th>\n<th>\nR\n</th>\n<th>\nF\n</th>\n<th>\nM\n</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<th>\n0\n</th>\n<td>\n-0.944955\n</td>\n<td>\n14.034129\n</td>\n<td>\n26.761370\n</td>\n</tr>\n<tr>\n<th>\n1\n</th>\n<td>\n-0.911902\n</td>\n<td>\n9.073286\n</td>\n<td>\n13.126970\n</td>\n</tr>\n<tr>\n<th>\n2\n</th>\n<td>\n-0.889866\n</td>\n<td>\n8.718940\n</td>\n<td>\n12.653583\n</td>\n</tr>\n<tr>\n<th>\n3\n</th>\n<td>\n-0.416102\n</td>\n<td>\n0.781591\n</td>\n<td>\n12.540723\n</td>\n</tr>\n<tr>\n<th>\n4\n</th>\n<td>\n-0.922920\n</td>\n<td>\n9.923716\n</td>\n<td>\n13.898848\n</td>\n</tr>\n</tbody>\n</table>\n<div class=\"sourceCode\" id=\"cb50\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb50-1\"><a href=\"#cb50-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>km.fit(data_rfm) <span class=\"co\"># 模型对 只包含rfm数据集训练</span></span></code></pre></div>\n<pre><code>/Users/gaozhiyong/Documents/pyenv/pyenv3.6/lib/python3.6/site-packages/sklearn/cluster/_kmeans.py:793: FutureWarning: &#39;n_jobs&#39; was deprecated in version 0.23 and will be removed in 1.0 (renaming of 0.25).\n  &quot; removed in 1.0 (renaming of 0.25).&quot;, FutureWarning)\n\nKMeans(n_clusters=5, n_jobs=4)</code></pre>\n<div class=\"sourceCode\" id=\"cb52\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb52-1\"><a href=\"#cb52-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>km.labels_</span></code></pre></div>\n<pre><code>array([3, 3, 3, ..., 2, 1, 2], dtype=int32)</code></pre>\n<div class=\"sourceCode\" id=\"cb54\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb54-1\"><a href=\"#cb54-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>r1 <span class=\"op\">=</span> pd.Series(km.labels_).value_counts()</span>\n<span id=\"cb54-2\"><a href=\"#cb54-2\" aria-hidden=\"true\" tabindex=\"-1\"></a>r2 <span class=\"op\">=</span> pd.DataFrame(km.cluster_centers_)</span>\n<span id=\"cb54-3\"><a href=\"#cb54-3\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb54-4\"><a href=\"#cb54-4\" aria-hidden=\"true\" tabindex=\"-1\"></a>rr <span class=\"op\">=</span> pd.concat([r2,r1],axis<span class=\"op\">=</span><span class=\"dv\">1</span>)</span>\n<span id=\"cb54-5\"><a href=\"#cb54-5\" aria-hidden=\"true\" tabindex=\"-1\"></a>rr <span class=\"op\">=</span> pd.DataFrame(ss.fit_transform(rr))</span>\n<span id=\"cb54-6\"><a href=\"#cb54-6\" aria-hidden=\"true\" tabindex=\"-1\"></a>rr.columns <span class=\"op\">=</span> <span class=\"bu\">list</span>(data_rfm.columns) <span class=\"op\">+</span> [<span class=\"st\">&#39;counts&#39;</span>]</span>\n<span id=\"cb54-7\"><a href=\"#cb54-7\" aria-hidden=\"true\" tabindex=\"-1\"></a>rr</span></code></pre></div>\n<table border=\"1\" class=\"dataframe\">\n<thead>\n<tr style=\"text-align: right;\">\n<th>\n</th>\n<th>\nR\n</th>\n<th>\nF\n</th>\n<th>\nM\n</th>\n<th>\ncounts\n</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<th>\n0\n</th>\n<td>\n-0.475915\n</td>\n<td>\n-0.389200\n</td>\n<td>\n-0.395668\n</td>\n<td>\n0.146242\n</td>\n</tr>\n<tr>\n<th>\n1\n</th>\n<td>\n1.958565\n</td>\n<td>\n-0.918959\n</td>\n<td>\n-0.893438\n</td>\n<td>\n0.118661\n</td>\n</tr>\n<tr>\n<th>\n2\n</th>\n<td>\n-0.129480\n</td>\n<td>\n-0.846644\n</td>\n<td>\n-0.841995\n</td>\n<td>\n1.712033\n</td>\n</tr>\n<tr>\n<th>\n3\n</th>\n<td>\n-0.727717\n</td>\n<td>\n1.772255\n</td>\n<td>\n1.795436\n</td>\n<td>\n-1.187639\n</td>\n</tr>\n<tr>\n<th>\n4\n</th>\n<td>\n-0.625453\n</td>\n<td>\n0.382548\n</td>\n<td>\n0.335664\n</td>\n<td>\n-0.789296\n</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"分析与决策\">分析与决策</h4>\n<p>使用雷达图对模型学习出的5个群体特征进行可视化分析</p>\n<div class=\"sourceCode\" id=\"cb55\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb55-1\"><a href=\"#cb55-1\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"im\">import</span> numpy <span class=\"im\">as</span> np</span>\n<span id=\"cb55-2\"><a href=\"#cb55-2\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"im\">import</span> matplotlib.pyplot <span class=\"im\">as</span> plt</span>\n<span id=\"cb55-3\"><a href=\"#cb55-3\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"im\">from</span> matplotlib.patches <span class=\"im\">import</span> Circle,RegularPolygon</span>\n<span id=\"cb55-4\"><a href=\"#cb55-4\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"im\">from</span> matplotlib.path <span class=\"im\">import</span> Path</span>\n<span id=\"cb55-5\"><a href=\"#cb55-5\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"im\">from</span> matplotlib.projections.polar <span class=\"im\">import</span> PolarAxes</span>\n<span id=\"cb55-6\"><a href=\"#cb55-6\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"im\">from</span> matplotlib.projections <span class=\"im\">import</span> register_projection</span>\n<span id=\"cb55-7\"><a href=\"#cb55-7\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"im\">from</span> matplotlib.spines <span class=\"im\">import</span> Spine</span>\n<span id=\"cb55-8\"><a href=\"#cb55-8\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"im\">from</span> matplotlib.transforms <span class=\"im\">import</span> Affine2D</span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb56\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb56-1\"><a href=\"#cb56-1\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">def</span> radar_factory(num_vars,frame<span class=\"op\">=</span><span class=\"st\">&#39;circle&#39;</span>):</span>\n<span id=\"cb56-2\"><a href=\"#cb56-2\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"co\"># 计算得到 evenly-spaced axis angles</span></span>\n<span id=\"cb56-3\"><a href=\"#cb56-3\" aria-hidden=\"true\" tabindex=\"-1\"></a>    theta <span class=\"op\">=</span> np.linspace(<span class=\"dv\">0</span>,<span class=\"dv\">2</span><span class=\"op\">*</span>np.pi, num_vars, endpoint<span class=\"op\">=</span><span class=\"va\">False</span>)</span>\n<span id=\"cb56-4\"><a href=\"#cb56-4\" aria-hidden=\"true\" tabindex=\"-1\"></a>    </span>\n<span id=\"cb56-5\"><a href=\"#cb56-5\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"kw\">class</span> RadarAxes(PolarAxes):</span>\n<span id=\"cb56-6\"><a href=\"#cb56-6\" aria-hidden=\"true\" tabindex=\"-1\"></a>        name<span class=\"op\">=</span> <span class=\"st\">&#39;radar&#39;</span></span>\n<span id=\"cb56-7\"><a href=\"#cb56-7\" aria-hidden=\"true\" tabindex=\"-1\"></a>        <span class=\"co\"># 使用1条线段连接指定点</span></span>\n<span id=\"cb56-8\"><a href=\"#cb56-8\" aria-hidden=\"true\" tabindex=\"-1\"></a>        RESOLUTION <span class=\"op\">=</span> <span class=\"dv\">1</span></span>\n<span id=\"cb56-9\"><a href=\"#cb56-9\" aria-hidden=\"true\" tabindex=\"-1\"></a>        </span>\n<span id=\"cb56-10\"><a href=\"#cb56-10\" aria-hidden=\"true\" tabindex=\"-1\"></a>        <span class=\"kw\">def</span> <span class=\"fu\">__init__</span>(<span class=\"va\">self</span>,<span class=\"op\">*</span>args,<span class=\"op\">**</span>kwargs):</span>\n<span id=\"cb56-11\"><a href=\"#cb56-11\" aria-hidden=\"true\" tabindex=\"-1\"></a>            <span class=\"bu\">super</span>().<span class=\"fu\">__init__</span>(<span class=\"op\">*</span>args,<span class=\"op\">**</span>kwargs)</span>\n<span id=\"cb56-12\"><a href=\"#cb56-12\" aria-hidden=\"true\" tabindex=\"-1\"></a>            <span class=\"co\"># 旋转绘图，使第一个轴位于顶部</span></span>\n<span id=\"cb56-13\"><a href=\"#cb56-13\" aria-hidden=\"true\" tabindex=\"-1\"></a>            <span class=\"va\">self</span>.set_theta_zero_location(<span class=\"st\">&#39;N&#39;</span>)</span>\n<span id=\"cb56-14\"><a href=\"#cb56-14\" aria-hidden=\"true\" tabindex=\"-1\"></a>            </span>\n<span id=\"cb56-15\"><a href=\"#cb56-15\" aria-hidden=\"true\" tabindex=\"-1\"></a>        <span class=\"kw\">def</span> fill(<span class=\"va\">self</span>, <span class=\"op\">*</span>args, closed<span class=\"op\">=</span><span class=\"va\">True</span>, <span class=\"op\">**</span>kwargs):</span>\n<span id=\"cb56-16\"><a href=\"#cb56-16\" aria-hidden=\"true\" tabindex=\"-1\"></a>            <span class=\"co\">&quot;&quot;&quot;覆盖填充，以便默认情况下关闭该行&quot;&quot;&quot;</span></span>\n<span id=\"cb56-17\"><a href=\"#cb56-17\" aria-hidden=\"true\" tabindex=\"-1\"></a>            <span class=\"cf\">return</span> <span class=\"bu\">super</span>().fill(closed<span class=\"op\">=</span>closed, <span class=\"op\">*</span>args, <span class=\"op\">**</span>kwargs)</span>\n<span id=\"cb56-18\"><a href=\"#cb56-18\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb56-19\"><a href=\"#cb56-19\" aria-hidden=\"true\" tabindex=\"-1\"></a>        <span class=\"kw\">def</span> plot(<span class=\"va\">self</span>, <span class=\"op\">*</span>args, <span class=\"op\">**</span>kwargs):</span>\n<span id=\"cb56-20\"><a href=\"#cb56-20\" aria-hidden=\"true\" tabindex=\"-1\"></a>            <span class=\"co\">&quot;&quot;&quot;覆盖填充，以便默认情况下关闭该行&quot;&quot;&quot;</span></span>\n<span id=\"cb56-21\"><a href=\"#cb56-21\" aria-hidden=\"true\" tabindex=\"-1\"></a>            lines <span class=\"op\">=</span> <span class=\"bu\">super</span>().plot(<span class=\"op\">*</span>args, <span class=\"op\">**</span>kwargs)</span>\n<span id=\"cb56-22\"><a href=\"#cb56-22\" aria-hidden=\"true\" tabindex=\"-1\"></a>            <span class=\"cf\">for</span> line <span class=\"kw\">in</span> lines:</span>\n<span id=\"cb56-23\"><a href=\"#cb56-23\" aria-hidden=\"true\" tabindex=\"-1\"></a>                <span class=\"va\">self</span>._close_line(line)</span>\n<span id=\"cb56-24\"><a href=\"#cb56-24\" aria-hidden=\"true\" tabindex=\"-1\"></a>                </span>\n<span id=\"cb56-25\"><a href=\"#cb56-25\" aria-hidden=\"true\" tabindex=\"-1\"></a>        <span class=\"kw\">def</span> _close_line(<span class=\"va\">self</span>, line):</span>\n<span id=\"cb56-26\"><a href=\"#cb56-26\" aria-hidden=\"true\" tabindex=\"-1\"></a>            x, y <span class=\"op\">=</span> line.get_data()</span>\n<span id=\"cb56-27\"><a href=\"#cb56-27\" aria-hidden=\"true\" tabindex=\"-1\"></a>            <span class=\"co\"># </span><span class=\"al\">FIXME</span><span class=\"co\">: x[0], y[0] 处的标记加倍</span></span>\n<span id=\"cb56-28\"><a href=\"#cb56-28\" aria-hidden=\"true\" tabindex=\"-1\"></a>            <span class=\"cf\">if</span> x[<span class=\"dv\">0</span>] <span class=\"op\">!=</span> x[<span class=\"op\">-</span><span class=\"dv\">1</span>]:</span>\n<span id=\"cb56-29\"><a href=\"#cb56-29\" aria-hidden=\"true\" tabindex=\"-1\"></a>                x <span class=\"op\">=</span> np.concatenate((x, [x[<span class=\"dv\">0</span>]]))</span>\n<span id=\"cb56-30\"><a href=\"#cb56-30\" aria-hidden=\"true\" tabindex=\"-1\"></a>                y <span class=\"op\">=</span> np.concatenate((y, [y[<span class=\"dv\">0</span>]]))</span>\n<span id=\"cb56-31\"><a href=\"#cb56-31\" aria-hidden=\"true\" tabindex=\"-1\"></a>                line.set_data(x, y)</span>\n<span id=\"cb56-32\"><a href=\"#cb56-32\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb56-33\"><a href=\"#cb56-33\" aria-hidden=\"true\" tabindex=\"-1\"></a>        <span class=\"kw\">def</span> set_varlabels(<span class=\"va\">self</span>, labels):</span>\n<span id=\"cb56-34\"><a href=\"#cb56-34\" aria-hidden=\"true\" tabindex=\"-1\"></a>            <span class=\"va\">self</span>.set_thetagrids(np.degrees(theta), labels)</span>\n<span id=\"cb56-35\"><a href=\"#cb56-35\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb56-36\"><a href=\"#cb56-36\" aria-hidden=\"true\" tabindex=\"-1\"></a>        <span class=\"kw\">def</span> _gen_axes_patch(<span class=\"va\">self</span>):</span>\n<span id=\"cb56-37\"><a href=\"#cb56-37\" aria-hidden=\"true\" tabindex=\"-1\"></a>            <span class=\"co\"># 轴必须以（0.5，0.5）为中心并且半径为0.5</span></span>\n<span id=\"cb56-38\"><a href=\"#cb56-38\" aria-hidden=\"true\" tabindex=\"-1\"></a>            <span class=\"co\"># 在轴坐标中。</span></span>\n<span id=\"cb56-39\"><a href=\"#cb56-39\" aria-hidden=\"true\" tabindex=\"-1\"></a>            <span class=\"cf\">if</span> frame <span class=\"op\">==</span> <span class=\"st\">&#39;circle&#39;</span>:</span>\n<span id=\"cb56-40\"><a href=\"#cb56-40\" aria-hidden=\"true\" tabindex=\"-1\"></a>                <span class=\"cf\">return</span> Circle((<span class=\"fl\">0.5</span>, <span class=\"fl\">0.5</span>), <span class=\"fl\">0.5</span>)</span>\n<span id=\"cb56-41\"><a href=\"#cb56-41\" aria-hidden=\"true\" tabindex=\"-1\"></a>            <span class=\"cf\">elif</span> frame <span class=\"op\">==</span> <span class=\"st\">&#39;polygon&#39;</span>:</span>\n<span id=\"cb56-42\"><a href=\"#cb56-42\" aria-hidden=\"true\" tabindex=\"-1\"></a>                <span class=\"cf\">return</span> RegularPolygon((<span class=\"fl\">0.5</span>, <span class=\"fl\">0.5</span>), num_vars,</span>\n<span id=\"cb56-43\"><a href=\"#cb56-43\" aria-hidden=\"true\" tabindex=\"-1\"></a>                                      radius<span class=\"op\">=</span><span class=\"fl\">.5</span>, edgecolor<span class=\"op\">=</span><span class=\"st\">&quot;k&quot;</span>)</span>\n<span id=\"cb56-44\"><a href=\"#cb56-44\" aria-hidden=\"true\" tabindex=\"-1\"></a>            <span class=\"cf\">else</span>:</span>\n<span id=\"cb56-45\"><a href=\"#cb56-45\" aria-hidden=\"true\" tabindex=\"-1\"></a>                <span class=\"cf\">raise</span> <span class=\"pp\">ValueError</span>(<span class=\"st\">&quot;unknown value for &#39;frame&#39;: </span><span class=\"sc\">%s</span><span class=\"st\">&quot;</span> <span class=\"op\">%</span> frame)</span>\n<span id=\"cb56-46\"><a href=\"#cb56-46\" aria-hidden=\"true\" tabindex=\"-1\"></a>        </span>\n<span id=\"cb56-47\"><a href=\"#cb56-47\" aria-hidden=\"true\" tabindex=\"-1\"></a>        <span class=\"kw\">def</span> _gen_axes_spines(<span class=\"va\">self</span>):</span>\n<span id=\"cb56-48\"><a href=\"#cb56-48\" aria-hidden=\"true\" tabindex=\"-1\"></a>            <span class=\"cf\">if</span> frame <span class=\"op\">==</span> <span class=\"st\">&#39;circle&#39;</span>:</span>\n<span id=\"cb56-49\"><a href=\"#cb56-49\" aria-hidden=\"true\" tabindex=\"-1\"></a>                <span class=\"cf\">return</span> <span class=\"bu\">super</span>()._gen_axes_spines()</span>\n<span id=\"cb56-50\"><a href=\"#cb56-50\" aria-hidden=\"true\" tabindex=\"-1\"></a>            <span class=\"cf\">elif</span> frame <span class=\"op\">==</span> <span class=\"st\">&#39;polygon&#39;</span>:</span>\n<span id=\"cb56-51\"><a href=\"#cb56-51\" aria-hidden=\"true\" tabindex=\"-1\"></a>                <span class=\"co\"># spine_type 必须是&#39;left&#39;/&#39;right&#39;/&#39;top&#39;/&#39;bottom&#39;/&#39;circle&#39;.</span></span>\n<span id=\"cb56-52\"><a href=\"#cb56-52\" aria-hidden=\"true\" tabindex=\"-1\"></a>                spine <span class=\"op\">=</span> Spine(axes<span class=\"op\">=</span><span class=\"va\">self</span>,</span>\n<span id=\"cb56-53\"><a href=\"#cb56-53\" aria-hidden=\"true\" tabindex=\"-1\"></a>                              spine_type<span class=\"op\">=</span><span class=\"st\">&#39;circle&#39;</span>,</span>\n<span id=\"cb56-54\"><a href=\"#cb56-54\" aria-hidden=\"true\" tabindex=\"-1\"></a>                              path<span class=\"op\">=</span>Path.unit_regular_polygon(num_vars))</span>\n<span id=\"cb56-55\"><a href=\"#cb56-55\" aria-hidden=\"true\" tabindex=\"-1\"></a>                <span class=\"co\"># unit_regular_polygon 给出以1为中心的半径为1的多边形</span></span>\n<span id=\"cb56-56\"><a href=\"#cb56-56\" aria-hidden=\"true\" tabindex=\"-1\"></a>                <span class=\"co\">#（0，0），但我们希望以（0.5，</span></span>\n<span id=\"cb56-57\"><a href=\"#cb56-57\" aria-hidden=\"true\" tabindex=\"-1\"></a>                <span class=\"co\">#   0.5）的坐标轴。</span></span>\n<span id=\"cb56-58\"><a href=\"#cb56-58\" aria-hidden=\"true\" tabindex=\"-1\"></a>                spine.set_transform(Affine2D().scale(<span class=\"fl\">.5</span>).translate(<span class=\"fl\">.5</span>, <span class=\"fl\">.5</span>)</span>\n<span id=\"cb56-59\"><a href=\"#cb56-59\" aria-hidden=\"true\" tabindex=\"-1\"></a>                                    <span class=\"op\">+</span> <span class=\"va\">self</span>.transAxes)</span>\n<span id=\"cb56-60\"><a href=\"#cb56-60\" aria-hidden=\"true\" tabindex=\"-1\"></a>                <span class=\"cf\">return</span> &#123;<span class=\"st\">&#39;polar&#39;</span>: spine&#125;</span>\n<span id=\"cb56-61\"><a href=\"#cb56-61\" aria-hidden=\"true\" tabindex=\"-1\"></a>            <span class=\"cf\">else</span>:</span>\n<span id=\"cb56-62\"><a href=\"#cb56-62\" aria-hidden=\"true\" tabindex=\"-1\"></a>                <span class=\"cf\">raise</span> <span class=\"pp\">ValueError</span>(<span class=\"st\">&quot;unknown value for &#39;frame&#39;: </span><span class=\"sc\">%s</span><span class=\"st\">&quot;</span> <span class=\"op\">%</span> frame)</span>\n<span id=\"cb56-63\"><a href=\"#cb56-63\" aria-hidden=\"true\" tabindex=\"-1\"></a>    register_projection(RadarAxes)</span>\n<span id=\"cb56-64\"><a href=\"#cb56-64\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"cf\">return</span> theta</span></code></pre></div>\n<h4 id=\"lcrfm模型作图\">LCRFM模型作图</h4>\n<div class=\"sourceCode\" id=\"cb57\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb57-1\"><a href=\"#cb57-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>N <span class=\"op\">=</span> num_clusters</span>\n<span id=\"cb57-2\"><a href=\"#cb57-2\" aria-hidden=\"true\" tabindex=\"-1\"></a>theta <span class=\"op\">=</span> radar_factory(N, frame<span class=\"op\">=</span><span class=\"st\">&#39;polygon&#39;</span>)</span>\n<span id=\"cb57-3\"><a href=\"#cb57-3\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb57-4\"><a href=\"#cb57-4\" aria-hidden=\"true\" tabindex=\"-1\"></a>data <span class=\"op\">=</span> r.to_numpy()</span>\n<span id=\"cb57-5\"><a href=\"#cb57-5\" aria-hidden=\"true\" tabindex=\"-1\"></a>fig,ax <span class=\"op\">=</span> plt.subplots(figsize<span class=\"op\">=</span>(<span class=\"dv\">5</span>,<span class=\"dv\">5</span>), nrows <span class=\"op\">=</span> <span class=\"dv\">1</span>, ncols<span class=\"op\">=</span><span class=\"dv\">1</span>, subplot_kw<span class=\"op\">=</span><span class=\"bu\">dict</span>(projection<span class=\"op\">=</span><span class=\"st\">&#39;radar&#39;</span>))</span>\n<span id=\"cb57-6\"><a href=\"#cb57-6\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb57-7\"><a href=\"#cb57-7\" aria-hidden=\"true\" tabindex=\"-1\"></a>fig.subplots_adjust(wspace<span class=\"op\">=</span><span class=\"fl\">0.25</span>,hspace<span class=\"op\">=</span><span class=\"fl\">0.20</span>,top<span class=\"op\">=</span><span class=\"fl\">0.85</span>,bottom<span class=\"op\">=</span><span class=\"fl\">0.05</span>)</span>\n<span id=\"cb57-8\"><a href=\"#cb57-8\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb57-9\"><a href=\"#cb57-9\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"co\"># 去掉最后一列</span></span>\n<span id=\"cb57-10\"><a href=\"#cb57-10\" aria-hidden=\"true\" tabindex=\"-1\"></a>case_data <span class=\"op\">=</span> data[:,:<span class=\"op\">-</span><span class=\"dv\">1</span>]</span>\n<span id=\"cb57-11\"><a href=\"#cb57-11\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"co\"># 设置纵坐标不可见</span></span>\n<span id=\"cb57-12\"><a href=\"#cb57-12\" aria-hidden=\"true\" tabindex=\"-1\"></a>ax.get_yaxis().set_visible(<span class=\"va\">False</span>)</span>\n<span id=\"cb57-13\"><a href=\"#cb57-13\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb57-14\"><a href=\"#cb57-14\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"co\"># 图片标题</span></span>\n<span id=\"cb57-15\"><a href=\"#cb57-15\" aria-hidden=\"true\" tabindex=\"-1\"></a>title <span class=\"op\">=</span> <span class=\"st\">&quot;Radar Chart for Different Means&quot;</span></span>\n<span id=\"cb57-16\"><a href=\"#cb57-16\" aria-hidden=\"true\" tabindex=\"-1\"></a>ax.set_title(title, weight<span class=\"op\">=</span><span class=\"st\">&#39;bold&#39;</span>, size<span class=\"op\">=</span><span class=\"st\">&#39;medium&#39;</span>, position<span class=\"op\">=</span>(<span class=\"fl\">0.5</span>, <span class=\"fl\">1.1</span>),</span>\n<span id=\"cb57-17\"><a href=\"#cb57-17\" aria-hidden=\"true\" tabindex=\"-1\"></a>             horizontalalignment<span class=\"op\">=</span><span class=\"st\">&#39;center&#39;</span>, verticalalignment<span class=\"op\">=</span><span class=\"st\">&#39;center&#39;</span>)</span>\n<span id=\"cb57-18\"><a href=\"#cb57-18\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"cf\">for</span> d <span class=\"kw\">in</span> case_data:</span>\n<span id=\"cb57-19\"><a href=\"#cb57-19\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"co\"># 画边</span></span>\n<span id=\"cb57-20\"><a href=\"#cb57-20\" aria-hidden=\"true\" tabindex=\"-1\"></a>    ax.plot(theta, d)</span>\n<span id=\"cb57-21\"><a href=\"#cb57-21\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"co\"># 填充颜色</span></span>\n<span id=\"cb57-22\"><a href=\"#cb57-22\" aria-hidden=\"true\" tabindex=\"-1\"></a>    ax.fill(theta, d, alpha<span class=\"op\">=</span><span class=\"fl\">0.05</span>)</span>\n<span id=\"cb57-23\"><a href=\"#cb57-23\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"co\"># 设置纵坐标名称</span></span>\n<span id=\"cb57-24\"><a href=\"#cb57-24\" aria-hidden=\"true\" tabindex=\"-1\"></a>ax.set_varlabels(features)</span>\n<span id=\"cb57-25\"><a href=\"#cb57-25\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb57-26\"><a href=\"#cb57-26\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"co\"># 添加图例</span></span>\n<span id=\"cb57-27\"><a href=\"#cb57-27\" aria-hidden=\"true\" tabindex=\"-1\"></a>labels <span class=\"op\">=</span> [<span class=\"st\">&quot;CustomerCluster_&quot;</span> <span class=\"op\">+</span> <span class=\"bu\">str</span>(i) <span class=\"cf\">for</span> i <span class=\"kw\">in</span> <span class=\"bu\">range</span>(<span class=\"dv\">1</span>,<span class=\"dv\">6</span>)]</span>\n<span id=\"cb57-28\"><a href=\"#cb57-28\" aria-hidden=\"true\" tabindex=\"-1\"></a>legend <span class=\"op\">=</span> ax.legend(labels, loc<span class=\"op\">=</span>(<span class=\"fl\">0.9</span>, <span class=\"fl\">.75</span>), labelspacing<span class=\"op\">=</span><span class=\"fl\">0.1</span>)</span>\n<span id=\"cb57-29\"><a href=\"#cb57-29\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb57-30\"><a href=\"#cb57-30\" aria-hidden=\"true\" tabindex=\"-1\"></a>plt.show()</span></code></pre></div>\n<p>​<br>\n<img src=\"/.top//Users\\YSilhouette\\AppData\\Local\\Temp\\360zip$Temp\\360output_55_0.png\\output_55_0.png\" alt=\"png\"> ​</p>\n<h4 id=\"rfm模型作图\">RFM模型作图</h4>\n<div class=\"sourceCode\" id=\"cb58\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb58-1\"><a href=\"#cb58-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>theta <span class=\"op\">=</span> radar_factory(<span class=\"dv\">3</span>, frame<span class=\"op\">=</span><span class=\"st\">&#39;polygon&#39;</span>)</span>\n<span id=\"cb58-2\"><a href=\"#cb58-2\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb58-3\"><a href=\"#cb58-3\" aria-hidden=\"true\" tabindex=\"-1\"></a>data <span class=\"op\">=</span> rr.to_numpy()</span>\n<span id=\"cb58-4\"><a href=\"#cb58-4\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb58-5\"><a href=\"#cb58-5\" aria-hidden=\"true\" tabindex=\"-1\"></a>fig, ax <span class=\"op\">=</span> plt.subplots(figsize<span class=\"op\">=</span>(<span class=\"dv\">5</span>, <span class=\"dv\">5</span>), nrows<span class=\"op\">=</span><span class=\"dv\">1</span>, ncols<span class=\"op\">=</span><span class=\"dv\">1</span>,</span>\n<span id=\"cb58-6\"><a href=\"#cb58-6\" aria-hidden=\"true\" tabindex=\"-1\"></a>                         subplot_kw<span class=\"op\">=</span><span class=\"bu\">dict</span>(projection<span class=\"op\">=</span><span class=\"st\">&#39;radar&#39;</span>))</span>\n<span id=\"cb58-7\"><a href=\"#cb58-7\" aria-hidden=\"true\" tabindex=\"-1\"></a>fig.subplots_adjust(wspace<span class=\"op\">=</span><span class=\"fl\">0.25</span>, hspace<span class=\"op\">=</span><span class=\"fl\">0.20</span>, top<span class=\"op\">=</span><span class=\"fl\">0.85</span>, bottom<span class=\"op\">=</span><span class=\"fl\">0.05</span>)</span>\n<span id=\"cb58-8\"><a href=\"#cb58-8\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb58-9\"><a href=\"#cb58-9\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"co\"># 去掉最后一列</span></span>\n<span id=\"cb58-10\"><a href=\"#cb58-10\" aria-hidden=\"true\" tabindex=\"-1\"></a>case_data <span class=\"op\">=</span> data[:, :<span class=\"op\">-</span><span class=\"dv\">1</span>]</span>\n<span id=\"cb58-11\"><a href=\"#cb58-11\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"co\"># 设置纵坐标不可见</span></span>\n<span id=\"cb58-12\"><a href=\"#cb58-12\" aria-hidden=\"true\" tabindex=\"-1\"></a>ax.get_yaxis().set_visible(<span class=\"va\">False</span>)</span>\n<span id=\"cb58-13\"><a href=\"#cb58-13\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"co\"># 图片标题</span></span>\n<span id=\"cb58-14\"><a href=\"#cb58-14\" aria-hidden=\"true\" tabindex=\"-1\"></a>title <span class=\"op\">=</span> <span class=\"st\">&quot;Radar Chart for Different Means&quot;</span></span>\n<span id=\"cb58-15\"><a href=\"#cb58-15\" aria-hidden=\"true\" tabindex=\"-1\"></a>ax.set_title(title, weight<span class=\"op\">=</span><span class=\"st\">&#39;bold&#39;</span>, size<span class=\"op\">=</span><span class=\"st\">&#39;medium&#39;</span>, position<span class=\"op\">=</span>(<span class=\"fl\">0.5</span>, <span class=\"fl\">1.1</span>),</span>\n<span id=\"cb58-16\"><a href=\"#cb58-16\" aria-hidden=\"true\" tabindex=\"-1\"></a>             horizontalalignment<span class=\"op\">=</span><span class=\"st\">&#39;center&#39;</span>, verticalalignment<span class=\"op\">=</span><span class=\"st\">&#39;center&#39;</span>)</span>\n<span id=\"cb58-17\"><a href=\"#cb58-17\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"cf\">for</span> d <span class=\"kw\">in</span> case_data:</span>\n<span id=\"cb58-18\"><a href=\"#cb58-18\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"co\"># 画边</span></span>\n<span id=\"cb58-19\"><a href=\"#cb58-19\" aria-hidden=\"true\" tabindex=\"-1\"></a>    ax.plot(theta, d)</span>\n<span id=\"cb58-20\"><a href=\"#cb58-20\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"co\"># 填充颜色</span></span>\n<span id=\"cb58-21\"><a href=\"#cb58-21\" aria-hidden=\"true\" tabindex=\"-1\"></a>    ax.fill(theta, d, alpha<span class=\"op\">=</span><span class=\"fl\">0.05</span>)</span>\n<span id=\"cb58-22\"><a href=\"#cb58-22\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"co\"># 设置纵坐标名称</span></span>\n<span id=\"cb58-23\"><a href=\"#cb58-23\" aria-hidden=\"true\" tabindex=\"-1\"></a>ax.set_varlabels([<span class=\"st\">&#39;R&#39;</span>,<span class=\"st\">&#39;F&#39;</span>,<span class=\"st\">&#39;M&#39;</span>])</span>\n<span id=\"cb58-24\"><a href=\"#cb58-24\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb58-25\"><a href=\"#cb58-25\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"co\"># 添加图例</span></span>\n<span id=\"cb58-26\"><a href=\"#cb58-26\" aria-hidden=\"true\" tabindex=\"-1\"></a>labels <span class=\"op\">=</span> [<span class=\"st\">&quot;CustomerCluster_&quot;</span> <span class=\"op\">+</span> <span class=\"bu\">str</span>(i) <span class=\"cf\">for</span> i <span class=\"kw\">in</span> <span class=\"bu\">range</span>(<span class=\"dv\">1</span>,<span class=\"dv\">6</span>)]</span>\n<span id=\"cb58-27\"><a href=\"#cb58-27\" aria-hidden=\"true\" tabindex=\"-1\"></a>legend <span class=\"op\">=</span> ax.legend(labels, loc<span class=\"op\">=</span>(<span class=\"fl\">0.9</span>, <span class=\"fl\">.75</span>), labelspacing<span class=\"op\">=</span><span class=\"fl\">0.1</span>)</span>\n<span id=\"cb58-28\"><a href=\"#cb58-28\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb58-29\"><a href=\"#cb58-29\" aria-hidden=\"true\" tabindex=\"-1\"></a>plt.show()</span></code></pre></div>\n<figure>\n<img src=\"/.top//output_57_0.png\" alt=\"png\">\n<figcaption aria-hidden=\"true\">png</figcaption>\n</figure>\n<h4 id=\"dbscan模型对lcrfm特征进行计算\">DBSCAN模型对LCRFM特征进行计算</h4>\n<div class=\"sourceCode\" id=\"cb59\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb59-1\"><a href=\"#cb59-1\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"im\">from</span> sklearn.cluster <span class=\"im\">import</span> DBSCAN</span>\n<span id=\"cb59-2\"><a href=\"#cb59-2\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb59-3\"><a href=\"#cb59-3\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"co\"># Kagging debug</span></span>\n<span id=\"cb59-4\"><a href=\"#cb59-4\" aria-hidden=\"true\" tabindex=\"-1\"></a>db <span class=\"op\">=</span> DBSCAN(eps<span class=\"op\">=</span><span class=\"dv\">10</span>,min_samples<span class=\"op\">=</span><span class=\"dv\">2</span>).fit(data_db.sample(<span class=\"dv\">10000</span>))</span>\n<span id=\"cb59-5\"><a href=\"#cb59-5\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb59-6\"><a href=\"#cb59-6\" aria-hidden=\"true\" tabindex=\"-1\"></a>DBSCAN_labels <span class=\"op\">=</span> db.labels_</span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb60\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb60-1\"><a href=\"#cb60-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>DBSCAN_labels</span></code></pre></div>\n<pre><code>array([0, 0, 0, ..., 0, 0, 0])</code></pre>\n<h4 id=\"根据lcrfm结果进行分析\">根据LCRFM结果进行分析</h4>\n<p>应实际业务对聚类结果进行分值离散转化，对应1-5分，其中属性值越大，分数越高：\n<img src=\"/.top//output_57_1.png\" alt=\"image.png\"></p>\n<ol type=\"1\">\n<li>重要保持客户</li>\n</ol>\n<p>平均折扣率高(C↑)，最近有乘机记录(R↓)，乘机次数高(F↑)或里程高(M↑)：\n这类客户机票票价高，不在意机票折扣，经常乘机，是最理想的客户类型。\n公司应优先将资源投放到他们身上，维持这类客户的忠诚度。</p>\n<ol start=\"2\" type=\"1\">\n<li>重要发展客户</li>\n</ol>\n<p>平均折扣率高(C↑)，最近有乘机记录(R↓)，乘机次数低(F↓)或里程低(M↓)：\n这类客户机票票价高，不在意机票折扣，最近有乘机记录，但总里程低，具有很大的发展潜力。\n公司应加强这类客户的满意度，使他们逐渐成为忠诚客户。</p>\n<ol start=\"3\" type=\"1\">\n<li>重要挽留客户</li>\n</ol>\n<p>平均折扣率高(C↑)，乘机次数高(F↑)或里程高(M↑)，最近无乘机记录(R↑)：\n这类客户总里程高，但较长时间没有乘机，可能处于流失状态。\n公司应加强与这类客户的互动，召回用户，延长客户的生命周期。</p>\n<ol start=\"4\" type=\"1\">\n<li>一般客户</li>\n</ol>\n<p>平均折扣率低(C↓)，最近无乘机记录(R↑)，乘机次数高(F↓)或里程高(M↓)，入会时间短(L↓)：\n这类客户机票票价低，经常买折扣机票，最近无乘机记录，可能是趁着折扣而选择购买，对品牌无忠诚度。\n公司需要在资源支持的情况下强化对这类客户的联系。</p>\n<ol start=\"5\" type=\"1\">\n<li>低价值客户</li>\n</ol>\n<p>平均折扣率低（C↓），最近无乘机记录（R↑），乘机次数高（F↓）或里程高（M↓），入会时间短（L↓）：\n这类客户与一般客户类似，机票票价低，经常买折扣机票，最近无乘机记录，可能是趁着折扣而选择购买，对品牌无忠诚度。</p>\n<h4 id=\"结果分析\">结果分析</h4>\n<ul>\n<li><p>群体1的L属性最大</p></li>\n<li><p>群体2的L、C属性最小</p></li>\n<li><p>群体3的C属性上最大</p></li>\n<li><p>群体4的M、F属性属性最大，R属性最小</p></li>\n<li><p>群体5的R属性最大，F、M属性最小</p></li>\n<li><p>其中每项指标的实际业务意义为：</p>\n<ul>\n<li>L：加入会员的时长。越大代表会员资历越久</li>\n<li>R：最近一次乘机时间。越大代表越久没乘机</li>\n<li>F：乘机次数。越大代表乘机次数越多</li>\n<li>M：飞行总里程。越大代表总里程越多</li>\n<li>C：平均折扣率。越大代表折扣越弱，0表示0折免费机票，10代表无折机票</li>\n</ul></li>\n</ul>\n<p>重要保持客户：客户群4</p>\n<p>重要发展客户：客户群3</p>\n<p>重要挽留客户：客户群1</p>\n<p>一般客户：客户群2</p>\n<p>低价值客户：客户群5</p>\n<h4 id=\"决策\">决策</h4>\n<ul>\n<li>重要发展客户、重要保持客户、重要挽留客户这三类客户其实也对应着客户生命周期中的发展期、稳定器、衰退期三个时期。</li>\n<li>从客户生命周期的角度讲，也应重点投入资源召回衰退期的客户。</li>\n<li>一般而言，数据分析最终的目的是针对分析结果提出并开展一系列的运营/营销策略，以期帮助企业发展。在本实例中，运营策略有三个方向：\n<ul>\n<li>提高活跃度：提高一般客户、低价值客户的活跃度。将其转化为优质客户</li>\n<li>提高留存率：与重要挽留客户互动，提高这部分用户的留存率</li>\n<li>提高付费率：维系重要保持客户、重要发展客户的忠诚度，保持企业良好收入</li>\n<li>每个方向对应不同的策略，如会员升级、积分兑换、交叉销售、发放折扣券等手段</li>\n</ul></li>\n</ul>\n<hr>\n<h3 id=\"about-me\">About ME</h3>\n<h5 id=\"读书城南-在未来面前我们都是孩子\">👋 读书城南，🤔\n在未来面前，我们都是孩子～</h5>\n<ul>\n<li>📙\n一个热衷于探索学习新方向、新事物的智能产品经理，闲暇时间喜欢coding💻、画图🎨、音乐🎵、学习ing~</li>\n</ul>\n<h5 id=\"social-media\">👋 Social Media</h5>\n<ul>\n<li><p>🛠️ Blog: <a href=\"http://oceaneyes.top\">http://oceaneyes.top</a></p></li>\n<li><p>⚡ PM导航: <a href=\"https://pmhub.oceangzy.top\">https://pmhub.oceangzy.top</a></p></li>\n<li><p>☘️ CNBLOG: <a href=\"https://www.cnblogs.com/oceaneyes-gzy/\">https://www.cnblogs.com/oceaneyes-gzy/</a></p></li>\n<li><p>🌱 AI PRJ自己部署的一些算法demo: <a href=\"http://ai.oceangzy.top/\">http://ai.oceangzy.top/</a></p></li>\n<li><p>📫 Email: 1450136519@qq.com</p></li>\n<li><p>💬 WeChat: <a href=\"https://oceaneyes.top/img/wechatqrcode.jpg\">OCEANGZY</a></p></li>\n<li><p>💬 公众号: <a href=\"https://oceaneyes.top/img/wechatgzh.jpeg\">UncleJoker-GZY</a></p></li>\n</ul>\n<h5 id=\"加入小组\">👋 加入小组~</h5>\n<p><img src=\"https://oceaneyes.top/img/zhishigroup.jpg\" title=\"加入组织\" alt width=\"240\"></p>\n<h5 id=\"感谢打赏\">👋 感谢打赏~</h5>\n<p><img src=\"https://oceaneyes.top/img/alipay.jpg\" title=\"支付宝打赏\" alt width=\"140\">\n<img src=\"https://oceaneyes.top/img/wechatpay.jpg\" title=\"微信打赏\" alt width=\"140\"></p>\n","more":"<h2 id=\"航空公司客户价值聚类分析\">航空公司客户价值聚类分析</h2>\n<ul>\n<li>特征工程</li>\n<li>K-means聚类</li>\n<li>RFM模型</li>\n<li>DBSCAN算法</li>\n</ul>\n<h4 id=\"描述\">描述</h4>\n<p>信息时代的来临使得企业营销焦点从产品中心转变成客户中心。具体地，对不同的客户进行分类管理，给予不同类型的客户制定优化的个性化服务方案，采取不同的营销策略。将有限的营销资源集中于高价值的客户，实现企业利润最大化</p>\n<ol type=\"1\">\n<li>借助航空公司数据，对客户进行分类</li>\n<li>对不同类别的客户进行特征分析，比较不同类别客户的价值</li>\n<li>对不同价值的客户类别进行个性化服务，制定相应的营销策略</li>\n</ol>\n<h4 id=\"思路\">思路</h4>\n<figure>\n<img src=\"/.top//01.png\" alt=\"image.png\">\n<figcaption aria-hidden=\"true\">image.png</figcaption>\n</figure>\n<h4 id=\"数据\">数据</h4>\n<h5 id=\"数据集中字段含义\">数据集中字段含义</h5>\n<p><img src=\"/.top//02.png\" alt=\"image.png\"> <img src=\"/.top//03.png\" alt=\"image.png\"></p>\n<h5 id=\"数据预处理\">数据预处理</h5>\n<div class=\"sourceCode\" id=\"cb1\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb1-1\"><a href=\"#cb1-1\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"im\">import</span> pandas <span class=\"im\">as</span> pd</span>\n<span id=\"cb1-2\"><a href=\"#cb1-2\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"im\">import</span> numpy <span class=\"im\">as</span> np</span>\n<span id=\"cb1-3\"><a href=\"#cb1-3\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"im\">import</span> matplotlib.pyplot <span class=\"im\">as</span> plt</span>\n<span id=\"cb1-4\"><a href=\"#cb1-4\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"im\">import</span> datetime</span>\n<span id=\"cb1-5\"><a href=\"#cb1-5\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"im\">import</span> sklearn.preprocessing</span>\n<span id=\"cb1-6\"><a href=\"#cb1-6\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"im\">import</span> sklearn.cluster</span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb2\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb2-1\"><a href=\"#cb2-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>air_data_path <span class=\"op\">=</span> <span class=\"st\">&quot;./dataset/air_data.csv&quot;</span></span>\n<span id=\"cb2-2\"><a href=\"#cb2-2\" aria-hidden=\"true\" tabindex=\"-1\"></a>air_data <span class=\"op\">=</span> pd.read_csv(air_data_path)</span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb3\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb3-1\"><a href=\"#cb3-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>air_data.shape</span></code></pre></div>\n<pre><code>(62988, 44)</code></pre>\n<div class=\"sourceCode\" id=\"cb5\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb5-1\"><a href=\"#cb5-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>air_data.head()</span></code></pre></div>\n<table border=\"1\" class=\"dataframe\">\n<thead>\n<tr style=\"text-align: right;\">\n<th>\n</th>\n<th>\nMEMBER_NO\n</th>\n<th>\nFFP_DATE\n</th>\n<th>\nFIRST_FLIGHT_DATE\n</th>\n<th>\nGENDER\n</th>\n<th>\nFFP_TIER\n</th>\n<th>\nWORK_CITY\n</th>\n<th>\nWORK_PROVINCE\n</th>\n<th>\nWORK_COUNTRY\n</th>\n<th>\nAGE\n</th>\n<th>\nLOAD_TIME\n</th>\n<th>\n...\n</th>\n<th>\nADD_Point_SUM\n</th>\n<th>\nEli_Add_Point_Sum\n</th>\n<th>\nL1Y_ELi_Add_Points\n</th>\n<th>\nPoints_Sum\n</th>\n<th>\nL1Y_Points_Sum\n</th>\n<th>\nRation_L1Y_Flight_Count\n</th>\n<th>\nRation_P1Y_Flight_Count\n</th>\n<th>\nRation_P1Y_BPS\n</th>\n<th>\nRation_L1Y_BPS\n</th>\n<th>\nPoint_NotFlight\n</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<th>\n0\n</th>\n<td>\n54993\n</td>\n<td>\n2006/11/02\n</td>\n<td>\n2008/12/24\n</td>\n<td>\n男\n</td>\n<td>\n6\n</td>\n<td>\n.\n</td>\n<td>\n北京\n</td>\n<td>\nCN\n</td>\n<td>\n31.0\n</td>\n<td>\n2014/03/31\n</td>\n<td>\n...\n</td>\n<td>\n39992\n</td>\n<td>\n114452\n</td>\n<td>\n111100\n</td>\n<td>\n619760\n</td>\n<td>\n370211\n</td>\n<td>\n0.509524\n</td>\n<td>\n0.490476\n</td>\n<td>\n0.487221\n</td>\n<td>\n0.512777\n</td>\n<td>\n50\n</td>\n</tr>\n<tr>\n<th>\n1\n</th>\n<td>\n28065\n</td>\n<td>\n2007/02/19\n</td>\n<td>\n2007/08/03\n</td>\n<td>\n男\n</td>\n<td>\n6\n</td>\n<td>\nNaN\n</td>\n<td>\n北京\n</td>\n<td>\nCN\n</td>\n<td>\n42.0\n</td>\n<td>\n2014/03/31\n</td>\n<td>\n...\n</td>\n<td>\n12000\n</td>\n<td>\n53288\n</td>\n<td>\n53288\n</td>\n<td>\n415768\n</td>\n<td>\n238410\n</td>\n<td>\n0.514286\n</td>\n<td>\n0.485714\n</td>\n<td>\n0.489289\n</td>\n<td>\n0.510708\n</td>\n<td>\n33\n</td>\n</tr>\n<tr>\n<th>\n2\n</th>\n<td>\n55106\n</td>\n<td>\n2007/02/01\n</td>\n<td>\n2007/08/30\n</td>\n<td>\n男\n</td>\n<td>\n6\n</td>\n<td>\n.\n</td>\n<td>\n北京\n</td>\n<td>\nCN\n</td>\n<td>\n40.0\n</td>\n<td>\n2014/03/31\n</td>\n<td>\n...\n</td>\n<td>\n15491\n</td>\n<td>\n55202\n</td>\n<td>\n51711\n</td>\n<td>\n406361\n</td>\n<td>\n233798\n</td>\n<td>\n0.518519\n</td>\n<td>\n0.481481\n</td>\n<td>\n0.481467\n</td>\n<td>\n0.518530\n</td>\n<td>\n26\n</td>\n</tr>\n<tr>\n<th>\n3\n</th>\n<td>\n21189\n</td>\n<td>\n2008/08/22\n</td>\n<td>\n2008/08/23\n</td>\n<td>\n男\n</td>\n<td>\n5\n</td>\n<td>\nLos Angeles\n</td>\n<td>\nCA\n</td>\n<td>\nUS\n</td>\n<td>\n64.0\n</td>\n<td>\n2014/03/31\n</td>\n<td>\n...\n</td>\n<td>\n0\n</td>\n<td>\n34890\n</td>\n<td>\n34890\n</td>\n<td>\n372204\n</td>\n<td>\n186100\n</td>\n<td>\n0.434783\n</td>\n<td>\n0.565217\n</td>\n<td>\n0.551722\n</td>\n<td>\n0.448275\n</td>\n<td>\n12\n</td>\n</tr>\n<tr>\n<th>\n4\n</th>\n<td>\n39546\n</td>\n<td>\n2009/04/10\n</td>\n<td>\n2009/04/15\n</td>\n<td>\n男\n</td>\n<td>\n6\n</td>\n<td>\n贵阳\n</td>\n<td>\n贵州\n</td>\n<td>\nCN\n</td>\n<td>\n48.0\n</td>\n<td>\n2014/03/31\n</td>\n<td>\n...\n</td>\n<td>\n22704\n</td>\n<td>\n64969\n</td>\n<td>\n64969\n</td>\n<td>\n338813\n</td>\n<td>\n210365\n</td>\n<td>\n0.532895\n</td>\n<td>\n0.467105\n</td>\n<td>\n0.469054\n</td>\n<td>\n0.530943\n</td>\n<td>\n39\n</td>\n</tr>\n</tbody>\n</table>\n<p>\n5 rows × 44 columns\n</p>\n<div class=\"sourceCode\" id=\"cb6\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb6-1\"><a href=\"#cb6-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>air_data.dtypes</span></code></pre></div>\n<pre><code>MEMBER_NO                    int64\nFFP_DATE                    object\nFIRST_FLIGHT_DATE           object\nGENDER                      object\nFFP_TIER                     int64\nWORK_CITY                   object\nWORK_PROVINCE               object\nWORK_COUNTRY                object\nAGE                        float64\nLOAD_TIME                   object\nFLIGHT_COUNT                 int64\nBP_SUM                       int64\nEP_SUM_YR_1                  int64\nEP_SUM_YR_2                  int64\nSUM_YR_1                   float64\nSUM_YR_2                   float64\nSEG_KM_SUM                   int64\nWEIGHTED_SEG_KM            float64\nLAST_FLIGHT_DATE            object\nAVG_FLIGHT_COUNT           float64\nAVG_BP_SUM                 float64\nBEGIN_TO_FIRST               int64\nLAST_TO_END                  int64\nAVG_INTERVAL               float64\nMAX_INTERVAL                 int64\nADD_POINTS_SUM_YR_1          int64\nADD_POINTS_SUM_YR_2          int64\nEXCHANGE_COUNT               int64\navg_discount               float64\nP1Y_Flight_Count             int64\nL1Y_Flight_Count             int64\nP1Y_BP_SUM                   int64\nL1Y_BP_SUM                   int64\nEP_SUM                       int64\nADD_Point_SUM                int64\nEli_Add_Point_Sum            int64\nL1Y_ELi_Add_Points           int64\nPoints_Sum                   int64\nL1Y_Points_Sum               int64\nRation_L1Y_Flight_Count    float64\nRation_P1Y_Flight_Count    float64\nRation_P1Y_BPS             float64\nRation_L1Y_BPS             float64\nPoint_NotFlight              int64\ndtype: object</code></pre>\n<div class=\"sourceCode\" id=\"cb8\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb8-1\"><a href=\"#cb8-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>air_data.describe().T</span></code></pre></div>\n<table border=\"1\" class=\"dataframe\">\n<thead>\n<tr style=\"text-align: right;\">\n<th>\n</th>\n<th>\ncount\n</th>\n<th>\nmean\n</th>\n<th>\nstd\n</th>\n<th>\nmin\n</th>\n<th>\n25%\n</th>\n<th>\n50%\n</th>\n<th>\n75%\n</th>\n<th>\nmax\n</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<th>\nMEMBER_NO\n</th>\n<td>\n62988.0\n</td>\n<td>\n31494.500000\n</td>\n<td>\n18183.213715\n</td>\n<td>\n1.00\n</td>\n<td>\n15747.750000\n</td>\n<td>\n31494.500000\n</td>\n<td>\n47241.250000\n</td>\n<td>\n62988.000000\n</td>\n</tr>\n<tr>\n<th>\nFFP_TIER\n</th>\n<td>\n62988.0\n</td>\n<td>\n4.102162\n</td>\n<td>\n0.373856\n</td>\n<td>\n4.00\n</td>\n<td>\n4.000000\n</td>\n<td>\n4.000000\n</td>\n<td>\n4.000000\n</td>\n<td>\n6.000000\n</td>\n</tr>\n<tr>\n<th>\nAGE\n</th>\n<td>\n62568.0\n</td>\n<td>\n42.476346\n</td>\n<td>\n9.885915\n</td>\n<td>\n6.00\n</td>\n<td>\n35.000000\n</td>\n<td>\n41.000000\n</td>\n<td>\n48.000000\n</td>\n<td>\n110.000000\n</td>\n</tr>\n<tr>\n<th>\nFLIGHT_COUNT\n</th>\n<td>\n62988.0\n</td>\n<td>\n11.839414\n</td>\n<td>\n14.049471\n</td>\n<td>\n2.00\n</td>\n<td>\n3.000000\n</td>\n<td>\n7.000000\n</td>\n<td>\n15.000000\n</td>\n<td>\n213.000000\n</td>\n</tr>\n<tr>\n<th>\nBP_SUM\n</th>\n<td>\n62988.0\n</td>\n<td>\n10925.081254\n</td>\n<td>\n16339.486151\n</td>\n<td>\n0.00\n</td>\n<td>\n2518.000000\n</td>\n<td>\n5700.000000\n</td>\n<td>\n12831.000000\n</td>\n<td>\n505308.000000\n</td>\n</tr>\n<tr>\n<th>\nEP_SUM_YR_1\n</th>\n<td>\n62988.0\n</td>\n<td>\n0.000000\n</td>\n<td>\n0.000000\n</td>\n<td>\n0.00\n</td>\n<td>\n0.000000\n</td>\n<td>\n0.000000\n</td>\n<td>\n0.000000\n</td>\n<td>\n0.000000\n</td>\n</tr>\n<tr>\n<th>\nEP_SUM_YR_2\n</th>\n<td>\n62988.0\n</td>\n<td>\n265.689623\n</td>\n<td>\n1645.702854\n</td>\n<td>\n0.00\n</td>\n<td>\n0.000000\n</td>\n<td>\n0.000000\n</td>\n<td>\n0.000000\n</td>\n<td>\n74460.000000\n</td>\n</tr>\n<tr>\n<th>\nSUM_YR_1\n</th>\n<td>\n62437.0\n</td>\n<td>\n5355.376064\n</td>\n<td>\n8109.450147\n</td>\n<td>\n0.00\n</td>\n<td>\n1003.000000\n</td>\n<td>\n2800.000000\n</td>\n<td>\n6574.000000\n</td>\n<td>\n239560.000000\n</td>\n</tr>\n<tr>\n<th>\nSUM_YR_2\n</th>\n<td>\n62850.0\n</td>\n<td>\n5604.026014\n</td>\n<td>\n8703.364247\n</td>\n<td>\n0.00\n</td>\n<td>\n780.000000\n</td>\n<td>\n2773.000000\n</td>\n<td>\n6845.750000\n</td>\n<td>\n234188.000000\n</td>\n</tr>\n<tr>\n<th>\nSEG_KM_SUM\n</th>\n<td>\n62988.0\n</td>\n<td>\n17123.878691\n</td>\n<td>\n20960.844623\n</td>\n<td>\n368.00\n</td>\n<td>\n4747.000000\n</td>\n<td>\n9994.000000\n</td>\n<td>\n21271.250000\n</td>\n<td>\n580717.000000\n</td>\n</tr>\n<tr>\n<th>\nWEIGHTED_SEG_KM\n</th>\n<td>\n62988.0\n</td>\n<td>\n12777.152439\n</td>\n<td>\n17578.586695\n</td>\n<td>\n0.00\n</td>\n<td>\n3219.045000\n</td>\n<td>\n6978.255000\n</td>\n<td>\n15299.632500\n</td>\n<td>\n558440.140000\n</td>\n</tr>\n<tr>\n<th>\nAVG_FLIGHT_COUNT\n</th>\n<td>\n62988.0\n</td>\n<td>\n1.542154\n</td>\n<td>\n1.786996\n</td>\n<td>\n0.25\n</td>\n<td>\n0.428571\n</td>\n<td>\n0.875000\n</td>\n<td>\n1.875000\n</td>\n<td>\n26.625000\n</td>\n</tr>\n<tr>\n<th>\nAVG_BP_SUM\n</th>\n<td>\n62988.0\n</td>\n<td>\n1421.440249\n</td>\n<td>\n2083.121324\n</td>\n<td>\n0.00\n</td>\n<td>\n336.000000\n</td>\n<td>\n752.375000\n</td>\n<td>\n1690.270833\n</td>\n<td>\n63163.500000\n</td>\n</tr>\n<tr>\n<th>\nBEGIN_TO_FIRST\n</th>\n<td>\n62988.0\n</td>\n<td>\n120.145488\n</td>\n<td>\n159.572867\n</td>\n<td>\n0.00\n</td>\n<td>\n9.000000\n</td>\n<td>\n50.000000\n</td>\n<td>\n166.000000\n</td>\n<td>\n729.000000\n</td>\n</tr>\n<tr>\n<th>\nLAST_TO_END\n</th>\n<td>\n62988.0\n</td>\n<td>\n176.120102\n</td>\n<td>\n183.822223\n</td>\n<td>\n1.00\n</td>\n<td>\n29.000000\n</td>\n<td>\n108.000000\n</td>\n<td>\n268.000000\n</td>\n<td>\n731.000000\n</td>\n</tr>\n<tr>\n<th>\nAVG_INTERVAL\n</th>\n<td>\n62988.0\n</td>\n<td>\n67.749788\n</td>\n<td>\n77.517866\n</td>\n<td>\n0.00\n</td>\n<td>\n23.370370\n</td>\n<td>\n44.666667\n</td>\n<td>\n82.000000\n</td>\n<td>\n728.000000\n</td>\n</tr>\n<tr>\n<th>\nMAX_INTERVAL\n</th>\n<td>\n62988.0\n</td>\n<td>\n166.033895\n</td>\n<td>\n123.397180\n</td>\n<td>\n0.00\n</td>\n<td>\n79.000000\n</td>\n<td>\n143.000000\n</td>\n<td>\n228.000000\n</td>\n<td>\n728.000000\n</td>\n</tr>\n<tr>\n<th>\nADD_POINTS_SUM_YR_1\n</th>\n<td>\n62988.0\n</td>\n<td>\n540.316965\n</td>\n<td>\n3956.083455\n</td>\n<td>\n0.00\n</td>\n<td>\n0.000000\n</td>\n<td>\n0.000000\n</td>\n<td>\n0.000000\n</td>\n<td>\n600000.000000\n</td>\n</tr>\n<tr>\n<th>\nADD_POINTS_SUM_YR_2\n</th>\n<td>\n62988.0\n</td>\n<td>\n814.689258\n</td>\n<td>\n5121.796929\n</td>\n<td>\n0.00\n</td>\n<td>\n0.000000\n</td>\n<td>\n0.000000\n</td>\n<td>\n0.000000\n</td>\n<td>\n728282.000000\n</td>\n</tr>\n<tr>\n<th>\nEXCHANGE_COUNT\n</th>\n<td>\n62988.0\n</td>\n<td>\n0.319775\n</td>\n<td>\n1.136004\n</td>\n<td>\n0.00\n</td>\n<td>\n0.000000\n</td>\n<td>\n0.000000\n</td>\n<td>\n0.000000\n</td>\n<td>\n46.000000\n</td>\n</tr>\n<tr>\n<th>\navg_discount\n</th>\n<td>\n62988.0\n</td>\n<td>\n0.721558\n</td>\n<td>\n0.185427\n</td>\n<td>\n0.00\n</td>\n<td>\n0.611997\n</td>\n<td>\n0.711856\n</td>\n<td>\n0.809476\n</td>\n<td>\n1.500000\n</td>\n</tr>\n<tr>\n<th>\nP1Y_Flight_Count\n</th>\n<td>\n62988.0\n</td>\n<td>\n5.766257\n</td>\n<td>\n7.210922\n</td>\n<td>\n0.00\n</td>\n<td>\n2.000000\n</td>\n<td>\n3.000000\n</td>\n<td>\n7.000000\n</td>\n<td>\n118.000000\n</td>\n</tr>\n<tr>\n<th>\nL1Y_Flight_Count\n</th>\n<td>\n62988.0\n</td>\n<td>\n6.073157\n</td>\n<td>\n8.175127\n</td>\n<td>\n0.00\n</td>\n<td>\n1.000000\n</td>\n<td>\n3.000000\n</td>\n<td>\n8.000000\n</td>\n<td>\n111.000000\n</td>\n</tr>\n<tr>\n<th>\nP1Y_BP_SUM\n</th>\n<td>\n62988.0\n</td>\n<td>\n5366.720550\n</td>\n<td>\n8537.773021\n</td>\n<td>\n0.00\n</td>\n<td>\n946.000000\n</td>\n<td>\n2692.000000\n</td>\n<td>\n6485.250000\n</td>\n<td>\n246197.000000\n</td>\n</tr>\n<tr>\n<th>\nL1Y_BP_SUM\n</th>\n<td>\n62988.0\n</td>\n<td>\n5558.360704\n</td>\n<td>\n9351.956952\n</td>\n<td>\n0.00\n</td>\n<td>\n545.000000\n</td>\n<td>\n2547.000000\n</td>\n<td>\n6619.250000\n</td>\n<td>\n259111.000000\n</td>\n</tr>\n<tr>\n<th>\nEP_SUM\n</th>\n<td>\n62988.0\n</td>\n<td>\n265.689623\n</td>\n<td>\n1645.702854\n</td>\n<td>\n0.00\n</td>\n<td>\n0.000000\n</td>\n<td>\n0.000000\n</td>\n<td>\n0.000000\n</td>\n<td>\n74460.000000\n</td>\n</tr>\n<tr>\n<th>\nADD_Point_SUM\n</th>\n<td>\n62988.0\n</td>\n<td>\n1355.006223\n</td>\n<td>\n7868.477000\n</td>\n<td>\n0.00\n</td>\n<td>\n0.000000\n</td>\n<td>\n0.000000\n</td>\n<td>\n0.000000\n</td>\n<td>\n984938.000000\n</td>\n</tr>\n<tr>\n<th>\nEli_Add_Point_Sum\n</th>\n<td>\n62988.0\n</td>\n<td>\n1620.695847\n</td>\n<td>\n8294.398955\n</td>\n<td>\n0.00\n</td>\n<td>\n0.000000\n</td>\n<td>\n0.000000\n</td>\n<td>\n345.000000\n</td>\n<td>\n984938.000000\n</td>\n</tr>\n<tr>\n<th>\nL1Y_ELi_Add_Points\n</th>\n<td>\n62988.0\n</td>\n<td>\n1080.378882\n</td>\n<td>\n5639.857254\n</td>\n<td>\n0.00\n</td>\n<td>\n0.000000\n</td>\n<td>\n0.000000\n</td>\n<td>\n0.000000\n</td>\n<td>\n728282.000000\n</td>\n</tr>\n<tr>\n<th>\nPoints_Sum\n</th>\n<td>\n62988.0\n</td>\n<td>\n12545.777100\n</td>\n<td>\n20507.816700\n</td>\n<td>\n0.00\n</td>\n<td>\n2775.000000\n</td>\n<td>\n6328.500000\n</td>\n<td>\n14302.500000\n</td>\n<td>\n985572.000000\n</td>\n</tr>\n<tr>\n<th>\nL1Y_Points_Sum\n</th>\n<td>\n62988.0\n</td>\n<td>\n6638.739585\n</td>\n<td>\n12601.819863\n</td>\n<td>\n0.00\n</td>\n<td>\n700.000000\n</td>\n<td>\n2860.500000\n</td>\n<td>\n7500.000000\n</td>\n<td>\n728282.000000\n</td>\n</tr>\n<tr>\n<th>\nRation_L1Y_Flight_Count\n</th>\n<td>\n62988.0\n</td>\n<td>\n0.486419\n</td>\n<td>\n0.319105\n</td>\n<td>\n0.00\n</td>\n<td>\n0.250000\n</td>\n<td>\n0.500000\n</td>\n<td>\n0.711111\n</td>\n<td>\n1.000000\n</td>\n</tr>\n<tr>\n<th>\nRation_P1Y_Flight_Count\n</th>\n<td>\n62988.0\n</td>\n<td>\n0.513581\n</td>\n<td>\n0.319105\n</td>\n<td>\n0.00\n</td>\n<td>\n0.288889\n</td>\n<td>\n0.500000\n</td>\n<td>\n0.750000\n</td>\n<td>\n1.000000\n</td>\n</tr>\n<tr>\n<th>\nRation_P1Y_BPS\n</th>\n<td>\n62988.0\n</td>\n<td>\n0.522293\n</td>\n<td>\n0.339632\n</td>\n<td>\n0.00\n</td>\n<td>\n0.258150\n</td>\n<td>\n0.514252\n</td>\n<td>\n0.815091\n</td>\n<td>\n0.999989\n</td>\n</tr>\n<tr>\n<th>\nRation_L1Y_BPS\n</th>\n<td>\n62988.0\n</td>\n<td>\n0.468422\n</td>\n<td>\n0.338956\n</td>\n<td>\n0.00\n</td>\n<td>\n0.167954\n</td>\n<td>\n0.476747\n</td>\n<td>\n0.728375\n</td>\n<td>\n0.999993\n</td>\n</tr>\n<tr>\n<th>\nPoint_NotFlight\n</th>\n<td>\n62988.0\n</td>\n<td>\n2.728155\n</td>\n<td>\n7.364164\n</td>\n<td>\n0.00\n</td>\n<td>\n0.000000\n</td>\n<td>\n0.000000\n</td>\n<td>\n1.000000\n</td>\n<td>\n140.000000\n</td>\n</tr>\n</tbody>\n</table>\n<h5 id=\"判断重复值是否有重复的会员id\">判断重复值：是否有重复的会员ID</h5>\n<div class=\"sourceCode\" id=\"cb9\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb9-1\"><a href=\"#cb9-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>air_data[<span class=\"st\">&#39;MEMBER_NO&#39;</span>].duplicated()</span></code></pre></div>\n<pre><code>0        False\n1        False\n2        False\n3        False\n4        False\n         ...  \n62983    False\n62984    False\n62985    False\n62986    False\n62987    False\nName: MEMBER_NO, Length: 62988, dtype: bool</code></pre>\n<div class=\"sourceCode\" id=\"cb11\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb11-1\"><a href=\"#cb11-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>air_data[air_data[<span class=\"st\">&#39;MEMBER_NO&#39;</span>].duplicated()]</span></code></pre></div>\n<table border=\"1\" class=\"dataframe\">\n<thead>\n<tr style=\"text-align: right;\">\n<th>\n</th>\n<th>\nMEMBER_NO\n</th>\n<th>\nFFP_DATE\n</th>\n<th>\nFIRST_FLIGHT_DATE\n</th>\n<th>\nGENDER\n</th>\n<th>\nFFP_TIER\n</th>\n<th>\nWORK_CITY\n</th>\n<th>\nWORK_PROVINCE\n</th>\n<th>\nWORK_COUNTRY\n</th>\n<th>\nAGE\n</th>\n<th>\nLOAD_TIME\n</th>\n<th>\n...\n</th>\n<th>\nADD_Point_SUM\n</th>\n<th>\nEli_Add_Point_Sum\n</th>\n<th>\nL1Y_ELi_Add_Points\n</th>\n<th>\nPoints_Sum\n</th>\n<th>\nL1Y_Points_Sum\n</th>\n<th>\nRation_L1Y_Flight_Count\n</th>\n<th>\nRation_P1Y_Flight_Count\n</th>\n<th>\nRation_P1Y_BPS\n</th>\n<th>\nRation_L1Y_BPS\n</th>\n<th>\nPoint_NotFlight\n</th>\n</tr>\n</thead>\n<tbody>\n</tbody>\n</table>\n<p>\n0 rows × 44 columns\n</p>\n<div class=\"sourceCode\" id=\"cb12\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb12-1\"><a href=\"#cb12-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>air_data.isna().<span class=\"bu\">any</span>()</span></code></pre></div>\n<pre><code>MEMBER_NO                  False\nFFP_DATE                   False\nFIRST_FLIGHT_DATE          False\nGENDER                      True\nFFP_TIER                   False\nWORK_CITY                   True\nWORK_PROVINCE               True\nWORK_COUNTRY                True\nAGE                         True\nLOAD_TIME                  False\nFLIGHT_COUNT               False\nBP_SUM                     False\nEP_SUM_YR_1                False\nEP_SUM_YR_2                False\nSUM_YR_1                    True\nSUM_YR_2                    True\nSEG_KM_SUM                 False\nWEIGHTED_SEG_KM            False\nLAST_FLIGHT_DATE           False\nAVG_FLIGHT_COUNT           False\nAVG_BP_SUM                 False\nBEGIN_TO_FIRST             False\nLAST_TO_END                False\nAVG_INTERVAL               False\nMAX_INTERVAL               False\nADD_POINTS_SUM_YR_1        False\nADD_POINTS_SUM_YR_2        False\nEXCHANGE_COUNT             False\navg_discount               False\nP1Y_Flight_Count           False\nL1Y_Flight_Count           False\nP1Y_BP_SUM                 False\nL1Y_BP_SUM                 False\nEP_SUM                     False\nADD_Point_SUM              False\nEli_Add_Point_Sum          False\nL1Y_ELi_Add_Points         False\nPoints_Sum                 False\nL1Y_Points_Sum             False\nRation_L1Y_Flight_Count    False\nRation_P1Y_Flight_Count    False\nRation_P1Y_BPS             False\nRation_L1Y_BPS             False\nPoint_NotFlight            False\ndtype: bool</code></pre>\n<div class=\"sourceCode\" id=\"cb14\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb14-1\"><a href=\"#cb14-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>air_data.isnull().<span class=\"bu\">any</span>()</span></code></pre></div>\n<pre><code>MEMBER_NO                  False\nFFP_DATE                   False\nFIRST_FLIGHT_DATE          False\nGENDER                      True\nFFP_TIER                   False\nWORK_CITY                   True\nWORK_PROVINCE               True\nWORK_COUNTRY                True\nAGE                         True\nLOAD_TIME                  False\nFLIGHT_COUNT               False\nBP_SUM                     False\nEP_SUM_YR_1                False\nEP_SUM_YR_2                False\nSUM_YR_1                    True\nSUM_YR_2                    True\nSEG_KM_SUM                 False\nWEIGHTED_SEG_KM            False\nLAST_FLIGHT_DATE           False\nAVG_FLIGHT_COUNT           False\nAVG_BP_SUM                 False\nBEGIN_TO_FIRST             False\nLAST_TO_END                False\nAVG_INTERVAL               False\nMAX_INTERVAL               False\nADD_POINTS_SUM_YR_1        False\nADD_POINTS_SUM_YR_2        False\nEXCHANGE_COUNT             False\navg_discount               False\nP1Y_Flight_Count           False\nL1Y_Flight_Count           False\nP1Y_BP_SUM                 False\nL1Y_BP_SUM                 False\nEP_SUM                     False\nADD_Point_SUM              False\nEli_Add_Point_Sum          False\nL1Y_ELi_Add_Points         False\nPoints_Sum                 False\nL1Y_Points_Sum             False\nRation_L1Y_Flight_Count    False\nRation_P1Y_Flight_Count    False\nRation_P1Y_BPS             False\nRation_L1Y_BPS             False\nPoint_NotFlight            False\ndtype: bool</code></pre>\n<div class=\"sourceCode\" id=\"cb16\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb16-1\"><a href=\"#cb16-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>boolean_filter <span class=\"op\">=</span> air_data[<span class=\"st\">&#39;SUM_YR_1&#39;</span>].notnull() <span class=\"op\">&amp;</span> air_data[<span class=\"st\">&#39;SUM_YR_2&#39;</span>].notnull()</span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb17\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb17-1\"><a href=\"#cb17-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>boolean_filter</span></code></pre></div>\n<pre><code>0         True1         True2         True3         True4         True         ...  62983     True62984     True62985     True62986     True62987    FalseLength: 62988, dtype: bool</code></pre>\n<div class=\"sourceCode\" id=\"cb19\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb19-1\"><a href=\"#cb19-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>air_data <span class=\"op\">=</span> air_data[boolean_filter]</span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb20\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb20-1\"><a href=\"#cb20-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>filter1 <span class=\"op\">=</span> air_data[<span class=\"st\">&#39;SUM_YR_1&#39;</span>] <span class=\"op\">!=</span> <span class=\"dv\">0</span><span class=\"er\">filter2</span> <span class=\"op\">=</span> air_data[<span class=\"st\">&#39;SUM_YR_2&#39;</span>] <span class=\"op\">!=</span> <span class=\"dv\">0</span></span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb21\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb21-1\"><a href=\"#cb21-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>air_data <span class=\"op\">=</span> air_data[filter1 <span class=\"op\">|</span> filter2]</span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb22\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb22-1\"><a href=\"#cb22-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>air_data.shape</span></code></pre></div>\n<pre><code>(62044, 44)</code></pre>\n<h4 id=\"特征工程\">特征工程</h4>\n<h5 id=\"rfm模型\">RFM模型</h5>\n<p>对于客户价值分析的一个经典模型是 RFM 模型。</p>\n<ul>\n<li>Recency: 最近消费时间间隔。</li>\n<li>Frequency: 客户消费频率。</li>\n<li>Monetary Value: 客户总消费金额。</li>\n</ul>\n<h5 id=\"变体---lrfmc-模型\">变体 - LRFMC 模型</h5>\n<ul>\n<li>Length of Relationship: 客户关系时长，反映可能的活跃时长。</li>\n<li>Recency: 最近消费时间间隔，反映当前的活跃状态。</li>\n<li>Frequency: 客户消费频率，反映客户的忠诚度。</li>\n<li>Mileage: 客户总飞行里程，反映客户对乘机的依赖性。</li>\n<li>Coefficient of Discount:\n客户所享受的平均折扣率，侧面反映客户价值高低。</li>\n</ul>\n<div class=\"sourceCode\" id=\"cb24\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb24-1\"><a href=\"#cb24-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>load_time <span class=\"op\">=</span> datetime.datetime.strptime(<span class=\"st\">&#39;2014/03/31&#39;</span>,<span class=\"st\">&#39;%Y/%m/</span><span class=\"sc\">%d</span><span class=\"st\">&#39;</span>)</span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb25\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb25-1\"><a href=\"#cb25-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>load_time</span></code></pre></div>\n<pre><code>datetime.datetime(2014, 3, 31, 0, 0)</code></pre>\n<div class=\"sourceCode\" id=\"cb27\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb27-1\"><a href=\"#cb27-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>ffp_dates <span class=\"op\">=</span> [datetime.datetime.strptime(ffp_date,<span class=\"st\">&#39;%Y/%m/</span><span class=\"sc\">%d</span><span class=\"st\">&#39;</span>) <span class=\"cf\">for</span> ffp_date <span class=\"kw\">in</span> air_data[<span class=\"st\">&#39;FFP_DATE&#39;</span>]]</span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb28\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb28-1\"><a href=\"#cb28-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>length_of_relationship  <span class=\"op\">=</span> [(load_time<span class=\"op\">-</span>ffp_date).days <span class=\"cf\">for</span> ffp_date <span class=\"kw\">in</span> ffp_dates]</span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb29\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb29-1\"><a href=\"#cb29-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>air_data[<span class=\"st\">&#39;LEN_REL&#39;</span>] <span class=\"op\">=</span> length_of_relationship</span></code></pre></div>\n<h5 id=\"移除非重要列-只保留lrfmc模型所需的属性\">移除非重要列，\n只保留LRFMC模型所需的属性</h5>\n<div class=\"sourceCode\" id=\"cb30\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb30-1\"><a href=\"#cb30-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>features <span class=\"op\">=</span> [<span class=\"st\">&#39;LEN_REL&#39;</span>,<span class=\"st\">&#39;FLIGHT_COUNT&#39;</span>,<span class=\"st\">&#39;avg_discount&#39;</span>,<span class=\"st\">&#39;SEG_KM_SUM&#39;</span>,<span class=\"st\">&#39;LAST_TO_END&#39;</span>]</span>\n<span id=\"cb30-2\"><a href=\"#cb30-2\" aria-hidden=\"true\" tabindex=\"-1\"></a>data <span class=\"op\">=</span> air_data[features]</span>\n<span id=\"cb30-3\"><a href=\"#cb30-3\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb30-4\"><a href=\"#cb30-4\" aria-hidden=\"true\" tabindex=\"-1\"></a>features <span class=\"op\">=</span> [<span class=\"st\">&#39;L&#39;</span>,<span class=\"st\">&#39;F&#39;</span>,<span class=\"st\">&#39;C&#39;</span>,<span class=\"st\">&#39;M&#39;</span>,<span class=\"st\">&#39;R&#39;</span>]</span>\n<span id=\"cb30-5\"><a href=\"#cb30-5\" aria-hidden=\"true\" tabindex=\"-1\"></a>data.columns <span class=\"op\">=</span> features</span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb31\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb31-1\"><a href=\"#cb31-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>data.shape</span></code></pre></div>\n<pre><code>(62044, 5)</code></pre>\n<div class=\"sourceCode\" id=\"cb33\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb33-1\"><a href=\"#cb33-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>data.head()</span></code></pre></div>\n<table border=\"1\" class=\"dataframe\">\n<thead>\n<tr style=\"text-align: right;\">\n<th>\n</th>\n<th>\nL\n</th>\n<th>\nF\n</th>\n<th>\nC\n</th>\n<th>\nM\n</th>\n<th>\nR\n</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<th>\n0\n</th>\n<td>\n2706\n</td>\n<td>\n210\n</td>\n<td>\n0.961639\n</td>\n<td>\n580717\n</td>\n<td>\n1\n</td>\n</tr>\n<tr>\n<th>\n1\n</th>\n<td>\n2597\n</td>\n<td>\n140\n</td>\n<td>\n1.252314\n</td>\n<td>\n293678\n</td>\n<td>\n7\n</td>\n</tr>\n<tr>\n<th>\n2\n</th>\n<td>\n2615\n</td>\n<td>\n135\n</td>\n<td>\n1.254676\n</td>\n<td>\n283712\n</td>\n<td>\n11\n</td>\n</tr>\n<tr>\n<th>\n3\n</th>\n<td>\n2047\n</td>\n<td>\n23\n</td>\n<td>\n1.090870\n</td>\n<td>\n281336\n</td>\n<td>\n97\n</td>\n</tr>\n<tr>\n<th>\n4\n</th>\n<td>\n1816\n</td>\n<td>\n152\n</td>\n<td>\n0.970658\n</td>\n<td>\n309928\n</td>\n<td>\n5\n</td>\n</tr>\n</tbody>\n</table>\n<div class=\"sourceCode\" id=\"cb34\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb34-1\"><a href=\"#cb34-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>data.describe().T</span></code></pre></div>\n<table border=\"1\" class=\"dataframe\">\n<thead>\n<tr style=\"text-align: right;\">\n<th>\n</th>\n<th>\ncount\n</th>\n<th>\nmean\n</th>\n<th>\nstd\n</th>\n<th>\nmin\n</th>\n<th>\n25%\n</th>\n<th>\n50%\n</th>\n<th>\n75%\n</th>\n<th>\nmax\n</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<th>\nL\n</th>\n<td>\n62044.0\n</td>\n<td>\n1488.691090\n</td>\n<td>\n847.880920\n</td>\n<td>\n365.000000\n</td>\n<td>\n735.000000\n</td>\n<td>\n1278.000000\n</td>\n<td>\n2182.000000\n</td>\n<td>\n3437.0\n</td>\n</tr>\n<tr>\n<th>\nF\n</th>\n<td>\n62044.0\n</td>\n<td>\n11.971359\n</td>\n<td>\n14.110619\n</td>\n<td>\n2.000000\n</td>\n<td>\n3.000000\n</td>\n<td>\n7.000000\n</td>\n<td>\n15.000000\n</td>\n<td>\n213.0\n</td>\n</tr>\n<tr>\n<th>\nC\n</th>\n<td>\n62044.0\n</td>\n<td>\n0.722180\n</td>\n<td>\n0.184833\n</td>\n<td>\n0.136017\n</td>\n<td>\n0.613085\n</td>\n<td>\n0.712162\n</td>\n<td>\n0.809293\n</td>\n<td>\n1.5\n</td>\n</tr>\n<tr>\n<th>\nM\n</th>\n<td>\n62044.0\n</td>\n<td>\n17321.694749\n</td>\n<td>\n21052.728111\n</td>\n<td>\n368.000000\n</td>\n<td>\n4874.000000\n</td>\n<td>\n10200.000000\n</td>\n<td>\n21522.500000\n</td>\n<td>\n580717.0\n</td>\n</tr>\n<tr>\n<th>\nR\n</th>\n<td>\n62044.0\n</td>\n<td>\n172.532703\n</td>\n<td>\n181.526164\n</td>\n<td>\n1.000000\n</td>\n<td>\n29.000000\n</td>\n<td>\n105.000000\n</td>\n<td>\n260.000000\n</td>\n<td>\n731.0\n</td>\n</tr>\n</tbody>\n</table>\n\n<h3 id=\"标准化\">标准化</h3>\n<p>让不同属性的取值范围一致，即数据的标准化。标准化方法有极大极小标准化、标准差标准化等方法。</p>\n<ul>\n<li>对特征标准化，使得各特征的均值为0、方差为1</li>\n</ul>\n<div class=\"sourceCode\" id=\"cb35\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb35-1\"><a href=\"#cb35-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>((data <span class=\"op\">-</span>data.mean(axis<span class=\"op\">=</span><span class=\"dv\">0</span>)) <span class=\"op\">/</span>data.std(axis<span class=\"op\">=</span><span class=\"dv\">0</span>)).describe().T</span></code></pre></div>\n<table border=\"1\" class=\"dataframe\">\n<thead>\n<tr style=\"text-align: right;\">\n<th>\n</th>\n<th>\ncount\n</th>\n<th>\nmean\n</th>\n<th>\nstd\n</th>\n<th>\nmin\n</th>\n<th>\n25%\n</th>\n<th>\n50%\n</th>\n<th>\n75%\n</th>\n<th>\nmax\n</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<th>\nL\n</th>\n<td>\n62044.0\n</td>\n<td>\n1.117739e-16\n</td>\n<td>\n1.0\n</td>\n<td>\n-1.325294\n</td>\n<td>\n-0.888911\n</td>\n<td>\n-0.248491\n</td>\n<td>\n0.817696\n</td>\n<td>\n2.297857\n</td>\n</tr>\n<tr>\n<th>\nF\n</th>\n<td>\n62044.0\n</td>\n<td>\n3.664717e-17\n</td>\n<td>\n1.0\n</td>\n<td>\n-0.706656\n</td>\n<td>\n-0.635788\n</td>\n<td>\n-0.352313\n</td>\n<td>\n0.214636\n</td>\n<td>\n14.246621\n</td>\n</tr>\n<tr>\n<th>\nC\n</th>\n<td>\n62044.0\n</td>\n<td>\n4.251071e-16\n</td>\n<td>\n1.0\n</td>\n<td>\n-3.171310\n</td>\n<td>\n-0.590233\n</td>\n<td>\n-0.054199\n</td>\n<td>\n0.471304\n</td>\n<td>\n4.208225\n</td>\n</tr>\n<tr>\n<th>\nM\n</th>\n<td>\n62044.0\n</td>\n<td>\n-5.863547e-17\n</td>\n<td>\n1.0\n</td>\n<td>\n-0.805297\n</td>\n<td>\n-0.591263\n</td>\n<td>\n-0.338279\n</td>\n<td>\n0.199537\n</td>\n<td>\n26.761154\n</td>\n</tr>\n<tr>\n<th>\nR\n</th>\n<td>\n62044.0\n</td>\n<td>\n1.465887e-16\n</td>\n<td>\n1.0\n</td>\n<td>\n-0.944948\n</td>\n<td>\n-0.790700\n</td>\n<td>\n-0.372027\n</td>\n<td>\n0.481844\n</td>\n<td>\n3.076511\n</td>\n</tr>\n</tbody>\n</table>\n<div class=\"sourceCode\" id=\"cb36\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb36-1\"><a href=\"#cb36-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>ss <span class=\"op\">=</span> sklearn.preprocessing.StandardScaler(with_mean<span class=\"op\">=</span><span class=\"va\">True</span>,with_std<span class=\"op\">=</span><span class=\"va\">True</span>)</span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb37\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb37-1\"><a href=\"#cb37-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>data <span class=\"op\">=</span> ss.fit_transform(data)</span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb38\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb38-1\"><a href=\"#cb38-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>data</span></code></pre></div>\n<pre><code>array([[ 1.43571897, 14.03412875,  1.29555058, 26.76136996, -0.94495516],       [ 1.30716214,  9.07328567,  2.86819902, 13.1269701 , -0.9119018 ],       [ 1.32839171,  8.71893974,  2.88097321, 12.65358345, -0.88986623],       ...,       [-0.14942206, -0.70666211, -2.68990622, -0.77233818, -0.73561725],       [-1.20618274, -0.70666211, -2.55464809, -0.77984321,  1.6056619 ],       [-0.47965977, -0.70666211, -2.39233833, -0.78668323,  0.60304353]])</code></pre>\n<div class=\"sourceCode\" id=\"cb40\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb40-1\"><a href=\"#cb40-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>data <span class=\"op\">=</span> pd.DataFrame(data,columns<span class=\"op\">=</span>features)</span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb41\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb41-1\"><a href=\"#cb41-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>data.head()</span></code></pre></div>\n<table border=\"1\" class=\"dataframe\">\n<thead>\n<tr style=\"text-align: right;\">\n<th>\n</th>\n<th>\nL\n</th>\n<th>\nF\n</th>\n<th>\nC\n</th>\n<th>\nM\n</th>\n<th>\nR\n</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<th>\n0\n</th>\n<td>\n1.435719\n</td>\n<td>\n14.034129\n</td>\n<td>\n1.295551\n</td>\n<td>\n26.761370\n</td>\n<td>\n-0.944955\n</td>\n</tr>\n<tr>\n<th>\n1\n</th>\n<td>\n1.307162\n</td>\n<td>\n9.073286\n</td>\n<td>\n2.868199\n</td>\n<td>\n13.126970\n</td>\n<td>\n-0.911902\n</td>\n</tr>\n<tr>\n<th>\n2\n</th>\n<td>\n1.328392\n</td>\n<td>\n8.718940\n</td>\n<td>\n2.880973\n</td>\n<td>\n12.653583\n</td>\n<td>\n-0.889866\n</td>\n</tr>\n<tr>\n<th>\n3\n</th>\n<td>\n0.658481\n</td>\n<td>\n0.781591\n</td>\n<td>\n1.994730\n</td>\n<td>\n12.540723\n</td>\n<td>\n-0.416102\n</td>\n</tr>\n<tr>\n<th>\n4\n</th>\n<td>\n0.386035\n</td>\n<td>\n9.923716\n</td>\n<td>\n1.344346\n</td>\n<td>\n13.898848\n</td>\n<td>\n-0.922920\n</td>\n</tr>\n</tbody>\n</table>\n<div class=\"sourceCode\" id=\"cb42\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb42-1\"><a href=\"#cb42-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>data_db <span class=\"op\">=</span> data.copy()</span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb43\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb43-1\"><a href=\"#cb43-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>data_db.describe().T</span></code></pre></div>\n<table border=\"1\" class=\"dataframe\">\n<thead>\n<tr style=\"text-align: right;\">\n<th>\n</th>\n<th>\ncount\n</th>\n<th>\nmean\n</th>\n<th>\nstd\n</th>\n<th>\nmin\n</th>\n<th>\n25%\n</th>\n<th>\n50%\n</th>\n<th>\n75%\n</th>\n<th>\nmax\n</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<th>\nL\n</th>\n<td>\n62044.0\n</td>\n<td>\n1.246004e-16\n</td>\n<td>\n1.000008\n</td>\n<td>\n-1.325304\n</td>\n<td>\n-0.888919\n</td>\n<td>\n-0.248493\n</td>\n<td>\n0.817703\n</td>\n<td>\n2.297875\n</td>\n</tr>\n<tr>\n<th>\nF\n</th>\n<td>\n62044.0\n</td>\n<td>\n5.863547e-17\n</td>\n<td>\n1.000008\n</td>\n<td>\n-0.706662\n</td>\n<td>\n-0.635793\n</td>\n<td>\n-0.352316\n</td>\n<td>\n0.214637\n</td>\n<td>\n14.246736\n</td>\n</tr>\n<tr>\n<th>\nC\n</th>\n<td>\n62044.0\n</td>\n<td>\n3.957894e-16\n</td>\n<td>\n1.000008\n</td>\n<td>\n-3.171335\n</td>\n<td>\n-0.590238\n</td>\n<td>\n-0.054200\n</td>\n<td>\n0.471308\n</td>\n<td>\n4.208258\n</td>\n</tr>\n<tr>\n<th>\nM\n</th>\n<td>\n62044.0\n</td>\n<td>\n-1.026121e-16\n</td>\n<td>\n1.000008\n</td>\n<td>\n-0.805303\n</td>\n<td>\n-0.591268\n</td>\n<td>\n-0.338282\n</td>\n<td>\n0.199539\n</td>\n<td>\n26.761370\n</td>\n</tr>\n<tr>\n<th>\nR\n</th>\n<td>\n62044.0\n</td>\n<td>\n4.397660e-17\n</td>\n<td>\n1.000008\n</td>\n<td>\n-0.944955\n</td>\n<td>\n-0.790706\n</td>\n<td>\n-0.372030\n</td>\n<td>\n0.481848\n</td>\n<td>\n3.076536\n</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"模型训练与-数据的预测\">模型训练与 数据的预测</h3>\n<p>将客户群体细分为重要保持客户、重要发展客户、重要挽留客户、一般客户、低价值客户五类</p>\n<h4 id=\"k-means聚类算法\">K-means聚类算法</h4>\n<ul>\n<li>目标是把 <span class=\"math inline\">\\(n\\)</span> 个观测样本划分成\n<span class=\"math inline\">\\(k\\)</span>\n个群体（cluster），每个群体都有一个中心（mean）。</li>\n<li>每个样本仅属于其中一个群体，即与这个样本距离最近的中心的群体。</li>\n<li>符号: <span class=\"math inline\">\\(S_{i}\\)</span> 是一个群体, <span class=\"math inline\">\\(m_{i}\\)</span> 是群体 <span class=\"math inline\">\\(S_{i}\\)</span> 里的样本的中心, <span class=\"math inline\">\\(x_{i}\\)</span> 是一个样本点。</li>\n<li>Assignment step (expectation step):\n把每个样本分配给距离最近的中心的群体</li>\n<li>Update step (maximization step):\n根据当前的样本及其所属群体，重新计算各群体的中心</li>\n</ul>\n<div class=\"sourceCode\" id=\"cb44\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb44-1\"><a href=\"#cb44-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>num_clusters <span class=\"op\">=</span> <span class=\"dv\">5</span>  <span class=\"co\"># 设置类别为5</span></span>\n<span id=\"cb44-2\"><a href=\"#cb44-2\" aria-hidden=\"true\" tabindex=\"-1\"></a>km <span class=\"op\">=</span> sklearn.cluster.KMeans(n_clusters<span class=\"op\">=</span>num_clusters, n_jobs<span class=\"op\">=</span><span class=\"dv\">4</span>)  <span class=\"co\">#模型加载</span></span>\n<span id=\"cb44-3\"><a href=\"#cb44-3\" aria-hidden=\"true\" tabindex=\"-1\"></a>km.fit(data) <span class=\"co\"># 模型训练</span></span></code></pre></div>\n<pre><code>/Users/gaozhiyong/Documents/pyenv/pyenv3.6/lib/python3.6/site-packages/sklearn/cluster/_kmeans.py:793: FutureWarning: &#39;n_jobs&#39; was deprecated in version 0.23 and will be removed in 1.0 (renaming of 0.25).\n  &quot; removed in 1.0 (renaming of 0.25).&quot;, FutureWarning)\n\nKMeans(n_clusters=5, n_jobs=4)</code></pre>\n<div class=\"sourceCode\" id=\"cb46\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb46-1\"><a href=\"#cb46-1\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"co\"># 查看模型学习出来的5个群体的中心， 以及5哥群体所包含的样本个数</span></span>\n<span id=\"cb46-2\"><a href=\"#cb46-2\" aria-hidden=\"true\" tabindex=\"-1\"></a>r1 <span class=\"op\">=</span> pd.Series(km.labels_).value_counts()</span>\n<span id=\"cb46-3\"><a href=\"#cb46-3\" aria-hidden=\"true\" tabindex=\"-1\"></a>r2 <span class=\"op\">=</span> pd.DataFrame(km.cluster_centers_)</span>\n<span id=\"cb46-4\"><a href=\"#cb46-4\" aria-hidden=\"true\" tabindex=\"-1\"></a>r <span class=\"op\">=</span> pd.concat([r2,r1],axis<span class=\"op\">=</span><span class=\"dv\">1</span>)</span>\n<span id=\"cb46-5\"><a href=\"#cb46-5\" aria-hidden=\"true\" tabindex=\"-1\"></a>r.columns <span class=\"op\">=</span> <span class=\"bu\">list</span>(data.columns) <span class=\"op\">+</span> [<span class=\"st\">&#39;counts&#39;</span>]</span>\n<span id=\"cb46-6\"><a href=\"#cb46-6\" aria-hidden=\"true\" tabindex=\"-1\"></a>r</span></code></pre></div>\n<table border=\"1\" class=\"dataframe\">\n<thead>\n<tr style=\"text-align: right;\">\n<th>\n</th>\n<th>\nL\n</th>\n<th>\nF\n</th>\n<th>\nC\n</th>\n<th>\nM\n</th>\n<th>\nR\n</th>\n<th>\ncounts\n</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<th>\n0\n</th>\n<td>\n0.482004\n</td>\n<td>\n2.478716\n</td>\n<td>\n0.298630\n</td>\n<td>\n2.420403\n</td>\n<td>\n-0.798959\n</td>\n<td>\n5338\n</td>\n</tr>\n<tr>\n<th>\n1\n</th>\n<td>\n1.155203\n</td>\n<td>\n-0.091881\n</td>\n<td>\n-0.150515\n</td>\n<td>\n-0.099938\n</td>\n<td>\n-0.373781\n</td>\n<td>\n15858\n</td>\n</tr>\n<tr>\n<th>\n2\n</th>\n<td>\n0.110721\n</td>\n<td>\n-0.189617\n</td>\n<td>\n2.353276\n</td>\n<td>\n-0.185116\n</td>\n<td>\n-0.015167\n</td>\n<td>\n3684\n</td>\n</tr>\n<tr>\n<th>\n3\n</th>\n<td>\n-0.700396\n</td>\n<td>\n-0.164828\n</td>\n<td>\n-0.234397\n</td>\n<td>\n-0.165888\n</td>\n<td>\n-0.410842\n</td>\n<td>\n24970\n</td>\n</tr>\n<tr>\n<th>\n4\n</th>\n<td>\n-0.315083\n</td>\n<td>\n-0.574115\n</td>\n<td>\n-0.162570\n</td>\n<td>\n-0.537185\n</td>\n<td>\n1.684579\n</td>\n<td>\n12194\n</td>\n</tr>\n</tbody>\n</table>\n<div class=\"sourceCode\" id=\"cb47\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb47-1\"><a href=\"#cb47-1\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"co\"># 查看模型对每个样本预测的群体标签</span></span>\n<span id=\"cb47-2\"><a href=\"#cb47-2\" aria-hidden=\"true\" tabindex=\"-1\"></a>km.labels_</span></code></pre></div>\n<pre><code>array([0, 0, 0, ..., 3, 4, 4], dtype=int32)</code></pre>\n<h4 id=\"尝试使用rfm模型\">尝试使用RFM模型</h4>\n<div class=\"sourceCode\" id=\"cb49\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb49-1\"><a href=\"#cb49-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>data_rfm <span class=\"op\">=</span> data[[<span class=\"st\">&#39;R&#39;</span>,<span class=\"st\">&#39;F&#39;</span>,<span class=\"st\">&#39;M&#39;</span>]]</span>\n<span id=\"cb49-2\"><a href=\"#cb49-2\" aria-hidden=\"true\" tabindex=\"-1\"></a>data_rfm.head()</span></code></pre></div>\n<table border=\"1\" class=\"dataframe\">\n<thead>\n<tr style=\"text-align: right;\">\n<th>\n</th>\n<th>\nR\n</th>\n<th>\nF\n</th>\n<th>\nM\n</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<th>\n0\n</th>\n<td>\n-0.944955\n</td>\n<td>\n14.034129\n</td>\n<td>\n26.761370\n</td>\n</tr>\n<tr>\n<th>\n1\n</th>\n<td>\n-0.911902\n</td>\n<td>\n9.073286\n</td>\n<td>\n13.126970\n</td>\n</tr>\n<tr>\n<th>\n2\n</th>\n<td>\n-0.889866\n</td>\n<td>\n8.718940\n</td>\n<td>\n12.653583\n</td>\n</tr>\n<tr>\n<th>\n3\n</th>\n<td>\n-0.416102\n</td>\n<td>\n0.781591\n</td>\n<td>\n12.540723\n</td>\n</tr>\n<tr>\n<th>\n4\n</th>\n<td>\n-0.922920\n</td>\n<td>\n9.923716\n</td>\n<td>\n13.898848\n</td>\n</tr>\n</tbody>\n</table>\n<div class=\"sourceCode\" id=\"cb50\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb50-1\"><a href=\"#cb50-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>km.fit(data_rfm) <span class=\"co\"># 模型对 只包含rfm数据集训练</span></span></code></pre></div>\n<pre><code>/Users/gaozhiyong/Documents/pyenv/pyenv3.6/lib/python3.6/site-packages/sklearn/cluster/_kmeans.py:793: FutureWarning: &#39;n_jobs&#39; was deprecated in version 0.23 and will be removed in 1.0 (renaming of 0.25).\n  &quot; removed in 1.0 (renaming of 0.25).&quot;, FutureWarning)\n\nKMeans(n_clusters=5, n_jobs=4)</code></pre>\n<div class=\"sourceCode\" id=\"cb52\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb52-1\"><a href=\"#cb52-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>km.labels_</span></code></pre></div>\n<pre><code>array([3, 3, 3, ..., 2, 1, 2], dtype=int32)</code></pre>\n<div class=\"sourceCode\" id=\"cb54\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb54-1\"><a href=\"#cb54-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>r1 <span class=\"op\">=</span> pd.Series(km.labels_).value_counts()</span>\n<span id=\"cb54-2\"><a href=\"#cb54-2\" aria-hidden=\"true\" tabindex=\"-1\"></a>r2 <span class=\"op\">=</span> pd.DataFrame(km.cluster_centers_)</span>\n<span id=\"cb54-3\"><a href=\"#cb54-3\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb54-4\"><a href=\"#cb54-4\" aria-hidden=\"true\" tabindex=\"-1\"></a>rr <span class=\"op\">=</span> pd.concat([r2,r1],axis<span class=\"op\">=</span><span class=\"dv\">1</span>)</span>\n<span id=\"cb54-5\"><a href=\"#cb54-5\" aria-hidden=\"true\" tabindex=\"-1\"></a>rr <span class=\"op\">=</span> pd.DataFrame(ss.fit_transform(rr))</span>\n<span id=\"cb54-6\"><a href=\"#cb54-6\" aria-hidden=\"true\" tabindex=\"-1\"></a>rr.columns <span class=\"op\">=</span> <span class=\"bu\">list</span>(data_rfm.columns) <span class=\"op\">+</span> [<span class=\"st\">&#39;counts&#39;</span>]</span>\n<span id=\"cb54-7\"><a href=\"#cb54-7\" aria-hidden=\"true\" tabindex=\"-1\"></a>rr</span></code></pre></div>\n<table border=\"1\" class=\"dataframe\">\n<thead>\n<tr style=\"text-align: right;\">\n<th>\n</th>\n<th>\nR\n</th>\n<th>\nF\n</th>\n<th>\nM\n</th>\n<th>\ncounts\n</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<th>\n0\n</th>\n<td>\n-0.475915\n</td>\n<td>\n-0.389200\n</td>\n<td>\n-0.395668\n</td>\n<td>\n0.146242\n</td>\n</tr>\n<tr>\n<th>\n1\n</th>\n<td>\n1.958565\n</td>\n<td>\n-0.918959\n</td>\n<td>\n-0.893438\n</td>\n<td>\n0.118661\n</td>\n</tr>\n<tr>\n<th>\n2\n</th>\n<td>\n-0.129480\n</td>\n<td>\n-0.846644\n</td>\n<td>\n-0.841995\n</td>\n<td>\n1.712033\n</td>\n</tr>\n<tr>\n<th>\n3\n</th>\n<td>\n-0.727717\n</td>\n<td>\n1.772255\n</td>\n<td>\n1.795436\n</td>\n<td>\n-1.187639\n</td>\n</tr>\n<tr>\n<th>\n4\n</th>\n<td>\n-0.625453\n</td>\n<td>\n0.382548\n</td>\n<td>\n0.335664\n</td>\n<td>\n-0.789296\n</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"分析与决策\">分析与决策</h4>\n<p>使用雷达图对模型学习出的5个群体特征进行可视化分析</p>\n<div class=\"sourceCode\" id=\"cb55\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb55-1\"><a href=\"#cb55-1\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"im\">import</span> numpy <span class=\"im\">as</span> np</span>\n<span id=\"cb55-2\"><a href=\"#cb55-2\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"im\">import</span> matplotlib.pyplot <span class=\"im\">as</span> plt</span>\n<span id=\"cb55-3\"><a href=\"#cb55-3\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"im\">from</span> matplotlib.patches <span class=\"im\">import</span> Circle,RegularPolygon</span>\n<span id=\"cb55-4\"><a href=\"#cb55-4\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"im\">from</span> matplotlib.path <span class=\"im\">import</span> Path</span>\n<span id=\"cb55-5\"><a href=\"#cb55-5\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"im\">from</span> matplotlib.projections.polar <span class=\"im\">import</span> PolarAxes</span>\n<span id=\"cb55-6\"><a href=\"#cb55-6\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"im\">from</span> matplotlib.projections <span class=\"im\">import</span> register_projection</span>\n<span id=\"cb55-7\"><a href=\"#cb55-7\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"im\">from</span> matplotlib.spines <span class=\"im\">import</span> Spine</span>\n<span id=\"cb55-8\"><a href=\"#cb55-8\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"im\">from</span> matplotlib.transforms <span class=\"im\">import</span> Affine2D</span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb56\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb56-1\"><a href=\"#cb56-1\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"kw\">def</span> radar_factory(num_vars,frame<span class=\"op\">=</span><span class=\"st\">&#39;circle&#39;</span>):</span>\n<span id=\"cb56-2\"><a href=\"#cb56-2\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"co\"># 计算得到 evenly-spaced axis angles</span></span>\n<span id=\"cb56-3\"><a href=\"#cb56-3\" aria-hidden=\"true\" tabindex=\"-1\"></a>    theta <span class=\"op\">=</span> np.linspace(<span class=\"dv\">0</span>,<span class=\"dv\">2</span><span class=\"op\">*</span>np.pi, num_vars, endpoint<span class=\"op\">=</span><span class=\"va\">False</span>)</span>\n<span id=\"cb56-4\"><a href=\"#cb56-4\" aria-hidden=\"true\" tabindex=\"-1\"></a>    </span>\n<span id=\"cb56-5\"><a href=\"#cb56-5\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"kw\">class</span> RadarAxes(PolarAxes):</span>\n<span id=\"cb56-6\"><a href=\"#cb56-6\" aria-hidden=\"true\" tabindex=\"-1\"></a>        name<span class=\"op\">=</span> <span class=\"st\">&#39;radar&#39;</span></span>\n<span id=\"cb56-7\"><a href=\"#cb56-7\" aria-hidden=\"true\" tabindex=\"-1\"></a>        <span class=\"co\"># 使用1条线段连接指定点</span></span>\n<span id=\"cb56-8\"><a href=\"#cb56-8\" aria-hidden=\"true\" tabindex=\"-1\"></a>        RESOLUTION <span class=\"op\">=</span> <span class=\"dv\">1</span></span>\n<span id=\"cb56-9\"><a href=\"#cb56-9\" aria-hidden=\"true\" tabindex=\"-1\"></a>        </span>\n<span id=\"cb56-10\"><a href=\"#cb56-10\" aria-hidden=\"true\" tabindex=\"-1\"></a>        <span class=\"kw\">def</span> <span class=\"fu\">__init__</span>(<span class=\"va\">self</span>,<span class=\"op\">*</span>args,<span class=\"op\">**</span>kwargs):</span>\n<span id=\"cb56-11\"><a href=\"#cb56-11\" aria-hidden=\"true\" tabindex=\"-1\"></a>            <span class=\"bu\">super</span>().<span class=\"fu\">__init__</span>(<span class=\"op\">*</span>args,<span class=\"op\">**</span>kwargs)</span>\n<span id=\"cb56-12\"><a href=\"#cb56-12\" aria-hidden=\"true\" tabindex=\"-1\"></a>            <span class=\"co\"># 旋转绘图，使第一个轴位于顶部</span></span>\n<span id=\"cb56-13\"><a href=\"#cb56-13\" aria-hidden=\"true\" tabindex=\"-1\"></a>            <span class=\"va\">self</span>.set_theta_zero_location(<span class=\"st\">&#39;N&#39;</span>)</span>\n<span id=\"cb56-14\"><a href=\"#cb56-14\" aria-hidden=\"true\" tabindex=\"-1\"></a>            </span>\n<span id=\"cb56-15\"><a href=\"#cb56-15\" aria-hidden=\"true\" tabindex=\"-1\"></a>        <span class=\"kw\">def</span> fill(<span class=\"va\">self</span>, <span class=\"op\">*</span>args, closed<span class=\"op\">=</span><span class=\"va\">True</span>, <span class=\"op\">**</span>kwargs):</span>\n<span id=\"cb56-16\"><a href=\"#cb56-16\" aria-hidden=\"true\" tabindex=\"-1\"></a>            <span class=\"co\">&quot;&quot;&quot;覆盖填充，以便默认情况下关闭该行&quot;&quot;&quot;</span></span>\n<span id=\"cb56-17\"><a href=\"#cb56-17\" aria-hidden=\"true\" tabindex=\"-1\"></a>            <span class=\"cf\">return</span> <span class=\"bu\">super</span>().fill(closed<span class=\"op\">=</span>closed, <span class=\"op\">*</span>args, <span class=\"op\">**</span>kwargs)</span>\n<span id=\"cb56-18\"><a href=\"#cb56-18\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb56-19\"><a href=\"#cb56-19\" aria-hidden=\"true\" tabindex=\"-1\"></a>        <span class=\"kw\">def</span> plot(<span class=\"va\">self</span>, <span class=\"op\">*</span>args, <span class=\"op\">**</span>kwargs):</span>\n<span id=\"cb56-20\"><a href=\"#cb56-20\" aria-hidden=\"true\" tabindex=\"-1\"></a>            <span class=\"co\">&quot;&quot;&quot;覆盖填充，以便默认情况下关闭该行&quot;&quot;&quot;</span></span>\n<span id=\"cb56-21\"><a href=\"#cb56-21\" aria-hidden=\"true\" tabindex=\"-1\"></a>            lines <span class=\"op\">=</span> <span class=\"bu\">super</span>().plot(<span class=\"op\">*</span>args, <span class=\"op\">**</span>kwargs)</span>\n<span id=\"cb56-22\"><a href=\"#cb56-22\" aria-hidden=\"true\" tabindex=\"-1\"></a>            <span class=\"cf\">for</span> line <span class=\"kw\">in</span> lines:</span>\n<span id=\"cb56-23\"><a href=\"#cb56-23\" aria-hidden=\"true\" tabindex=\"-1\"></a>                <span class=\"va\">self</span>._close_line(line)</span>\n<span id=\"cb56-24\"><a href=\"#cb56-24\" aria-hidden=\"true\" tabindex=\"-1\"></a>                </span>\n<span id=\"cb56-25\"><a href=\"#cb56-25\" aria-hidden=\"true\" tabindex=\"-1\"></a>        <span class=\"kw\">def</span> _close_line(<span class=\"va\">self</span>, line):</span>\n<span id=\"cb56-26\"><a href=\"#cb56-26\" aria-hidden=\"true\" tabindex=\"-1\"></a>            x, y <span class=\"op\">=</span> line.get_data()</span>\n<span id=\"cb56-27\"><a href=\"#cb56-27\" aria-hidden=\"true\" tabindex=\"-1\"></a>            <span class=\"co\"># </span><span class=\"al\">FIXME</span><span class=\"co\">: x[0], y[0] 处的标记加倍</span></span>\n<span id=\"cb56-28\"><a href=\"#cb56-28\" aria-hidden=\"true\" tabindex=\"-1\"></a>            <span class=\"cf\">if</span> x[<span class=\"dv\">0</span>] <span class=\"op\">!=</span> x[<span class=\"op\">-</span><span class=\"dv\">1</span>]:</span>\n<span id=\"cb56-29\"><a href=\"#cb56-29\" aria-hidden=\"true\" tabindex=\"-1\"></a>                x <span class=\"op\">=</span> np.concatenate((x, [x[<span class=\"dv\">0</span>]]))</span>\n<span id=\"cb56-30\"><a href=\"#cb56-30\" aria-hidden=\"true\" tabindex=\"-1\"></a>                y <span class=\"op\">=</span> np.concatenate((y, [y[<span class=\"dv\">0</span>]]))</span>\n<span id=\"cb56-31\"><a href=\"#cb56-31\" aria-hidden=\"true\" tabindex=\"-1\"></a>                line.set_data(x, y)</span>\n<span id=\"cb56-32\"><a href=\"#cb56-32\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb56-33\"><a href=\"#cb56-33\" aria-hidden=\"true\" tabindex=\"-1\"></a>        <span class=\"kw\">def</span> set_varlabels(<span class=\"va\">self</span>, labels):</span>\n<span id=\"cb56-34\"><a href=\"#cb56-34\" aria-hidden=\"true\" tabindex=\"-1\"></a>            <span class=\"va\">self</span>.set_thetagrids(np.degrees(theta), labels)</span>\n<span id=\"cb56-35\"><a href=\"#cb56-35\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb56-36\"><a href=\"#cb56-36\" aria-hidden=\"true\" tabindex=\"-1\"></a>        <span class=\"kw\">def</span> _gen_axes_patch(<span class=\"va\">self</span>):</span>\n<span id=\"cb56-37\"><a href=\"#cb56-37\" aria-hidden=\"true\" tabindex=\"-1\"></a>            <span class=\"co\"># 轴必须以（0.5，0.5）为中心并且半径为0.5</span></span>\n<span id=\"cb56-38\"><a href=\"#cb56-38\" aria-hidden=\"true\" tabindex=\"-1\"></a>            <span class=\"co\"># 在轴坐标中。</span></span>\n<span id=\"cb56-39\"><a href=\"#cb56-39\" aria-hidden=\"true\" tabindex=\"-1\"></a>            <span class=\"cf\">if</span> frame <span class=\"op\">==</span> <span class=\"st\">&#39;circle&#39;</span>:</span>\n<span id=\"cb56-40\"><a href=\"#cb56-40\" aria-hidden=\"true\" tabindex=\"-1\"></a>                <span class=\"cf\">return</span> Circle((<span class=\"fl\">0.5</span>, <span class=\"fl\">0.5</span>), <span class=\"fl\">0.5</span>)</span>\n<span id=\"cb56-41\"><a href=\"#cb56-41\" aria-hidden=\"true\" tabindex=\"-1\"></a>            <span class=\"cf\">elif</span> frame <span class=\"op\">==</span> <span class=\"st\">&#39;polygon&#39;</span>:</span>\n<span id=\"cb56-42\"><a href=\"#cb56-42\" aria-hidden=\"true\" tabindex=\"-1\"></a>                <span class=\"cf\">return</span> RegularPolygon((<span class=\"fl\">0.5</span>, <span class=\"fl\">0.5</span>), num_vars,</span>\n<span id=\"cb56-43\"><a href=\"#cb56-43\" aria-hidden=\"true\" tabindex=\"-1\"></a>                                      radius<span class=\"op\">=</span><span class=\"fl\">.5</span>, edgecolor<span class=\"op\">=</span><span class=\"st\">&quot;k&quot;</span>)</span>\n<span id=\"cb56-44\"><a href=\"#cb56-44\" aria-hidden=\"true\" tabindex=\"-1\"></a>            <span class=\"cf\">else</span>:</span>\n<span id=\"cb56-45\"><a href=\"#cb56-45\" aria-hidden=\"true\" tabindex=\"-1\"></a>                <span class=\"cf\">raise</span> <span class=\"pp\">ValueError</span>(<span class=\"st\">&quot;unknown value for &#39;frame&#39;: </span><span class=\"sc\">%s</span><span class=\"st\">&quot;</span> <span class=\"op\">%</span> frame)</span>\n<span id=\"cb56-46\"><a href=\"#cb56-46\" aria-hidden=\"true\" tabindex=\"-1\"></a>        </span>\n<span id=\"cb56-47\"><a href=\"#cb56-47\" aria-hidden=\"true\" tabindex=\"-1\"></a>        <span class=\"kw\">def</span> _gen_axes_spines(<span class=\"va\">self</span>):</span>\n<span id=\"cb56-48\"><a href=\"#cb56-48\" aria-hidden=\"true\" tabindex=\"-1\"></a>            <span class=\"cf\">if</span> frame <span class=\"op\">==</span> <span class=\"st\">&#39;circle&#39;</span>:</span>\n<span id=\"cb56-49\"><a href=\"#cb56-49\" aria-hidden=\"true\" tabindex=\"-1\"></a>                <span class=\"cf\">return</span> <span class=\"bu\">super</span>()._gen_axes_spines()</span>\n<span id=\"cb56-50\"><a href=\"#cb56-50\" aria-hidden=\"true\" tabindex=\"-1\"></a>            <span class=\"cf\">elif</span> frame <span class=\"op\">==</span> <span class=\"st\">&#39;polygon&#39;</span>:</span>\n<span id=\"cb56-51\"><a href=\"#cb56-51\" aria-hidden=\"true\" tabindex=\"-1\"></a>                <span class=\"co\"># spine_type 必须是&#39;left&#39;/&#39;right&#39;/&#39;top&#39;/&#39;bottom&#39;/&#39;circle&#39;.</span></span>\n<span id=\"cb56-52\"><a href=\"#cb56-52\" aria-hidden=\"true\" tabindex=\"-1\"></a>                spine <span class=\"op\">=</span> Spine(axes<span class=\"op\">=</span><span class=\"va\">self</span>,</span>\n<span id=\"cb56-53\"><a href=\"#cb56-53\" aria-hidden=\"true\" tabindex=\"-1\"></a>                              spine_type<span class=\"op\">=</span><span class=\"st\">&#39;circle&#39;</span>,</span>\n<span id=\"cb56-54\"><a href=\"#cb56-54\" aria-hidden=\"true\" tabindex=\"-1\"></a>                              path<span class=\"op\">=</span>Path.unit_regular_polygon(num_vars))</span>\n<span id=\"cb56-55\"><a href=\"#cb56-55\" aria-hidden=\"true\" tabindex=\"-1\"></a>                <span class=\"co\"># unit_regular_polygon 给出以1为中心的半径为1的多边形</span></span>\n<span id=\"cb56-56\"><a href=\"#cb56-56\" aria-hidden=\"true\" tabindex=\"-1\"></a>                <span class=\"co\">#（0，0），但我们希望以（0.5，</span></span>\n<span id=\"cb56-57\"><a href=\"#cb56-57\" aria-hidden=\"true\" tabindex=\"-1\"></a>                <span class=\"co\">#   0.5）的坐标轴。</span></span>\n<span id=\"cb56-58\"><a href=\"#cb56-58\" aria-hidden=\"true\" tabindex=\"-1\"></a>                spine.set_transform(Affine2D().scale(<span class=\"fl\">.5</span>).translate(<span class=\"fl\">.5</span>, <span class=\"fl\">.5</span>)</span>\n<span id=\"cb56-59\"><a href=\"#cb56-59\" aria-hidden=\"true\" tabindex=\"-1\"></a>                                    <span class=\"op\">+</span> <span class=\"va\">self</span>.transAxes)</span>\n<span id=\"cb56-60\"><a href=\"#cb56-60\" aria-hidden=\"true\" tabindex=\"-1\"></a>                <span class=\"cf\">return</span> &#123;<span class=\"st\">&#39;polar&#39;</span>: spine&#125;</span>\n<span id=\"cb56-61\"><a href=\"#cb56-61\" aria-hidden=\"true\" tabindex=\"-1\"></a>            <span class=\"cf\">else</span>:</span>\n<span id=\"cb56-62\"><a href=\"#cb56-62\" aria-hidden=\"true\" tabindex=\"-1\"></a>                <span class=\"cf\">raise</span> <span class=\"pp\">ValueError</span>(<span class=\"st\">&quot;unknown value for &#39;frame&#39;: </span><span class=\"sc\">%s</span><span class=\"st\">&quot;</span> <span class=\"op\">%</span> frame)</span>\n<span id=\"cb56-63\"><a href=\"#cb56-63\" aria-hidden=\"true\" tabindex=\"-1\"></a>    register_projection(RadarAxes)</span>\n<span id=\"cb56-64\"><a href=\"#cb56-64\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"cf\">return</span> theta</span></code></pre></div>\n<h4 id=\"lcrfm模型作图\">LCRFM模型作图</h4>\n<div class=\"sourceCode\" id=\"cb57\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb57-1\"><a href=\"#cb57-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>N <span class=\"op\">=</span> num_clusters</span>\n<span id=\"cb57-2\"><a href=\"#cb57-2\" aria-hidden=\"true\" tabindex=\"-1\"></a>theta <span class=\"op\">=</span> radar_factory(N, frame<span class=\"op\">=</span><span class=\"st\">&#39;polygon&#39;</span>)</span>\n<span id=\"cb57-3\"><a href=\"#cb57-3\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb57-4\"><a href=\"#cb57-4\" aria-hidden=\"true\" tabindex=\"-1\"></a>data <span class=\"op\">=</span> r.to_numpy()</span>\n<span id=\"cb57-5\"><a href=\"#cb57-5\" aria-hidden=\"true\" tabindex=\"-1\"></a>fig,ax <span class=\"op\">=</span> plt.subplots(figsize<span class=\"op\">=</span>(<span class=\"dv\">5</span>,<span class=\"dv\">5</span>), nrows <span class=\"op\">=</span> <span class=\"dv\">1</span>, ncols<span class=\"op\">=</span><span class=\"dv\">1</span>, subplot_kw<span class=\"op\">=</span><span class=\"bu\">dict</span>(projection<span class=\"op\">=</span><span class=\"st\">&#39;radar&#39;</span>))</span>\n<span id=\"cb57-6\"><a href=\"#cb57-6\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb57-7\"><a href=\"#cb57-7\" aria-hidden=\"true\" tabindex=\"-1\"></a>fig.subplots_adjust(wspace<span class=\"op\">=</span><span class=\"fl\">0.25</span>,hspace<span class=\"op\">=</span><span class=\"fl\">0.20</span>,top<span class=\"op\">=</span><span class=\"fl\">0.85</span>,bottom<span class=\"op\">=</span><span class=\"fl\">0.05</span>)</span>\n<span id=\"cb57-8\"><a href=\"#cb57-8\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb57-9\"><a href=\"#cb57-9\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"co\"># 去掉最后一列</span></span>\n<span id=\"cb57-10\"><a href=\"#cb57-10\" aria-hidden=\"true\" tabindex=\"-1\"></a>case_data <span class=\"op\">=</span> data[:,:<span class=\"op\">-</span><span class=\"dv\">1</span>]</span>\n<span id=\"cb57-11\"><a href=\"#cb57-11\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"co\"># 设置纵坐标不可见</span></span>\n<span id=\"cb57-12\"><a href=\"#cb57-12\" aria-hidden=\"true\" tabindex=\"-1\"></a>ax.get_yaxis().set_visible(<span class=\"va\">False</span>)</span>\n<span id=\"cb57-13\"><a href=\"#cb57-13\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb57-14\"><a href=\"#cb57-14\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"co\"># 图片标题</span></span>\n<span id=\"cb57-15\"><a href=\"#cb57-15\" aria-hidden=\"true\" tabindex=\"-1\"></a>title <span class=\"op\">=</span> <span class=\"st\">&quot;Radar Chart for Different Means&quot;</span></span>\n<span id=\"cb57-16\"><a href=\"#cb57-16\" aria-hidden=\"true\" tabindex=\"-1\"></a>ax.set_title(title, weight<span class=\"op\">=</span><span class=\"st\">&#39;bold&#39;</span>, size<span class=\"op\">=</span><span class=\"st\">&#39;medium&#39;</span>, position<span class=\"op\">=</span>(<span class=\"fl\">0.5</span>, <span class=\"fl\">1.1</span>),</span>\n<span id=\"cb57-17\"><a href=\"#cb57-17\" aria-hidden=\"true\" tabindex=\"-1\"></a>             horizontalalignment<span class=\"op\">=</span><span class=\"st\">&#39;center&#39;</span>, verticalalignment<span class=\"op\">=</span><span class=\"st\">&#39;center&#39;</span>)</span>\n<span id=\"cb57-18\"><a href=\"#cb57-18\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"cf\">for</span> d <span class=\"kw\">in</span> case_data:</span>\n<span id=\"cb57-19\"><a href=\"#cb57-19\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"co\"># 画边</span></span>\n<span id=\"cb57-20\"><a href=\"#cb57-20\" aria-hidden=\"true\" tabindex=\"-1\"></a>    ax.plot(theta, d)</span>\n<span id=\"cb57-21\"><a href=\"#cb57-21\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"co\"># 填充颜色</span></span>\n<span id=\"cb57-22\"><a href=\"#cb57-22\" aria-hidden=\"true\" tabindex=\"-1\"></a>    ax.fill(theta, d, alpha<span class=\"op\">=</span><span class=\"fl\">0.05</span>)</span>\n<span id=\"cb57-23\"><a href=\"#cb57-23\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"co\"># 设置纵坐标名称</span></span>\n<span id=\"cb57-24\"><a href=\"#cb57-24\" aria-hidden=\"true\" tabindex=\"-1\"></a>ax.set_varlabels(features)</span>\n<span id=\"cb57-25\"><a href=\"#cb57-25\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb57-26\"><a href=\"#cb57-26\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"co\"># 添加图例</span></span>\n<span id=\"cb57-27\"><a href=\"#cb57-27\" aria-hidden=\"true\" tabindex=\"-1\"></a>labels <span class=\"op\">=</span> [<span class=\"st\">&quot;CustomerCluster_&quot;</span> <span class=\"op\">+</span> <span class=\"bu\">str</span>(i) <span class=\"cf\">for</span> i <span class=\"kw\">in</span> <span class=\"bu\">range</span>(<span class=\"dv\">1</span>,<span class=\"dv\">6</span>)]</span>\n<span id=\"cb57-28\"><a href=\"#cb57-28\" aria-hidden=\"true\" tabindex=\"-1\"></a>legend <span class=\"op\">=</span> ax.legend(labels, loc<span class=\"op\">=</span>(<span class=\"fl\">0.9</span>, <span class=\"fl\">.75</span>), labelspacing<span class=\"op\">=</span><span class=\"fl\">0.1</span>)</span>\n<span id=\"cb57-29\"><a href=\"#cb57-29\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb57-30\"><a href=\"#cb57-30\" aria-hidden=\"true\" tabindex=\"-1\"></a>plt.show()</span></code></pre></div>\n<p>​<br>\n<img src=\"/.top//Users\\YSilhouette\\AppData\\Local\\Temp\\360zip$Temp\\360output_55_0.png\\output_55_0.png\" alt=\"png\"> ​</p>\n<h4 id=\"rfm模型作图\">RFM模型作图</h4>\n<div class=\"sourceCode\" id=\"cb58\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb58-1\"><a href=\"#cb58-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>theta <span class=\"op\">=</span> radar_factory(<span class=\"dv\">3</span>, frame<span class=\"op\">=</span><span class=\"st\">&#39;polygon&#39;</span>)</span>\n<span id=\"cb58-2\"><a href=\"#cb58-2\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb58-3\"><a href=\"#cb58-3\" aria-hidden=\"true\" tabindex=\"-1\"></a>data <span class=\"op\">=</span> rr.to_numpy()</span>\n<span id=\"cb58-4\"><a href=\"#cb58-4\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb58-5\"><a href=\"#cb58-5\" aria-hidden=\"true\" tabindex=\"-1\"></a>fig, ax <span class=\"op\">=</span> plt.subplots(figsize<span class=\"op\">=</span>(<span class=\"dv\">5</span>, <span class=\"dv\">5</span>), nrows<span class=\"op\">=</span><span class=\"dv\">1</span>, ncols<span class=\"op\">=</span><span class=\"dv\">1</span>,</span>\n<span id=\"cb58-6\"><a href=\"#cb58-6\" aria-hidden=\"true\" tabindex=\"-1\"></a>                         subplot_kw<span class=\"op\">=</span><span class=\"bu\">dict</span>(projection<span class=\"op\">=</span><span class=\"st\">&#39;radar&#39;</span>))</span>\n<span id=\"cb58-7\"><a href=\"#cb58-7\" aria-hidden=\"true\" tabindex=\"-1\"></a>fig.subplots_adjust(wspace<span class=\"op\">=</span><span class=\"fl\">0.25</span>, hspace<span class=\"op\">=</span><span class=\"fl\">0.20</span>, top<span class=\"op\">=</span><span class=\"fl\">0.85</span>, bottom<span class=\"op\">=</span><span class=\"fl\">0.05</span>)</span>\n<span id=\"cb58-8\"><a href=\"#cb58-8\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb58-9\"><a href=\"#cb58-9\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"co\"># 去掉最后一列</span></span>\n<span id=\"cb58-10\"><a href=\"#cb58-10\" aria-hidden=\"true\" tabindex=\"-1\"></a>case_data <span class=\"op\">=</span> data[:, :<span class=\"op\">-</span><span class=\"dv\">1</span>]</span>\n<span id=\"cb58-11\"><a href=\"#cb58-11\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"co\"># 设置纵坐标不可见</span></span>\n<span id=\"cb58-12\"><a href=\"#cb58-12\" aria-hidden=\"true\" tabindex=\"-1\"></a>ax.get_yaxis().set_visible(<span class=\"va\">False</span>)</span>\n<span id=\"cb58-13\"><a href=\"#cb58-13\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"co\"># 图片标题</span></span>\n<span id=\"cb58-14\"><a href=\"#cb58-14\" aria-hidden=\"true\" tabindex=\"-1\"></a>title <span class=\"op\">=</span> <span class=\"st\">&quot;Radar Chart for Different Means&quot;</span></span>\n<span id=\"cb58-15\"><a href=\"#cb58-15\" aria-hidden=\"true\" tabindex=\"-1\"></a>ax.set_title(title, weight<span class=\"op\">=</span><span class=\"st\">&#39;bold&#39;</span>, size<span class=\"op\">=</span><span class=\"st\">&#39;medium&#39;</span>, position<span class=\"op\">=</span>(<span class=\"fl\">0.5</span>, <span class=\"fl\">1.1</span>),</span>\n<span id=\"cb58-16\"><a href=\"#cb58-16\" aria-hidden=\"true\" tabindex=\"-1\"></a>             horizontalalignment<span class=\"op\">=</span><span class=\"st\">&#39;center&#39;</span>, verticalalignment<span class=\"op\">=</span><span class=\"st\">&#39;center&#39;</span>)</span>\n<span id=\"cb58-17\"><a href=\"#cb58-17\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"cf\">for</span> d <span class=\"kw\">in</span> case_data:</span>\n<span id=\"cb58-18\"><a href=\"#cb58-18\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"co\"># 画边</span></span>\n<span id=\"cb58-19\"><a href=\"#cb58-19\" aria-hidden=\"true\" tabindex=\"-1\"></a>    ax.plot(theta, d)</span>\n<span id=\"cb58-20\"><a href=\"#cb58-20\" aria-hidden=\"true\" tabindex=\"-1\"></a>    <span class=\"co\"># 填充颜色</span></span>\n<span id=\"cb58-21\"><a href=\"#cb58-21\" aria-hidden=\"true\" tabindex=\"-1\"></a>    ax.fill(theta, d, alpha<span class=\"op\">=</span><span class=\"fl\">0.05</span>)</span>\n<span id=\"cb58-22\"><a href=\"#cb58-22\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"co\"># 设置纵坐标名称</span></span>\n<span id=\"cb58-23\"><a href=\"#cb58-23\" aria-hidden=\"true\" tabindex=\"-1\"></a>ax.set_varlabels([<span class=\"st\">&#39;R&#39;</span>,<span class=\"st\">&#39;F&#39;</span>,<span class=\"st\">&#39;M&#39;</span>])</span>\n<span id=\"cb58-24\"><a href=\"#cb58-24\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb58-25\"><a href=\"#cb58-25\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"co\"># 添加图例</span></span>\n<span id=\"cb58-26\"><a href=\"#cb58-26\" aria-hidden=\"true\" tabindex=\"-1\"></a>labels <span class=\"op\">=</span> [<span class=\"st\">&quot;CustomerCluster_&quot;</span> <span class=\"op\">+</span> <span class=\"bu\">str</span>(i) <span class=\"cf\">for</span> i <span class=\"kw\">in</span> <span class=\"bu\">range</span>(<span class=\"dv\">1</span>,<span class=\"dv\">6</span>)]</span>\n<span id=\"cb58-27\"><a href=\"#cb58-27\" aria-hidden=\"true\" tabindex=\"-1\"></a>legend <span class=\"op\">=</span> ax.legend(labels, loc<span class=\"op\">=</span>(<span class=\"fl\">0.9</span>, <span class=\"fl\">.75</span>), labelspacing<span class=\"op\">=</span><span class=\"fl\">0.1</span>)</span>\n<span id=\"cb58-28\"><a href=\"#cb58-28\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb58-29\"><a href=\"#cb58-29\" aria-hidden=\"true\" tabindex=\"-1\"></a>plt.show()</span></code></pre></div>\n<figure>\n<img src=\"/.top//output_57_0.png\" alt=\"png\">\n<figcaption aria-hidden=\"true\">png</figcaption>\n</figure>\n<h4 id=\"dbscan模型对lcrfm特征进行计算\">DBSCAN模型对LCRFM特征进行计算</h4>\n<div class=\"sourceCode\" id=\"cb59\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb59-1\"><a href=\"#cb59-1\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"im\">from</span> sklearn.cluster <span class=\"im\">import</span> DBSCAN</span>\n<span id=\"cb59-2\"><a href=\"#cb59-2\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb59-3\"><a href=\"#cb59-3\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"co\"># Kagging debug</span></span>\n<span id=\"cb59-4\"><a href=\"#cb59-4\" aria-hidden=\"true\" tabindex=\"-1\"></a>db <span class=\"op\">=</span> DBSCAN(eps<span class=\"op\">=</span><span class=\"dv\">10</span>,min_samples<span class=\"op\">=</span><span class=\"dv\">2</span>).fit(data_db.sample(<span class=\"dv\">10000</span>))</span>\n<span id=\"cb59-5\"><a href=\"#cb59-5\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb59-6\"><a href=\"#cb59-6\" aria-hidden=\"true\" tabindex=\"-1\"></a>DBSCAN_labels <span class=\"op\">=</span> db.labels_</span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb60\"><pre class=\"sourceCode python\"><code class=\"sourceCode python\"><span id=\"cb60-1\"><a href=\"#cb60-1\" aria-hidden=\"true\" tabindex=\"-1\"></a>DBSCAN_labels</span></code></pre></div>\n<pre><code>array([0, 0, 0, ..., 0, 0, 0])</code></pre>\n<h4 id=\"根据lcrfm结果进行分析\">根据LCRFM结果进行分析</h4>\n<p>应实际业务对聚类结果进行分值离散转化，对应1-5分，其中属性值越大，分数越高：\n<img src=\"/.top//output_57_1.png\" alt=\"image.png\"></p>\n<ol type=\"1\">\n<li>重要保持客户</li>\n</ol>\n<p>平均折扣率高(C↑)，最近有乘机记录(R↓)，乘机次数高(F↑)或里程高(M↑)：\n这类客户机票票价高，不在意机票折扣，经常乘机，是最理想的客户类型。\n公司应优先将资源投放到他们身上，维持这类客户的忠诚度。</p>\n<ol start=\"2\" type=\"1\">\n<li>重要发展客户</li>\n</ol>\n<p>平均折扣率高(C↑)，最近有乘机记录(R↓)，乘机次数低(F↓)或里程低(M↓)：\n这类客户机票票价高，不在意机票折扣，最近有乘机记录，但总里程低，具有很大的发展潜力。\n公司应加强这类客户的满意度，使他们逐渐成为忠诚客户。</p>\n<ol start=\"3\" type=\"1\">\n<li>重要挽留客户</li>\n</ol>\n<p>平均折扣率高(C↑)，乘机次数高(F↑)或里程高(M↑)，最近无乘机记录(R↑)：\n这类客户总里程高，但较长时间没有乘机，可能处于流失状态。\n公司应加强与这类客户的互动，召回用户，延长客户的生命周期。</p>\n<ol start=\"4\" type=\"1\">\n<li>一般客户</li>\n</ol>\n<p>平均折扣率低(C↓)，最近无乘机记录(R↑)，乘机次数高(F↓)或里程高(M↓)，入会时间短(L↓)：\n这类客户机票票价低，经常买折扣机票，最近无乘机记录，可能是趁着折扣而选择购买，对品牌无忠诚度。\n公司需要在资源支持的情况下强化对这类客户的联系。</p>\n<ol start=\"5\" type=\"1\">\n<li>低价值客户</li>\n</ol>\n<p>平均折扣率低（C↓），最近无乘机记录（R↑），乘机次数高（F↓）或里程高（M↓），入会时间短（L↓）：\n这类客户与一般客户类似，机票票价低，经常买折扣机票，最近无乘机记录，可能是趁着折扣而选择购买，对品牌无忠诚度。</p>\n<h4 id=\"结果分析\">结果分析</h4>\n<ul>\n<li><p>群体1的L属性最大</p></li>\n<li><p>群体2的L、C属性最小</p></li>\n<li><p>群体3的C属性上最大</p></li>\n<li><p>群体4的M、F属性属性最大，R属性最小</p></li>\n<li><p>群体5的R属性最大，F、M属性最小</p></li>\n<li><p>其中每项指标的实际业务意义为：</p>\n<ul>\n<li>L：加入会员的时长。越大代表会员资历越久</li>\n<li>R：最近一次乘机时间。越大代表越久没乘机</li>\n<li>F：乘机次数。越大代表乘机次数越多</li>\n<li>M：飞行总里程。越大代表总里程越多</li>\n<li>C：平均折扣率。越大代表折扣越弱，0表示0折免费机票，10代表无折机票</li>\n</ul></li>\n</ul>\n<p>重要保持客户：客户群4</p>\n<p>重要发展客户：客户群3</p>\n<p>重要挽留客户：客户群1</p>\n<p>一般客户：客户群2</p>\n<p>低价值客户：客户群5</p>\n<h4 id=\"决策\">决策</h4>\n<ul>\n<li>重要发展客户、重要保持客户、重要挽留客户这三类客户其实也对应着客户生命周期中的发展期、稳定器、衰退期三个时期。</li>\n<li>从客户生命周期的角度讲，也应重点投入资源召回衰退期的客户。</li>\n<li>一般而言，数据分析最终的目的是针对分析结果提出并开展一系列的运营/营销策略，以期帮助企业发展。在本实例中，运营策略有三个方向：\n<ul>\n<li>提高活跃度：提高一般客户、低价值客户的活跃度。将其转化为优质客户</li>\n<li>提高留存率：与重要挽留客户互动，提高这部分用户的留存率</li>\n<li>提高付费率：维系重要保持客户、重要发展客户的忠诚度，保持企业良好收入</li>\n<li>每个方向对应不同的策略，如会员升级、积分兑换、交叉销售、发放折扣券等手段</li>\n</ul></li>\n</ul>\n<hr>\n<h3 id=\"about-me\">About ME</h3>\n<h5 id=\"读书城南-在未来面前我们都是孩子\">👋 读书城南，🤔\n在未来面前，我们都是孩子～</h5>\n<ul>\n<li>📙\n一个热衷于探索学习新方向、新事物的智能产品经理，闲暇时间喜欢coding💻、画图🎨、音乐🎵、学习ing~</li>\n</ul>\n<h5 id=\"social-media\">👋 Social Media</h5>\n<ul>\n<li><p>🛠️ Blog: <a href=\"http://oceaneyes.top\">http://oceaneyes.top</a></p></li>\n<li><p>⚡ PM导航: <a href=\"https://pmhub.oceangzy.top\">https://pmhub.oceangzy.top</a></p></li>\n<li><p>☘️ CNBLOG: <a href=\"https://www.cnblogs.com/oceaneyes-gzy/\">https://www.cnblogs.com/oceaneyes-gzy/</a></p></li>\n<li><p>🌱 AI PRJ自己部署的一些算法demo: <a href=\"http://ai.oceangzy.top/\">http://ai.oceangzy.top/</a></p></li>\n<li><p>📫 Email: 1450136519@qq.com</p></li>\n<li><p>💬 WeChat: <a href=\"https://oceaneyes.top/img/wechatqrcode.jpg\">OCEANGZY</a></p></li>\n<li><p>💬 公众号: <a href=\"https://oceaneyes.top/img/wechatgzh.jpeg\">UncleJoker-GZY</a></p></li>\n</ul>\n<h5 id=\"加入小组\">👋 加入小组~</h5>\n<p><img src=\"https://oceaneyes.top/img/zhishigroup.jpg\" title=\"加入组织\" alt width=\"240\"></p>\n<h5 id=\"感谢打赏\">👋 感谢打赏~</h5>\n<p><img src=\"https://oceaneyes.top/img/alipay.jpg\" title=\"支付宝打赏\" alt width=\"140\">\n<img src=\"https://oceaneyes.top/img/wechatpay.jpg\" title=\"微信打赏\" alt width=\"140\"></p>\n","categories":[{"name":"Artificial Intelligence","path":"api/categories/Artificial Intelligence.json"},{"name":"Machine Learning","path":"api/categories/Machine Learning.json"},{"name":"Algorithm","path":"api/categories/Algorithm.json"},{"name":"K-means","path":"api/categories/K-means.json"},{"name":"DBSCAN","path":"api/categories/DBSCAN.json"},{"name":"RFM","path":"api/categories/RFM.json"},{"name":"用户画像","path":"api/categories/用户画像.json"},{"name":"聚类分析","path":"api/categories/聚类分析.json"}],"tags":[{"name":"Machine Learning","path":"api/tags/Machine Learning.json"},{"name":"Algorithm","path":"api/tags/Algorithm.json"},{"name":"用户画像","path":"api/tags/用户画像.json"},{"name":"K-means","path":"api/tags/K-means.json"},{"name":"DBSCAN","path":"api/tags/DBSCAN.json"},{"name":"RFM","path":"api/tags/RFM.json"},{"name":"聚类分析","path":"api/tags/聚类分析.json"}]}